<!DOCTYPE html>
<!-- saved from url=(0065)https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/ -->
<html lang="en-US" prefix="og: http://ogp.me/ns#" class=" js csstransforms3d csstransitions" style=""><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script type="text/javascript" src="./OpenCV Face Recognition - PyImageSearch_files/form"></script><script type="text/javascript" src="./OpenCV Face Recognition - PyImageSearch_files/form(1)"></script><script type="text/javascript" src="./OpenCV Face Recognition - PyImageSearch_files/identify"></script><script type="text/javascript" src="./OpenCV Face Recognition - PyImageSearch_files/track"></script><script type="text/javascript" src="./OpenCV Face Recognition - PyImageSearch_files/beacon"></script><link rel="stylesheet" type="text/css" href="./OpenCV Face Recognition - PyImageSearch_files/25595.css" media="all">




<!-- <link rel="stylesheet" type="text/css" href="https://www.pyimagesearch.com/static/css/header_fix.css" media="all"/> -->
<link rel="pingback" href="https://www.pyimagesearch.com/xmlrpc.php">
<link rel="shortcut icon" href="https://www.pyimagesearch.com/wp-content/themes/canvas/favicon.ico">

<!-- Always force latest IE rendering engine (even in intranet) & Chrome Frame -->
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">

<!--  Mobile viewport scale -->
<meta content="initial-scale=1.0, maximum-scale=1.0, user-scalable=yes" name="viewport">

<!-- This site is optimized with the Yoast SEO plugin v7.0.3 - https://yoast.com/wordpress/plugins/seo/ -->
<title>OpenCV Face Recognition - PyImageSearch</title>
<meta name="description" content="In this tutorial you will learn how to perform OpenCV Face Recognition to accurately recognize faces in images and video streams using OpenCV, Deep Learning, and Python.">
<link rel="canonical" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/">
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="OpenCV Face Recognition - PyImageSearch">
<meta property="og:description" content="In this tutorial you will learn how to perform OpenCV Face Recognition to accurately recognize faces in images and video streams using OpenCV, Deep Learning, and Python.">
<meta property="og:url" content="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/">
<meta property="og:site_name" content="PyImageSearch">
<meta property="article:tag" content="deep learning">
<meta property="article:tag" content="face detection">
<meta property="article:tag" content="face recognition">
<meta property="article:tag" content="facenet">
<meta property="article:tag" content="machine learning">
<meta property="article:tag" content="neural nets">
<meta property="article:section" content="Faces">
<meta property="article:published_time" content="2018-09-24T10:00:11-04:00">
<meta property="article:modified_time" content="2018-09-16T10:47:59-04:00">
<meta property="og:updated_time" content="2018-09-16T10:47:59-04:00">
<meta property="og:image" content="https://s3-us-west-2.amazonaws.com/static.pyimagesearch.com/opencv-face-recognition/opencv_face_reco_animation.gif">
<meta property="og:image:secure_url" content="https://s3-us-west-2.amazonaws.com/static.pyimagesearch.com/opencv-face-recognition/opencv_face_reco_animation.gif">
<meta property="og:image" content="https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_facenet.jpg">
<meta property="og:image:secure_url" content="https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_facenet.jpg">
<meta property="og:image" content="https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_training.png">
<meta property="og:image:secure_url" content="https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_training.png">
<meta property="og:image" content="https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_dataset.png">
<meta property="og:image:secure_url" content="https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_dataset.png">
<meta property="og:image" content="https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_result01.jpg">
<meta property="og:image:secure_url" content="https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_result01.jpg">
<meta property="og:image" content="https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_result02.jpg">
<meta property="og:image:secure_url" content="https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_result02.jpg">
<meta property="og:image" content="https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_result03.jpg">
<meta property="og:image:secure_url" content="https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_result03.jpg">
<meta property="og:image" content="https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_misclassification.jpg">
<meta property="og:image:secure_url" content="https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_misclassification.jpg">
<meta property="og:image" content="https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_more_data.jpg">
<meta property="og:image:secure_url" content="https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_more_data.jpg">
<meta property="og:image" content="https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_alignment.jpg">
<meta property="og:image:secure_url" content="https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_alignment.jpg">
<!-- / Yoast SEO plugin. -->

<link rel="dns-prefetch" href="https://a.optmnstr.com/">
<link rel="dns-prefetch" href="https://s.w.org/">
<link rel="alternate" type="application/rss+xml" title="PyImageSearch » Feed" href="http://feeds.feedburner.com/Pyimagesearch">
<link rel="alternate" type="application/rss+xml" title="PyImageSearch » Comments Feed" href="https://www.pyimagesearch.com/comments/feed/">
<link rel="alternate" type="application/rss+xml" title="PyImageSearch » OpenCV Face Recognition Comments Feed" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/feed/">
		<div class="fit-vids-style">­<style>               .fluid-width-video-wrapper {                 width: 100%;                              position: relative;                       padding: 0;                            }                                                                                   .fluid-width-video-wrapper iframe,        .fluid-width-video-wrapper object,        .fluid-width-video-wrapper embed {           position: absolute;                       top: 0;                                   left: 0;                                  width: 100%;                              height: 100%;                          }                                       </style></div><script src="./OpenCV Face Recognition - PyImageSearch_files/916800548463326" async=""></script><script src="./OpenCV Face Recognition - PyImageSearch_files/1465896023527386" async=""></script><script async="" src="./OpenCV Face Recognition - PyImageSearch_files/fbevents.js"></script><script type="text/javascript" async="" src="./OpenCV Face Recognition - PyImageSearch_files/54220efd7ab7f03f7e000043.js"></script><script type="text/javascript" async="" src="./OpenCV Face Recognition - PyImageSearch_files/4768429.js"></script><script async="" src="./OpenCV Face Recognition - PyImageSearch_files/analytics.js"></script><script type="text/javascript" async="" src="./OpenCV Face Recognition - PyImageSearch_files/mixpanel-2-latest.min.js"></script><script type="text/javascript">
			window._wpemojiSettings = {"baseUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.4\/72x72\/","ext":".png","svgUrl":"https:\/\/s.w.org\/images\/core\/emoji\/2.4\/svg\/","svgExt":".svg","source":{"concatemoji":"https:\/\/www.pyimagesearch.com\/wp-includes\/js\/wp-emoji-release.min.js?ver=4.9.4"}};
			!function(a,b,c){function d(a,b){var c=String.fromCharCode;l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,a),0,0);var d=k.toDataURL();l.clearRect(0,0,k.width,k.height),l.fillText(c.apply(this,b),0,0);var e=k.toDataURL();return d===e}function e(a){var b;if(!l||!l.fillText)return!1;switch(l.textBaseline="top",l.font="600 32px Arial",a){case"flag":return!(b=d([55356,56826,55356,56819],[55356,56826,8203,55356,56819]))&&(b=d([55356,57332,56128,56423,56128,56418,56128,56421,56128,56430,56128,56423,56128,56447],[55356,57332,8203,56128,56423,8203,56128,56418,8203,56128,56421,8203,56128,56430,8203,56128,56423,8203,56128,56447]),!b);case"emoji":return b=d([55357,56692,8205,9792,65039],[55357,56692,8203,9792,65039]),!b}return!1}function f(a){var c=b.createElement("script");c.src=a,c.defer=c.type="text/javascript",b.getElementsByTagName("head")[0].appendChild(c)}var g,h,i,j,k=b.createElement("canvas"),l=k.getContext&&k.getContext("2d");for(j=Array("flag","emoji"),c.supports={everything:!0,everythingExceptFlag:!0},i=0;i<j.length;i++)c.supports[j[i]]=e(j[i]),c.supports.everything=c.supports.everything&&c.supports[j[i]],"flag"!==j[i]&&(c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&c.supports[j[i]]);c.supports.everythingExceptFlag=c.supports.everythingExceptFlag&&!c.supports.flag,c.DOMReady=!1,c.readyCallback=function(){c.DOMReady=!0},c.supports.everything||(h=function(){c.readyCallback()},b.addEventListener?(b.addEventListener("DOMContentLoaded",h,!1),a.addEventListener("load",h,!1)):(a.attachEvent("onload",h),b.attachEvent("onreadystatechange",function(){"complete"===b.readyState&&c.readyCallback()})),g=c.source||{},g.concatemoji?f(g.concatemoji):g.wpemoji&&g.twemoji&&(f(g.twemoji),f(g.wpemoji)))}(window,document,window._wpemojiSettings);
		</script><script src="./OpenCV Face Recognition - PyImageSearch_files/wp-emoji-release.min.js" type="text/javascript" defer=""></script>
		<style type="text/css">
img.wp-smiley,
img.emoji {
	display: inline !important;
	border: none !important;
	box-shadow: none !important;
	height: 1em !important;
	width: 1em !important;
	margin: 0 .07em !important;
	vertical-align: -0.1em !important;
	background: none !important;
	padding: 0 !important;
}
</style>








<!--[if lt IE 9]>
<link href="https://www.pyimagesearch.com/wp-content/themes/canvas/css/non-responsive.css" rel="stylesheet" type="text/css" />
<style type="text/css">.col-full, #wrapper { width: 960px; max-width: 960px; } #inner-wrapper { padding: 0; } body.full-width #header, #nav-container, body.full-width #content, body.full-width #footer-widgets, body.full-width #footer { padding-left: 0; padding-right: 0; } body.fixed-mobile #top, body.fixed-mobile #header-container, body.fixed-mobile #footer-container, body.fixed-mobile #nav-container, body.fixed-mobile #footer-widgets-container { min-width: 960px; padding: 0 1em; } body.full-width #content { width: auto; padding: 0 1em;}</style>
<![endif]-->
<script type="text/javascript" src="./OpenCV Face Recognition - PyImageSearch_files/df983.js"></script>


<script type="text/javascript">
/* <![CDATA[ */
var CrayonSyntaxSettings = {"version":"_2.7.2_beta","is_admin":"0","ajaxurl":"https:\/\/www.pyimagesearch.com\/wp-admin\/admin-ajax.php","prefix":"crayon-","setting":"crayon-setting","selected":"crayon-setting-selected","changed":"crayon-setting-changed","special":"crayon-setting-special","orig_value":"data-orig-value","debug":""};
var CrayonSyntaxStrings = {"copy":"Press %s to Copy, %s to Paste","minimize":"Click To Expand Code"};
/* ]]> */
</script>
<script type="text/javascript" src="./OpenCV Face Recognition - PyImageSearch_files/49ed6.js"></script>

<script type="text/javascript" data-cfasync="false" id="omapi-script" async="async" src="./OpenCV Face Recognition - PyImageSearch_files/api.min.js"></script>
<script type="text/javascript" src="./OpenCV Face Recognition - PyImageSearch_files/83e7b.js"></script><style type="text/css">@-webkit-keyframes bounce{0%,20%,50%,80%,to{-webkit-transform:translateY(0);transform:translateY(0)}40%{-webkit-transform:translateY(-30px);transform:translateY(-30px)}60%{-webkit-transform:translateY(-15px);transform:translateY(-15px)}}@keyframes bounce{0%,20%,50%,80%,to{-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0)}40%{-webkit-transform:translateY(-30px);-ms-transform:translateY(-30px);transform:translateY(-30px)}60%{-webkit-transform:translateY(-15px);-ms-transform:translateY(-15px);transform:translateY(-15px)}}.om-animation-bounce{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-name:bounce;animation-name:bounce}@-webkit-keyframes bounceIn{0%{opacity:0;-webkit-transform:scale(.3);transform:scale(.3)}50%{opacity:1;-webkit-transform:scale(1.05);transform:scale(1.05)}70%{-webkit-transform:scale(.9);transform:scale(.9)}to{opacity:1;-webkit-transform:scale(1);transform:scale(1)}}@keyframes bounceIn{0%{opacity:0;-webkit-transform:scale(.3);-ms-transform:scale(.3);transform:scale(.3)}50%{opacity:1;-webkit-transform:scale(1.05);-ms-transform:scale(1.05);transform:scale(1.05)}70%{-webkit-transform:scale(.9);-ms-transform:scale(.9);transform:scale(.9)}to{opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}.om-animation-bounce-in{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:bounceIn;animation-name:bounceIn}@-webkit-keyframes bounceInDown{0%{opacity:0;-webkit-transform:translateY(-2000px);transform:translateY(-2000px)}60%{opacity:1;-webkit-transform:translateY(30px);transform:translateY(30px)}80%{-webkit-transform:translateY(-10px);transform:translateY(-10px)}to{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes bounceInDown{0%{opacity:0;-webkit-transform:translateY(-2000px);-ms-transform:translateY(-2000px);transform:translateY(-2000px)}60%{opacity:1;-webkit-transform:translateY(30px);-ms-transform:translateY(30px);transform:translateY(30px)}80%{-webkit-transform:translateY(-10px);-ms-transform:translateY(-10px);transform:translateY(-10px)}to{-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0)}}.om-animation-bounce-in-down{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:bounceInDown;animation-name:bounceInDown}@-webkit-keyframes bounceInLeft{0%{opacity:0;-webkit-transform:translateX(-2000px);transform:translateX(-2000px)}60%{opacity:1;-webkit-transform:translateX(30px);transform:translateX(30px)}80%{-webkit-transform:translateX(-10px);transform:translateX(-10px)}to{-webkit-transform:translateX(0);transform:translateX(0)}}@keyframes bounceInLeft{0%{opacity:0;-webkit-transform:translateX(-2000px);-ms-transform:translateX(-2000px);transform:translateX(-2000px)}60%{opacity:1;-webkit-transform:translateX(30px);-ms-transform:translateX(30px);transform:translateX(30px)}80%{-webkit-transform:translateX(-10px);-ms-transform:translateX(-10px);transform:translateX(-10px)}to{-webkit-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0)}}.om-animation-bounce-in-left{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:bounceInLeft;animation-name:bounceInLeft}@-webkit-keyframes bounceInRight{0%{opacity:0;-webkit-transform:translateX(2000px);transform:translateX(2000px)}60%{opacity:1;-webkit-transform:translateX(-30px);transform:translateX(-30px)}80%{-webkit-transform:translateX(10px);transform:translateX(10px)}to{-webkit-transform:translateX(0);transform:translateX(0)}}@keyframes bounceInRight{0%{opacity:0;-webkit-transform:translateX(2000px);-ms-transform:translateX(2000px);transform:translateX(2000px)}60%{opacity:1;-webkit-transform:translateX(-30px);-ms-transform:translateX(-30px);transform:translateX(-30px)}80%{-webkit-transform:translateX(10px);-ms-transform:translateX(10px);transform:translateX(10px)}to{-webkit-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0)}}.om-animation-bounce-in-right{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:bounceInRight;animation-name:bounceInRight}@-webkit-keyframes bounceInUp{0%{opacity:0;-webkit-transform:translateY(2000px);transform:translateY(2000px)}60%{opacity:1;-webkit-transform:translateY(-30px);transform:translateY(-30px)}80%{-webkit-transform:translateY(10px);transform:translateY(10px)}to{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes bounceInUp{0%{opacity:0;-webkit-transform:translateY(2000px);-ms-transform:translateY(2000px);transform:translateY(2000px)}60%{opacity:1;-webkit-transform:translateY(-30px);-ms-transform:translateY(-30px);transform:translateY(-30px)}80%{-webkit-transform:translateY(10px);-ms-transform:translateY(10px);transform:translateY(10px)}to{-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0)}}.om-animation-bounce-in-up{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:bounceInUp;animation-name:bounceInUp}@-webkit-keyframes flash{0%,50%,to{opacity:1}25%,75%{opacity:0}}@keyframes flash{0%,50%,to{opacity:1}25%,75%{opacity:0}}.om-animation-flash{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-name:flash;animation-name:flash}@-webkit-keyframes flip{0%{-webkit-transform:perspective(800px) translateZ(0) rotateY(0) scale(1);transform:perspective(800px) translateZ(0) rotateY(0) scale(1);-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}40%{-webkit-transform:perspective(800px) translateZ(150px) rotateY(170deg) scale(1);transform:perspective(800px) translateZ(150px) rotateY(170deg) scale(1);-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}50%{-webkit-transform:perspective(800px) translateZ(150px) rotateY(190deg) scale(1);transform:perspective(800px) translateZ(150px) rotateY(190deg) scale(1);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}80%{-webkit-transform:perspective(800px) translateZ(0) rotateY(1turn) scale(.95);transform:perspective(800px) translateZ(0) rotateY(1turn) scale(.95);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}to{-webkit-transform:perspective(800px) translateZ(0) rotateY(1turn) scale(1);transform:perspective(800px) translateZ(0) rotateY(1turn) scale(1);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}}@keyframes flip{0%{-webkit-transform:perspective(800px) translateZ(0) rotateY(0) scale(1);-ms-transform:perspective(800px) translateZ(0) rotateY(0) scale(1);transform:perspective(800px) translateZ(0) rotateY(0) scale(1);-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}40%{-webkit-transform:perspective(800px) translateZ(150px) rotateY(170deg) scale(1);-ms-transform:perspective(800px) translateZ(150px) rotateY(170deg) scale(1);transform:perspective(800px) translateZ(150px) rotateY(170deg) scale(1);-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}50%{-webkit-transform:perspective(800px) translateZ(150px) rotateY(190deg) scale(1);-ms-transform:perspective(800px) translateZ(150px) rotateY(190deg) scale(1);transform:perspective(800px) translateZ(150px) rotateY(190deg) scale(1);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}80%{-webkit-transform:perspective(800px) translateZ(0) rotateY(1turn) scale(.95);-ms-transform:perspective(800px) translateZ(0) rotateY(1turn) scale(.95);transform:perspective(800px) translateZ(0) rotateY(1turn) scale(.95);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}to{-webkit-transform:perspective(800px) translateZ(0) rotateY(1turn) scale(1);-ms-transform:perspective(800px) translateZ(0) rotateY(1turn) scale(1);transform:perspective(800px) translateZ(0) rotateY(1turn) scale(1);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}}.om-animation-flip{-webkit-animation-duration:1s;animation-duration:1s;-webkit-backface-visibility:visible;-ms-backface-visibility:visible;backface-visibility:visible;-webkit-animation-name:flip;animation-name:flip}@-webkit-keyframes flipInX{0%{-webkit-transform:perspective(800px) rotateX(90deg);transform:perspective(800px) rotateX(90deg);opacity:0}40%{-webkit-transform:perspective(800px) rotateX(-10deg);transform:perspective(800px) rotateX(-10deg)}70%{-webkit-transform:perspective(800px) rotateX(10deg);transform:perspective(800px) rotateX(10deg)}to{-webkit-transform:perspective(800px) rotateX(0deg);transform:perspective(800px) rotateX(0deg);opacity:1}}@keyframes flipInX{0%{-webkit-transform:perspective(800px) rotateX(90deg);-ms-transform:perspective(800px) rotateX(90deg);transform:perspective(800px) rotateX(90deg);opacity:0}40%{-webkit-transform:perspective(800px) rotateX(-10deg);-ms-transform:perspective(800px) rotateX(-10deg);transform:perspective(800px) rotateX(-10deg)}70%{-webkit-transform:perspective(800px) rotateX(10deg);-ms-transform:perspective(800px) rotateX(10deg);transform:perspective(800px) rotateX(10deg)}to{-webkit-transform:perspective(800px) rotateX(0deg);-ms-transform:perspective(800px) rotateX(0deg);transform:perspective(800px) rotateX(0deg);opacity:1}}.om-animation-flip-down{-webkit-animation-duration:1s;animation-duration:1s;-webkit-backface-visibility:visible;-ms-backface-visibility:visible;backface-visibility:visible;-webkit-animation-name:flipInX;animation-name:flipInX}@-webkit-keyframes flipInY{0%{-webkit-transform:perspective(800px) rotateY(90deg);transform:perspective(800px) rotateY(90deg);opacity:0}40%{-webkit-transform:perspective(800px) rotateY(-10deg);transform:perspective(800px) rotateY(-10deg)}70%{-webkit-transform:perspective(800px) rotateY(10deg);transform:perspective(800px) rotateY(10deg)}to{-webkit-transform:perspective(800px) rotateY(0deg);transform:perspective(800px) rotateY(0deg);opacity:1}}@keyframes flipInY{0%{-webkit-transform:perspective(800px) rotateY(90deg);-ms-transform:perspective(800px) rotateY(90deg);transform:perspective(800px) rotateY(90deg);opacity:0}40%{-webkit-transform:perspective(800px) rotateY(-10deg);-ms-transform:perspective(800px) rotateY(-10deg);transform:perspective(800px) rotateY(-10deg)}70%{-webkit-transform:perspective(800px) rotateY(10deg);-ms-transform:perspective(800px) rotateY(10deg);transform:perspective(800px) rotateY(10deg)}to{-webkit-transform:perspective(800px) rotateY(0deg);-ms-transform:perspective(800px) rotateY(0deg);transform:perspective(800px) rotateY(0deg);opacity:1}}.om-animation-flip-side{-webkit-animation-duration:1s;animation-duration:1s;-webkit-backface-visibility:visible;-ms-backface-visibility:visible;backface-visibility:visible;-webkit-animation-name:flipInY;animation-name:flipInY}@-webkit-keyframes lightSpeedIn{0%{-webkit-transform:translateX(100%) skewX(-30deg);transform:translateX(100%) skewX(-30deg);opacity:0}60%{-webkit-transform:translateX(-20%) skewX(30deg);transform:translateX(-20%) skewX(30deg);opacity:1}80%{-webkit-transform:translateX(0) skewX(-15deg);transform:translateX(0) skewX(-15deg);opacity:1}to{-webkit-transform:translateX(0) skewX(0deg);transform:translateX(0) skewX(0deg);opacity:1}}@keyframes lightSpeedIn{0%{-webkit-transform:translateX(100%) skewX(-30deg);-ms-transform:translateX(100%) skewX(-30deg);transform:translateX(100%) skewX(-30deg);opacity:0}60%{-webkit-transform:translateX(-20%) skewX(30deg);-ms-transform:translateX(-20%) skewX(30deg);transform:translateX(-20%) skewX(30deg);opacity:1}80%{-webkit-transform:translateX(0) skewX(-15deg);-ms-transform:translateX(0) skewX(-15deg);transform:translateX(0) skewX(-15deg);opacity:1}to{-webkit-transform:translateX(0) skewX(0deg);-ms-transform:translateX(0) skewX(0deg);transform:translateX(0) skewX(0deg);opacity:1}}.om-animation-light-speed{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:lightSpeedIn;animation-name:lightSpeedIn;-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}@-webkit-keyframes pulse{0%{-webkit-transform:scale(1);transform:scale(1)}50%{-webkit-transform:scale(1.1);transform:scale(1.1)}to{-webkit-transform:scale(1);transform:scale(1)}}@keyframes pulse{0%{-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}50%{-webkit-transform:scale(1.1);-ms-transform:scale(1.1);transform:scale(1.1)}to{-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}.om-animation-pulse{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-name:pulse;animation-name:pulse}@-webkit-keyframes rollIn{0%{opacity:0;-webkit-transform:translateX(-100%) rotate(-120deg);transform:translateX(-100%) rotate(-120deg)}to{opacity:1;-webkit-transform:translateX(0) rotate(0deg);transform:translateX(0) rotate(0deg)}}@keyframes rollIn{0%{opacity:0;-webkit-transform:translateX(-100%) rotate(-120deg);-ms-transform:translateX(-100%) rotate(-120deg);transform:translateX(-100%) rotate(-120deg)}to{opacity:1;-webkit-transform:translateX(0) rotate(0deg);-ms-transform:translateX(0) rotate(0deg);transform:translateX(0) rotate(0deg)}}.om-animation-roll-in{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:rollIn;animation-name:rollIn}@-webkit-keyframes rotateIn{0%{-webkit-transform-origin:center center;transform-origin:center center;-webkit-transform:rotate(-200deg);transform:rotate(-200deg);opacity:0}to{-webkit-transform-origin:center center;transform-origin:center center;-webkit-transform:rotate(0);transform:rotate(0);opacity:1}}@keyframes rotateIn{0%{-webkit-transform-origin:center center;-ms-transform-origin:center center;transform-origin:center center;-webkit-transform:rotate(-200deg);-ms-transform:rotate(-200deg);transform:rotate(-200deg);opacity:0}to{-webkit-transform-origin:center center;-ms-transform-origin:center center;transform-origin:center center;-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);opacity:1}}.om-animation-rotate{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:rotateIn;animation-name:rotateIn}@-webkit-keyframes rotateInDownLeft{0%{-webkit-transform-origin:left bottom;transform-origin:left bottom;-webkit-transform:rotate(-90deg);transform:rotate(-90deg);opacity:0}to{-webkit-transform-origin:left bottom;transform-origin:left bottom;-webkit-transform:rotate(0);transform:rotate(0);opacity:1}}@keyframes rotateInDownLeft{0%{-webkit-transform-origin:left bottom;-ms-transform-origin:left bottom;transform-origin:left bottom;-webkit-transform:rotate(-90deg);-ms-transform:rotate(-90deg);transform:rotate(-90deg);opacity:0}to{-webkit-transform-origin:left bottom;-ms-transform-origin:left bottom;transform-origin:left bottom;-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);opacity:1}}.om-animation-rotate-down-left{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:rotateInDownLeft;animation-name:rotateInDownLeft}@-webkit-keyframes rotateInDownRight{0%{-webkit-transform-origin:right bottom;transform-origin:right bottom;-webkit-transform:rotate(90deg);transform:rotate(90deg);opacity:0}to{-webkit-transform-origin:right bottom;transform-origin:right bottom;-webkit-transform:rotate(0);transform:rotate(0);opacity:1}}@keyframes rotateInDownRight{0%{-webkit-transform-origin:right bottom;-ms-transform-origin:right bottom;transform-origin:right bottom;-webkit-transform:rotate(90deg);-ms-transform:rotate(90deg);transform:rotate(90deg);opacity:0}to{-webkit-transform-origin:right bottom;-ms-transform-origin:right bottom;transform-origin:right bottom;-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);opacity:1}}.om-animation-rotate-down-right{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:rotateInDownRight;animation-name:rotateInDownRight}@-webkit-keyframes rotateInUpLeft{0%{-webkit-transform-origin:left bottom;transform-origin:left bottom;-webkit-transform:rotate(90deg);transform:rotate(90deg);opacity:0}to{-webkit-transform-origin:left bottom;transform-origin:left bottom;-webkit-transform:rotate(0);transform:rotate(0);opacity:1}}@keyframes rotateInUpLeft{0%{-webkit-transform-origin:left bottom;-ms-transform-origin:left bottom;transform-origin:left bottom;-webkit-transform:rotate(90deg);-ms-transform:rotate(90deg);transform:rotate(90deg);opacity:0}to{-webkit-transform-origin:left bottom;-ms-transform-origin:left bottom;transform-origin:left bottom;-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);opacity:1}}.om-animation-rotate-up-left{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:rotateInUpLeft;animation-name:rotateInUpLeft}@-webkit-keyframes rotateInUpRight{0%{-webkit-transform-origin:right bottom;transform-origin:right bottom;-webkit-transform:rotate(-90deg);transform:rotate(-90deg);opacity:0}to{-webkit-transform-origin:right bottom;transform-origin:right bottom;-webkit-transform:rotate(0);transform:rotate(0);opacity:1}}@keyframes rotateInUpRight{0%{-webkit-transform-origin:right bottom;-ms-transform-origin:right bottom;transform-origin:right bottom;-webkit-transform:rotate(-90deg);-ms-transform:rotate(-90deg);transform:rotate(-90deg);opacity:0}to{-webkit-transform-origin:right bottom;-ms-transform-origin:right bottom;transform-origin:right bottom;-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);opacity:1}}.om-animation-rotate-up-right{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:rotateInUpRight;animation-name:rotateInUpRight}@-webkit-keyframes rubberBand{0%{-webkit-transform:scale(1);transform:scale(1)}30%{-webkit-transform:scaleX(1.25) scaleY(.75);transform:scaleX(1.25) scaleY(.75)}40%{-webkit-transform:scaleX(.75) scaleY(1.25);transform:scaleX(.75) scaleY(1.25)}60%{-webkit-transform:scaleX(1.15) scaleY(.85);transform:scaleX(1.15) scaleY(.85)}to{-webkit-transform:scale(1);transform:scale(1)}}@keyframes rubberBand{0%{-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}30%{-webkit-transform:scaleX(1.25) scaleY(.75);-ms-transform:scaleX(1.25) scaleY(.75);transform:scaleX(1.25) scaleY(.75)}40%{-webkit-transform:scaleX(.75) scaleY(1.25);-ms-transform:scaleX(.75) scaleY(1.25);transform:scaleX(.75) scaleY(1.25)}60%{-webkit-transform:scaleX(1.15) scaleY(.85);-ms-transform:scaleX(1.15) scaleY(.85);transform:scaleX(1.15) scaleY(.85)}to{-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}.om-animation-rubber-band{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-name:rubberBand;animation-name:rubberBand}@-webkit-keyframes shake{0%,to{-webkit-transform:translateX(0);transform:translateX(0)}10%,30%,50%,70%,90%{-webkit-transform:translateX(-10px);transform:translateX(-10px)}20%,40%,60%,80%{-webkit-transform:translateX(10px);transform:translateX(10px)}}@keyframes shake{0%,to{-webkit-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0)}10%,30%,50%,70%,90%{-webkit-transform:translateX(-10px);-ms-transform:translateX(-10px);transform:translateX(-10px)}20%,40%,60%,80%{-webkit-transform:translateX(10px);-ms-transform:translateX(10px);transform:translateX(10px)}}.om-animation-shake{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-name:shake;animation-name:shake}@-webkit-keyframes slideInDown{0%{opacity:0;-webkit-transform:translateY(-2000px);transform:translateY(-2000px)}to{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes slideInDown{0%{opacity:0;-webkit-transform:translateY(-2000px);-ms-transform:translateY(-2000px);transform:translateY(-2000px)}to{-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0)}}.om-animation-slide-in-down{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:slideInDown;animation-name:slideInDown}@-webkit-keyframes slideInLeft{0%{opacity:0;-webkit-transform:translateX(-2000px);transform:translateX(-2000px)}to{-webkit-transform:translateX(0);transform:translateX(0)}}@keyframes slideInLeft{0%{opacity:0;-webkit-transform:translateX(-2000px);-ms-transform:translateX(-2000px);transform:translateX(-2000px)}to{-webkit-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0)}}.om-animation-slide-in-left{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:slideInLeft;animation-name:slideInLeft}@-webkit-keyframes slideInRight{0%{opacity:0;-webkit-transform:translateX(2000px);transform:translateX(2000px)}to{-webkit-transform:translateX(0);transform:translateX(0)}}@keyframes slideInRight{0%{opacity:0;-webkit-transform:translateX(2000px);-ms-transform:translateX(2000px);transform:translateX(2000px)}to{-webkit-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0)}}.om-animation-slide-in-right{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:slideInRight;animation-name:slideInRight}@-webkit-keyframes swing{20%{-webkit-transform:rotate(15deg);transform:rotate(15deg)}40%{-webkit-transform:rotate(-10deg);transform:rotate(-10deg)}60%{-webkit-transform:rotate(5deg);transform:rotate(5deg)}80%{-webkit-transform:rotate(-5deg);transform:rotate(-5deg)}to{-webkit-transform:rotate(0deg);transform:rotate(0deg)}}@keyframes swing{20%{-webkit-transform:rotate(15deg);-ms-transform:rotate(15deg);transform:rotate(15deg)}40%{-webkit-transform:rotate(-10deg);-ms-transform:rotate(-10deg);transform:rotate(-10deg)}60%{-webkit-transform:rotate(5deg);-ms-transform:rotate(5deg);transform:rotate(5deg)}80%{-webkit-transform:rotate(-5deg);-ms-transform:rotate(-5deg);transform:rotate(-5deg)}to{-webkit-transform:rotate(0deg);-ms-transform:rotate(0deg);transform:rotate(0deg)}}.om-animation-swing{-webkit-animation-duration:1s;animation-duration:1s;-webkit-transform-origin:top center;-ms-transform-origin:top center;transform-origin:top center;-webkit-animation-name:swing;animation-name:swing}@-webkit-keyframes tada{0%{-webkit-transform:scale(1);transform:scale(1)}10%,20%{-webkit-transform:scale(.9) rotate(-3deg);transform:scale(.9) rotate(-3deg)}30%,50%,70%,90%{-webkit-transform:scale(1.1) rotate(3deg);transform:scale(1.1) rotate(3deg)}40%,60%,80%{-webkit-transform:scale(1.1) rotate(-3deg);transform:scale(1.1) rotate(-3deg)}to{-webkit-transform:scale(1) rotate(0);transform:scale(1) rotate(0)}}@keyframes tada{0%{-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}10%,20%{-webkit-transform:scale(.9) rotate(-3deg);-ms-transform:scale(.9) rotate(-3deg);transform:scale(.9) rotate(-3deg)}30%,50%,70%,90%{-webkit-transform:scale(1.1) rotate(3deg);-ms-transform:scale(1.1) rotate(3deg);transform:scale(1.1) rotate(3deg)}40%,60%,80%{-webkit-transform:scale(1.1) rotate(-3deg);-ms-transform:scale(1.1) rotate(-3deg);transform:scale(1.1) rotate(-3deg)}to{-webkit-transform:scale(1) rotate(0);-ms-transform:scale(1) rotate(0);transform:scale(1) rotate(0)}}.om-animation-tada{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:tada;animation-name:tada}@-webkit-keyframes wobble{0%{-webkit-transform:translateX(0);transform:translateX(0)}15%{-webkit-transform:translateX(-25%) rotate(-5deg);transform:translateX(-25%) rotate(-5deg)}30%{-webkit-transform:translateX(20%) rotate(3deg);transform:translateX(20%) rotate(3deg)}45%{-webkit-transform:translateX(-15%) rotate(-3deg);transform:translateX(-15%) rotate(-3deg)}60%{-webkit-transform:translateX(10%) rotate(2deg);transform:translateX(10%) rotate(2deg)}75%{-webkit-transform:translateX(-5%) rotate(-1deg);transform:translateX(-5%) rotate(-1deg)}to{-webkit-transform:translateX(0);transform:translateX(0)}}@keyframes wobble{0%{-webkit-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0)}15%{-webkit-transform:translateX(-25%) rotate(-5deg);-ms-transform:translateX(-25%) rotate(-5deg);transform:translateX(-25%) rotate(-5deg)}30%{-webkit-transform:translateX(20%) rotate(3deg);-ms-transform:translateX(20%) rotate(3deg);transform:translateX(20%) rotate(3deg)}45%{-webkit-transform:translateX(-15%) rotate(-3deg);-ms-transform:translateX(-15%) rotate(-3deg);transform:translateX(-15%) rotate(-3deg)}60%{-webkit-transform:translateX(10%) rotate(2deg);-ms-transform:translateX(10%) rotate(2deg);transform:translateX(10%) rotate(2deg)}75%{-webkit-transform:translateX(-5%) rotate(-1deg);-ms-transform:translateX(-5%) rotate(-1deg);transform:translateX(-5%) rotate(-1deg)}to{-webkit-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0)}}.om-animation-wobble{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:wobble;animation-name:wobble}.optin-loader{position:relative;color:transparent!important}@keyframes scale{0%{transform:scale(0)}to{transform:scale(1)}}@keyframes opacity{0%{opacity:1}to{opacity:0}}.optin-loader:after,.optin-loader:before{content:"";display:block;position:absolute;border-width:2px;border-style:solid;border-radius:50%;width:26px;height:26px;left:50%;margin-left:-15px;top:50%;margin-top:-15px;opacity:0;animation:scale 1.8s cubic-bezier(.165,.84,.44,1),opacity 1.8s cubic-bezier(.3,.61,.355,1);animation-iteration-count:infinite}.optin-loader:after{animation-delay:.9s}.optin-loader.optin-loader-dark:after,.optin-loader.optin-loader-dark:before{border-color:#60656f}.optin-loader.optin-loader-light:after,.optin-loader.optin-loader-light:before{border-color:#fff}.om-content-lock{color:transparent!important;text-shadow:rgba(0,0,0,.5) 0 0 10px;-webkit-user-select:none;-moz-user-select:none;user-select:none;pointer-events:none;filter:url("data:image/svg+xml;utf9,<svg%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'><filter%20id='blur'><feGaussianBlur%20stdDeviation='10'%20/></filter></svg>#blur");-webkit-filter:blur(10px);-ms-filter:blur(10px);-o-filter:blur(10px);filter:blur(10px)}</style>



<link rel="https://api.w.org/" href="https://www.pyimagesearch.com/wp-json/">
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="https://www.pyimagesearch.com/xmlrpc.php?rsd">
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="https://www.pyimagesearch.com/wp-includes/wlwmanifest.xml"> 
<meta name="generator" content="WordPress 4.9.4">
<link rel="shortlink" href="https://www.pyimagesearch.com/?p=8691">
<link rel="alternate" type="application/json+oembed" href="https://www.pyimagesearch.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.pyimagesearch.com%2F2018%2F09%2F24%2Fopencv-face-recognition%2F">
<link rel="alternate" type="text/xml+oembed" href="https://www.pyimagesearch.com/wp-json/oembed/1.0/embed?url=https%3A%2F%2Fwww.pyimagesearch.com%2F2018%2F09%2F24%2Fopencv-face-recognition%2F&amp;format=xml">

<!-- Theme version -->
<meta name="generator" content="Canvas 5.5.7">
<meta name="generator" content="WooFramework 5.5.5">

<!-- Custom CSS Styling -->
<style type="text/css">
#logo .site-title, #logo .site-description { display:none; }
body {background-repeat:no-repeat;background-position:top left;background-attachment:scroll;border-top:0px solid #000000;}
#header {background-color:#ffffff;background-repeat:no-repeat;background-position:left top;margin-top:0px;margin-bottom:0px;padding-top:15px;padding-bottom:20px;border:0px solid ;}
#logo .site-title a {font:bold 32px/1em "Helvetica Neue", Helvetica, sans-serif;color:#222222;}
#logo .site-description {font:300 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#999999;}
#header-container{background-color:#ffffff;}#nav-container{background:#169fe6;}#nav-container{border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:none;border-right:none;}#nav-container #navigation ul#main-nav > li:first-child{border-left: 0px solid #dbdbdb;}#footer-widgets-container{background-color:#f0f0f0}#footer-widgets{border:none;}#footer-container{background-color:#169fe6}#footer-container{border-top:0px solid #dbdbdb;}#footer {border-width: 0 !important;}
body, p { font:300 14px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
h1 { font:bold 28px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h2 { font:bold 24px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h3 { font:bold 20px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h4 { font:bold 16px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h5 { font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }h6 { font:bold 12px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
.page-title, .post .title, .page .title {font:bold 2.2em/1.1em Arial, sans-serif;color:#3E3E3E;}
.post .title a:link, .post .title a:visited, .page .title a:link, .page .title a:visited {color:#3E3E3E}
.post-meta { font:300 1em/1.5em Arial, sans-serif;color:#3E3E3E; }
.entry, .entry p{ font:300 15px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.post-more {font:300 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:;border-top:0px solid #e6e6e6;border-bottom:0px solid #e6e6e6;}
#post-author, #connect {border-top:1px solid #e6e6e6;border-bottom:1px solid #e6e6e6;border-left:1px solid #e6e6e6;border-right:1px solid #e6e6e6;border-radius:5px;-moz-border-radius:5px;-webkit-border-radius:5px;background-color:#fafafa}
.nav-entries a, .woo-pagination { font:300 13px/1em "Helvetica Neue", Helvetica, sans-serif;color:#888; }
.woo-pagination a, .woo-pagination a:hover {color:#888!important}
.widget h3 {font:bold 14px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-bottom:1px solid #e6e6e6;}
.widget_recent_comments li, #twitter li { border-color: #e6e6e6;}
.widget p, .widget .textwidget { font:300 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
.widget {font:300 13px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555;border-radius:0px;-moz-border-radius:0px;-webkit-border-radius:0px;}
#tabs .inside li a, .widget_woodojo_tabs .tabbable .tab-pane li a { font:bold 12px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#555555; }
#tabs .inside li span.meta, .widget_woodojo_tabs .tabbable .tab-pane li span.meta { font:300 11px/1.5em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
#tabs ul.wooTabs li a, .widget_woodojo_tabs .tabbable .nav-tabs li a { font:300 11px/2em "Helvetica Neue", Helvetica, sans-serif;color:#999999; }
@media only screen and (min-width:768px) {
ul.nav li a, #navigation ul.rss a, #navigation .cart-contents, #navigation ul.rss, #navigation ul.cart .cart_list a{ font:300 13px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#ffffff; } #navigation ul.rss li a:before { color:#ffffff;}
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover a, #navigation ul.nav li ul li a, #navigation ul.cart > li:hover > a, #navigation ul.cart > li > ul > div, #navigation ul.cart > li > ul > div p, #navigation ul.cart > li > ul span, #navigation ul.cart .cart_list a, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a { color:#169fe6!important; }
#navigation ul.nav > li a:hover, #navigation ul.nav > li:hover, #navigation ul.nav li ul, #navigation ul.cart > li:hover, #navigation ul.cart > li > ul > div, #navigation ul.nav li.current_page_item a, #navigation ul.nav li.current_page_parent a, #navigation ul.nav li.current-menu-ancestor a, #navigation ul.nav li.current-cat a, #navigation ul.nav li.current-menu-item a{background-color:#ffffff!important}
#navigation ul.nav li ul, #navigation ul.cart > li > ul > div  { border: 0px solid #dbdbdb; }
#navigation ul.nav > li > ul  { left: 0; }
#navigation ul.nav > li  { border-right: 0px solid #dbdbdb; }#navigation ul.nav > li > ul  { left: 0; }
#navigation  { box-shadow: none; -moz-box-shadow: none; -webkit-box-shadow: none; }#navigation ul li:first-child, #navigation ul li:first-child a { border-radius:0px 0 0 0px; -moz-border-radius:0px 0 0 0px; -webkit-border-radius:0px 0 0 0px; }
#navigation {background:#169fe6;border-top:0px solid #dbdbdb;border-bottom:0px solid #dbdbdb;border-left:0px solid #dbdbdb;border-right:0px solid #dbdbdb;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
#top ul.nav li a { font:300 12px/1.6em "Helvetica Neue", Helvetica, sans-serif;color:#ddd; }
}
#footer, #footer p { font:300 13px/1.4em "Helvetica Neue", Helvetica, sans-serif;color:#ffffff; }
#footer {background-color:#169fe6;border-top:0px solid #dbdbdb;border-bottom:0px solid ;border-left:0px solid ;border-right:0px solid ;border-radius:0px; -moz-border-radius:0px; -webkit-border-radius:0px;}
.magazine #loopedSlider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
.magazine #loopedSlider .content .excerpt p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.magazine .block .post .title, .magazine .block .post .title a { font:bold 18px/1.2em "Helvetica Neue", Helvetica, sans-serif;color:#222222; }
#loopedSlider.business-slider .content h2 { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#loopedSlider.business-slider .content h2.title a { font:bold 24px/1em Arial, sans-serif;color:#ffffff; }
#wrapper #loopedSlider.business-slider .content p { font:300 13px/1.5em Arial, sans-serif;color:#cccccc; }
.archive_header { font:bold 18px/1em Arial, sans-serif;color:#222222; }
.archive_header {border-bottom:1px solid #e6e6e6;}
</style>
<!-- Options Panel Custom CSS -->
<style type="text/css">
/* Subscribe & Connect button style */
#mc-embedded-subscribe{background-color: #DF4B4B;}

/* MailChimp for WP Plugin styles */
.mc4wp-form input[type=submit]{background-color: #DF4B4B;}

/* Hide the header/footer on almost finished pages */
.page-id-365 #header, .page-id-365 #nav-container, .page-id-365 #footer-container{display: none;}
.page-id-4031 #header, .page-id-4031 #nav-container, .page-id-4031 #footer-container{display: none;}
.page-id-365 #content{padding-top: 30px;}
.page-id-4031 #content{padding-top: 30px;}
.page-id-5289 #header, .page-id-5289 #nav-container, .page-id-5289 #footer-container{display: none;}
.page-id-5289 #content{padding-top: 30px;}

/* Hide the header/footer on confirmation pages */
.page-id-1397 #header, .page-id-1397 #nav-container, .page-id-1397 #footer-container{display: none;}
.page-id-1382 #header, .page-id-1382 #nav-container, .page-id-1382 #footer-container{display: none;}
.page-id-1481 #header, .page-id-1481 #nav-container, .page-id-1481 #footer-container{display: none;}
.page-id-3200 #header, .page-id-3200 #nav-container, .page-id-3200 #footer-container{display: none;}
.page-id-4038 #header, .page-id-4038 #nav-container, .page-id-4038 #footer-container{display: none;}
.page-id-5278 #header, .page-id-5278 #nav-container, .page-id-5278 #footer-container{display: none;}
.page-id-8101 #header, .page-id-8101 #nav-container, .page-id-8101 #footer-container{display: none;}
.page-id-1397 #content, .page-id-1382 #content, .page-id-1481 #content, .page-id-4038 #content, .page-id-5278 #content, .page-id-8101 #content{padding-top: 30px;}

/* Manipulate content on 'Let me show you...' page */
.page-id-3200 #content{padding-top: 15px;}
.page-id-3200 #content h1.title{display: none;}
.page-id-3200 #content .entry h1{font-size: 32px;}

/* Add margin to bottom of LaTeX equations, but only when they are not in paragraphs */
section.entry .latex{margin-bottom: 15px;}
section.entry p .latex{margin-bottom: 0px;}

/* Fix list specific issues on the "Start Here" page */
.page-id-4374 #start_here_benefits li{margin-bottom: 15px;}

/* Fix search icon */
button.icon-search.submit{margin-top: -7px;}
</style>


<!-- Woo Shortcodes CSS -->


<!-- Custom Stylesheet -->

<style type="text/css">
/* <![CDATA[ */
img.latex { vertical-align: middle; border: none; }
/* ]]> */
</style>

<!-- start Mixpanel -->
<script type="text/javascript">(function(f,b){if(!b.__SV){var a,e,i,g;window.mixpanel=b;b._i=[];b.init=function(a,e,d){function f(b,h){var a=h.split(".");2==a.length&&(b=b[a[0]],h=a[1]);b[h]=function(){b.push([h].concat(Array.prototype.slice.call(arguments,0)))}}var c=b;"undefined"!==typeof d?c=b[d]=[]:d="mixpanel";c.people=c.people||[];c.toString=function(b){var a="mixpanel";"mixpanel"!==d&&(a+="."+d);b||(a+=" (stub)");return a};c.people.toString=function(){return c.toString(1)+".people (stub)"};i="disable track track_pageview track_links track_forms register register_once alias unregister identify name_tag set_config people.set people.set_once people.increment people.append people.track_charge people.clear_charges people.delete_user".split(" ");
for(g=0;g<i.length;g++)f(c,i[g]);b._i.push([a,e,d])};b.__SV=1.2;a=f.createElement("script");a.type="text/javascript";a.async=!0;a.src="//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";e=f.getElementsByTagName("script")[0];e.parentNode.insertBefore(a,e)}})(document,window.mixpanel||[]);
mixpanel.init("2486e0f021e92605d44d32fce5f1d826");
</script>
<!-- end Mixpanel -->

<style type="text/css">@-webkit-keyframes bounce{0%,20%,50%,80%,to{-webkit-transform:translateY(0);transform:translateY(0)}40%{-webkit-transform:translateY(-30px);transform:translateY(-30px)}60%{-webkit-transform:translateY(-15px);transform:translateY(-15px)}}@keyframes bounce{0%,20%,50%,80%,to{-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0)}40%{-webkit-transform:translateY(-30px);-ms-transform:translateY(-30px);transform:translateY(-30px)}60%{-webkit-transform:translateY(-15px);-ms-transform:translateY(-15px);transform:translateY(-15px)}}.om-animation-bounce{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-name:bounce;animation-name:bounce}@-webkit-keyframes bounceIn{0%{opacity:0;-webkit-transform:scale(.3);transform:scale(.3)}50%{opacity:1;-webkit-transform:scale(1.05);transform:scale(1.05)}70%{-webkit-transform:scale(.9);transform:scale(.9)}to{opacity:1;-webkit-transform:scale(1);transform:scale(1)}}@keyframes bounceIn{0%{opacity:0;-webkit-transform:scale(.3);-ms-transform:scale(.3);transform:scale(.3)}50%{opacity:1;-webkit-transform:scale(1.05);-ms-transform:scale(1.05);transform:scale(1.05)}70%{-webkit-transform:scale(.9);-ms-transform:scale(.9);transform:scale(.9)}to{opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}.om-animation-bounce-in{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:bounceIn;animation-name:bounceIn}@-webkit-keyframes bounceInDown{0%{opacity:0;-webkit-transform:translateY(-2000px);transform:translateY(-2000px)}60%{opacity:1;-webkit-transform:translateY(30px);transform:translateY(30px)}80%{-webkit-transform:translateY(-10px);transform:translateY(-10px)}to{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes bounceInDown{0%{opacity:0;-webkit-transform:translateY(-2000px);-ms-transform:translateY(-2000px);transform:translateY(-2000px)}60%{opacity:1;-webkit-transform:translateY(30px);-ms-transform:translateY(30px);transform:translateY(30px)}80%{-webkit-transform:translateY(-10px);-ms-transform:translateY(-10px);transform:translateY(-10px)}to{-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0)}}.om-animation-bounce-in-down{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:bounceInDown;animation-name:bounceInDown}@-webkit-keyframes bounceInLeft{0%{opacity:0;-webkit-transform:translateX(-2000px);transform:translateX(-2000px)}60%{opacity:1;-webkit-transform:translateX(30px);transform:translateX(30px)}80%{-webkit-transform:translateX(-10px);transform:translateX(-10px)}to{-webkit-transform:translateX(0);transform:translateX(0)}}@keyframes bounceInLeft{0%{opacity:0;-webkit-transform:translateX(-2000px);-ms-transform:translateX(-2000px);transform:translateX(-2000px)}60%{opacity:1;-webkit-transform:translateX(30px);-ms-transform:translateX(30px);transform:translateX(30px)}80%{-webkit-transform:translateX(-10px);-ms-transform:translateX(-10px);transform:translateX(-10px)}to{-webkit-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0)}}.om-animation-bounce-in-left{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:bounceInLeft;animation-name:bounceInLeft}@-webkit-keyframes bounceInRight{0%{opacity:0;-webkit-transform:translateX(2000px);transform:translateX(2000px)}60%{opacity:1;-webkit-transform:translateX(-30px);transform:translateX(-30px)}80%{-webkit-transform:translateX(10px);transform:translateX(10px)}to{-webkit-transform:translateX(0);transform:translateX(0)}}@keyframes bounceInRight{0%{opacity:0;-webkit-transform:translateX(2000px);-ms-transform:translateX(2000px);transform:translateX(2000px)}60%{opacity:1;-webkit-transform:translateX(-30px);-ms-transform:translateX(-30px);transform:translateX(-30px)}80%{-webkit-transform:translateX(10px);-ms-transform:translateX(10px);transform:translateX(10px)}to{-webkit-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0)}}.om-animation-bounce-in-right{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:bounceInRight;animation-name:bounceInRight}@-webkit-keyframes bounceInUp{0%{opacity:0;-webkit-transform:translateY(2000px);transform:translateY(2000px)}60%{opacity:1;-webkit-transform:translateY(-30px);transform:translateY(-30px)}80%{-webkit-transform:translateY(10px);transform:translateY(10px)}to{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes bounceInUp{0%{opacity:0;-webkit-transform:translateY(2000px);-ms-transform:translateY(2000px);transform:translateY(2000px)}60%{opacity:1;-webkit-transform:translateY(-30px);-ms-transform:translateY(-30px);transform:translateY(-30px)}80%{-webkit-transform:translateY(10px);-ms-transform:translateY(10px);transform:translateY(10px)}to{-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0)}}.om-animation-bounce-in-up{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:bounceInUp;animation-name:bounceInUp}@-webkit-keyframes flash{0%,50%,to{opacity:1}25%,75%{opacity:0}}@keyframes flash{0%,50%,to{opacity:1}25%,75%{opacity:0}}.om-animation-flash{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-name:flash;animation-name:flash}@-webkit-keyframes flip{0%{-webkit-transform:perspective(800px) translateZ(0) rotateY(0) scale(1);transform:perspective(800px) translateZ(0) rotateY(0) scale(1);-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}40%{-webkit-transform:perspective(800px) translateZ(150px) rotateY(170deg) scale(1);transform:perspective(800px) translateZ(150px) rotateY(170deg) scale(1);-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}50%{-webkit-transform:perspective(800px) translateZ(150px) rotateY(190deg) scale(1);transform:perspective(800px) translateZ(150px) rotateY(190deg) scale(1);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}80%{-webkit-transform:perspective(800px) translateZ(0) rotateY(1turn) scale(.95);transform:perspective(800px) translateZ(0) rotateY(1turn) scale(.95);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}to{-webkit-transform:perspective(800px) translateZ(0) rotateY(1turn) scale(1);transform:perspective(800px) translateZ(0) rotateY(1turn) scale(1);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}}@keyframes flip{0%{-webkit-transform:perspective(800px) translateZ(0) rotateY(0) scale(1);-ms-transform:perspective(800px) translateZ(0) rotateY(0) scale(1);transform:perspective(800px) translateZ(0) rotateY(0) scale(1);-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}40%{-webkit-transform:perspective(800px) translateZ(150px) rotateY(170deg) scale(1);-ms-transform:perspective(800px) translateZ(150px) rotateY(170deg) scale(1);transform:perspective(800px) translateZ(150px) rotateY(170deg) scale(1);-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}50%{-webkit-transform:perspective(800px) translateZ(150px) rotateY(190deg) scale(1);-ms-transform:perspective(800px) translateZ(150px) rotateY(190deg) scale(1);transform:perspective(800px) translateZ(150px) rotateY(190deg) scale(1);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}80%{-webkit-transform:perspective(800px) translateZ(0) rotateY(1turn) scale(.95);-ms-transform:perspective(800px) translateZ(0) rotateY(1turn) scale(.95);transform:perspective(800px) translateZ(0) rotateY(1turn) scale(.95);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}to{-webkit-transform:perspective(800px) translateZ(0) rotateY(1turn) scale(1);-ms-transform:perspective(800px) translateZ(0) rotateY(1turn) scale(1);transform:perspective(800px) translateZ(0) rotateY(1turn) scale(1);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}}.om-animation-flip{-webkit-animation-duration:1s;animation-duration:1s;-webkit-backface-visibility:visible;-ms-backface-visibility:visible;backface-visibility:visible;-webkit-animation-name:flip;animation-name:flip}@-webkit-keyframes flipInX{0%{-webkit-transform:perspective(800px) rotateX(90deg);transform:perspective(800px) rotateX(90deg);opacity:0}40%{-webkit-transform:perspective(800px) rotateX(-10deg);transform:perspective(800px) rotateX(-10deg)}70%{-webkit-transform:perspective(800px) rotateX(10deg);transform:perspective(800px) rotateX(10deg)}to{-webkit-transform:perspective(800px) rotateX(0deg);transform:perspective(800px) rotateX(0deg);opacity:1}}@keyframes flipInX{0%{-webkit-transform:perspective(800px) rotateX(90deg);-ms-transform:perspective(800px) rotateX(90deg);transform:perspective(800px) rotateX(90deg);opacity:0}40%{-webkit-transform:perspective(800px) rotateX(-10deg);-ms-transform:perspective(800px) rotateX(-10deg);transform:perspective(800px) rotateX(-10deg)}70%{-webkit-transform:perspective(800px) rotateX(10deg);-ms-transform:perspective(800px) rotateX(10deg);transform:perspective(800px) rotateX(10deg)}to{-webkit-transform:perspective(800px) rotateX(0deg);-ms-transform:perspective(800px) rotateX(0deg);transform:perspective(800px) rotateX(0deg);opacity:1}}.om-animation-flip-down{-webkit-animation-duration:1s;animation-duration:1s;-webkit-backface-visibility:visible;-ms-backface-visibility:visible;backface-visibility:visible;-webkit-animation-name:flipInX;animation-name:flipInX}@-webkit-keyframes flipInY{0%{-webkit-transform:perspective(800px) rotateY(90deg);transform:perspective(800px) rotateY(90deg);opacity:0}40%{-webkit-transform:perspective(800px) rotateY(-10deg);transform:perspective(800px) rotateY(-10deg)}70%{-webkit-transform:perspective(800px) rotateY(10deg);transform:perspective(800px) rotateY(10deg)}to{-webkit-transform:perspective(800px) rotateY(0deg);transform:perspective(800px) rotateY(0deg);opacity:1}}@keyframes flipInY{0%{-webkit-transform:perspective(800px) rotateY(90deg);-ms-transform:perspective(800px) rotateY(90deg);transform:perspective(800px) rotateY(90deg);opacity:0}40%{-webkit-transform:perspective(800px) rotateY(-10deg);-ms-transform:perspective(800px) rotateY(-10deg);transform:perspective(800px) rotateY(-10deg)}70%{-webkit-transform:perspective(800px) rotateY(10deg);-ms-transform:perspective(800px) rotateY(10deg);transform:perspective(800px) rotateY(10deg)}to{-webkit-transform:perspective(800px) rotateY(0deg);-ms-transform:perspective(800px) rotateY(0deg);transform:perspective(800px) rotateY(0deg);opacity:1}}.om-animation-flip-side{-webkit-animation-duration:1s;animation-duration:1s;-webkit-backface-visibility:visible;-ms-backface-visibility:visible;backface-visibility:visible;-webkit-animation-name:flipInY;animation-name:flipInY}@-webkit-keyframes lightSpeedIn{0%{-webkit-transform:translateX(100%) skewX(-30deg);transform:translateX(100%) skewX(-30deg);opacity:0}60%{-webkit-transform:translateX(-20%) skewX(30deg);transform:translateX(-20%) skewX(30deg);opacity:1}80%{-webkit-transform:translateX(0) skewX(-15deg);transform:translateX(0) skewX(-15deg);opacity:1}to{-webkit-transform:translateX(0) skewX(0deg);transform:translateX(0) skewX(0deg);opacity:1}}@keyframes lightSpeedIn{0%{-webkit-transform:translateX(100%) skewX(-30deg);-ms-transform:translateX(100%) skewX(-30deg);transform:translateX(100%) skewX(-30deg);opacity:0}60%{-webkit-transform:translateX(-20%) skewX(30deg);-ms-transform:translateX(-20%) skewX(30deg);transform:translateX(-20%) skewX(30deg);opacity:1}80%{-webkit-transform:translateX(0) skewX(-15deg);-ms-transform:translateX(0) skewX(-15deg);transform:translateX(0) skewX(-15deg);opacity:1}to{-webkit-transform:translateX(0) skewX(0deg);-ms-transform:translateX(0) skewX(0deg);transform:translateX(0) skewX(0deg);opacity:1}}.om-animation-light-speed{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:lightSpeedIn;animation-name:lightSpeedIn;-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}@-webkit-keyframes pulse{0%{-webkit-transform:scale(1);transform:scale(1)}50%{-webkit-transform:scale(1.1);transform:scale(1.1)}to{-webkit-transform:scale(1);transform:scale(1)}}@keyframes pulse{0%{-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}50%{-webkit-transform:scale(1.1);-ms-transform:scale(1.1);transform:scale(1.1)}to{-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}.om-animation-pulse{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-name:pulse;animation-name:pulse}@-webkit-keyframes rollIn{0%{opacity:0;-webkit-transform:translateX(-100%) rotate(-120deg);transform:translateX(-100%) rotate(-120deg)}to{opacity:1;-webkit-transform:translateX(0) rotate(0deg);transform:translateX(0) rotate(0deg)}}@keyframes rollIn{0%{opacity:0;-webkit-transform:translateX(-100%) rotate(-120deg);-ms-transform:translateX(-100%) rotate(-120deg);transform:translateX(-100%) rotate(-120deg)}to{opacity:1;-webkit-transform:translateX(0) rotate(0deg);-ms-transform:translateX(0) rotate(0deg);transform:translateX(0) rotate(0deg)}}.om-animation-roll-in{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:rollIn;animation-name:rollIn}@-webkit-keyframes rotateIn{0%{-webkit-transform-origin:center center;transform-origin:center center;-webkit-transform:rotate(-200deg);transform:rotate(-200deg);opacity:0}to{-webkit-transform-origin:center center;transform-origin:center center;-webkit-transform:rotate(0);transform:rotate(0);opacity:1}}@keyframes rotateIn{0%{-webkit-transform-origin:center center;-ms-transform-origin:center center;transform-origin:center center;-webkit-transform:rotate(-200deg);-ms-transform:rotate(-200deg);transform:rotate(-200deg);opacity:0}to{-webkit-transform-origin:center center;-ms-transform-origin:center center;transform-origin:center center;-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);opacity:1}}.om-animation-rotate{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:rotateIn;animation-name:rotateIn}@-webkit-keyframes rotateInDownLeft{0%{-webkit-transform-origin:left bottom;transform-origin:left bottom;-webkit-transform:rotate(-90deg);transform:rotate(-90deg);opacity:0}to{-webkit-transform-origin:left bottom;transform-origin:left bottom;-webkit-transform:rotate(0);transform:rotate(0);opacity:1}}@keyframes rotateInDownLeft{0%{-webkit-transform-origin:left bottom;-ms-transform-origin:left bottom;transform-origin:left bottom;-webkit-transform:rotate(-90deg);-ms-transform:rotate(-90deg);transform:rotate(-90deg);opacity:0}to{-webkit-transform-origin:left bottom;-ms-transform-origin:left bottom;transform-origin:left bottom;-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);opacity:1}}.om-animation-rotate-down-left{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:rotateInDownLeft;animation-name:rotateInDownLeft}@-webkit-keyframes rotateInDownRight{0%{-webkit-transform-origin:right bottom;transform-origin:right bottom;-webkit-transform:rotate(90deg);transform:rotate(90deg);opacity:0}to{-webkit-transform-origin:right bottom;transform-origin:right bottom;-webkit-transform:rotate(0);transform:rotate(0);opacity:1}}@keyframes rotateInDownRight{0%{-webkit-transform-origin:right bottom;-ms-transform-origin:right bottom;transform-origin:right bottom;-webkit-transform:rotate(90deg);-ms-transform:rotate(90deg);transform:rotate(90deg);opacity:0}to{-webkit-transform-origin:right bottom;-ms-transform-origin:right bottom;transform-origin:right bottom;-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);opacity:1}}.om-animation-rotate-down-right{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:rotateInDownRight;animation-name:rotateInDownRight}@-webkit-keyframes rotateInUpLeft{0%{-webkit-transform-origin:left bottom;transform-origin:left bottom;-webkit-transform:rotate(90deg);transform:rotate(90deg);opacity:0}to{-webkit-transform-origin:left bottom;transform-origin:left bottom;-webkit-transform:rotate(0);transform:rotate(0);opacity:1}}@keyframes rotateInUpLeft{0%{-webkit-transform-origin:left bottom;-ms-transform-origin:left bottom;transform-origin:left bottom;-webkit-transform:rotate(90deg);-ms-transform:rotate(90deg);transform:rotate(90deg);opacity:0}to{-webkit-transform-origin:left bottom;-ms-transform-origin:left bottom;transform-origin:left bottom;-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);opacity:1}}.om-animation-rotate-up-left{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:rotateInUpLeft;animation-name:rotateInUpLeft}@-webkit-keyframes rotateInUpRight{0%{-webkit-transform-origin:right bottom;transform-origin:right bottom;-webkit-transform:rotate(-90deg);transform:rotate(-90deg);opacity:0}to{-webkit-transform-origin:right bottom;transform-origin:right bottom;-webkit-transform:rotate(0);transform:rotate(0);opacity:1}}@keyframes rotateInUpRight{0%{-webkit-transform-origin:right bottom;-ms-transform-origin:right bottom;transform-origin:right bottom;-webkit-transform:rotate(-90deg);-ms-transform:rotate(-90deg);transform:rotate(-90deg);opacity:0}to{-webkit-transform-origin:right bottom;-ms-transform-origin:right bottom;transform-origin:right bottom;-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);opacity:1}}.om-animation-rotate-up-right{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:rotateInUpRight;animation-name:rotateInUpRight}@-webkit-keyframes rubberBand{0%{-webkit-transform:scale(1);transform:scale(1)}30%{-webkit-transform:scaleX(1.25) scaleY(.75);transform:scaleX(1.25) scaleY(.75)}40%{-webkit-transform:scaleX(.75) scaleY(1.25);transform:scaleX(.75) scaleY(1.25)}60%{-webkit-transform:scaleX(1.15) scaleY(.85);transform:scaleX(1.15) scaleY(.85)}to{-webkit-transform:scale(1);transform:scale(1)}}@keyframes rubberBand{0%{-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}30%{-webkit-transform:scaleX(1.25) scaleY(.75);-ms-transform:scaleX(1.25) scaleY(.75);transform:scaleX(1.25) scaleY(.75)}40%{-webkit-transform:scaleX(.75) scaleY(1.25);-ms-transform:scaleX(.75) scaleY(1.25);transform:scaleX(.75) scaleY(1.25)}60%{-webkit-transform:scaleX(1.15) scaleY(.85);-ms-transform:scaleX(1.15) scaleY(.85);transform:scaleX(1.15) scaleY(.85)}to{-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}.om-animation-rubber-band{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-name:rubberBand;animation-name:rubberBand}@-webkit-keyframes shake{0%,to{-webkit-transform:translateX(0);transform:translateX(0)}10%,30%,50%,70%,90%{-webkit-transform:translateX(-10px);transform:translateX(-10px)}20%,40%,60%,80%{-webkit-transform:translateX(10px);transform:translateX(10px)}}@keyframes shake{0%,to{-webkit-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0)}10%,30%,50%,70%,90%{-webkit-transform:translateX(-10px);-ms-transform:translateX(-10px);transform:translateX(-10px)}20%,40%,60%,80%{-webkit-transform:translateX(10px);-ms-transform:translateX(10px);transform:translateX(10px)}}.om-animation-shake{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-name:shake;animation-name:shake}@-webkit-keyframes slideInDown{0%{opacity:0;-webkit-transform:translateY(-2000px);transform:translateY(-2000px)}to{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes slideInDown{0%{opacity:0;-webkit-transform:translateY(-2000px);-ms-transform:translateY(-2000px);transform:translateY(-2000px)}to{-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0)}}.om-animation-slide-in-down{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:slideInDown;animation-name:slideInDown}@-webkit-keyframes slideInLeft{0%{opacity:0;-webkit-transform:translateX(-2000px);transform:translateX(-2000px)}to{-webkit-transform:translateX(0);transform:translateX(0)}}@keyframes slideInLeft{0%{opacity:0;-webkit-transform:translateX(-2000px);-ms-transform:translateX(-2000px);transform:translateX(-2000px)}to{-webkit-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0)}}.om-animation-slide-in-left{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:slideInLeft;animation-name:slideInLeft}@-webkit-keyframes slideInRight{0%{opacity:0;-webkit-transform:translateX(2000px);transform:translateX(2000px)}to{-webkit-transform:translateX(0);transform:translateX(0)}}@keyframes slideInRight{0%{opacity:0;-webkit-transform:translateX(2000px);-ms-transform:translateX(2000px);transform:translateX(2000px)}to{-webkit-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0)}}.om-animation-slide-in-right{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:slideInRight;animation-name:slideInRight}@-webkit-keyframes swing{20%{-webkit-transform:rotate(15deg);transform:rotate(15deg)}40%{-webkit-transform:rotate(-10deg);transform:rotate(-10deg)}60%{-webkit-transform:rotate(5deg);transform:rotate(5deg)}80%{-webkit-transform:rotate(-5deg);transform:rotate(-5deg)}to{-webkit-transform:rotate(0deg);transform:rotate(0deg)}}@keyframes swing{20%{-webkit-transform:rotate(15deg);-ms-transform:rotate(15deg);transform:rotate(15deg)}40%{-webkit-transform:rotate(-10deg);-ms-transform:rotate(-10deg);transform:rotate(-10deg)}60%{-webkit-transform:rotate(5deg);-ms-transform:rotate(5deg);transform:rotate(5deg)}80%{-webkit-transform:rotate(-5deg);-ms-transform:rotate(-5deg);transform:rotate(-5deg)}to{-webkit-transform:rotate(0deg);-ms-transform:rotate(0deg);transform:rotate(0deg)}}.om-animation-swing{-webkit-animation-duration:1s;animation-duration:1s;-webkit-transform-origin:top center;-ms-transform-origin:top center;transform-origin:top center;-webkit-animation-name:swing;animation-name:swing}@-webkit-keyframes tada{0%{-webkit-transform:scale(1);transform:scale(1)}10%,20%{-webkit-transform:scale(.9) rotate(-3deg);transform:scale(.9) rotate(-3deg)}30%,50%,70%,90%{-webkit-transform:scale(1.1) rotate(3deg);transform:scale(1.1) rotate(3deg)}40%,60%,80%{-webkit-transform:scale(1.1) rotate(-3deg);transform:scale(1.1) rotate(-3deg)}to{-webkit-transform:scale(1) rotate(0);transform:scale(1) rotate(0)}}@keyframes tada{0%{-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}10%,20%{-webkit-transform:scale(.9) rotate(-3deg);-ms-transform:scale(.9) rotate(-3deg);transform:scale(.9) rotate(-3deg)}30%,50%,70%,90%{-webkit-transform:scale(1.1) rotate(3deg);-ms-transform:scale(1.1) rotate(3deg);transform:scale(1.1) rotate(3deg)}40%,60%,80%{-webkit-transform:scale(1.1) rotate(-3deg);-ms-transform:scale(1.1) rotate(-3deg);transform:scale(1.1) rotate(-3deg)}to{-webkit-transform:scale(1) rotate(0);-ms-transform:scale(1) rotate(0);transform:scale(1) rotate(0)}}.om-animation-tada{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:tada;animation-name:tada}@-webkit-keyframes wobble{0%{-webkit-transform:translateX(0);transform:translateX(0)}15%{-webkit-transform:translateX(-25%) rotate(-5deg);transform:translateX(-25%) rotate(-5deg)}30%{-webkit-transform:translateX(20%) rotate(3deg);transform:translateX(20%) rotate(3deg)}45%{-webkit-transform:translateX(-15%) rotate(-3deg);transform:translateX(-15%) rotate(-3deg)}60%{-webkit-transform:translateX(10%) rotate(2deg);transform:translateX(10%) rotate(2deg)}75%{-webkit-transform:translateX(-5%) rotate(-1deg);transform:translateX(-5%) rotate(-1deg)}to{-webkit-transform:translateX(0);transform:translateX(0)}}@keyframes wobble{0%{-webkit-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0)}15%{-webkit-transform:translateX(-25%) rotate(-5deg);-ms-transform:translateX(-25%) rotate(-5deg);transform:translateX(-25%) rotate(-5deg)}30%{-webkit-transform:translateX(20%) rotate(3deg);-ms-transform:translateX(20%) rotate(3deg);transform:translateX(20%) rotate(3deg)}45%{-webkit-transform:translateX(-15%) rotate(-3deg);-ms-transform:translateX(-15%) rotate(-3deg);transform:translateX(-15%) rotate(-3deg)}60%{-webkit-transform:translateX(10%) rotate(2deg);-ms-transform:translateX(10%) rotate(2deg);transform:translateX(10%) rotate(2deg)}75%{-webkit-transform:translateX(-5%) rotate(-1deg);-ms-transform:translateX(-5%) rotate(-1deg);transform:translateX(-5%) rotate(-1deg)}to{-webkit-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0)}}.om-animation-wobble{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:wobble;animation-name:wobble}.optin-loader{position:relative;color:transparent!important}@keyframes scale{0%{transform:scale(0)}to{transform:scale(1)}}@keyframes opacity{0%{opacity:1}to{opacity:0}}.optin-loader:after,.optin-loader:before{content:"";display:block;position:absolute;border-width:2px;border-style:solid;border-radius:50%;width:26px;height:26px;left:50%;margin-left:-15px;top:50%;margin-top:-15px;opacity:0;animation:scale 1.8s cubic-bezier(.165,.84,.44,1),opacity 1.8s cubic-bezier(.3,.61,.355,1);animation-iteration-count:infinite}.optin-loader:after{animation-delay:.9s}.optin-loader.optin-loader-dark:after,.optin-loader.optin-loader-dark:before{border-color:#60656f}.optin-loader.optin-loader-light:after,.optin-loader.optin-loader-light:before{border-color:#fff}.om-content-lock{color:transparent!important;text-shadow:rgba(0,0,0,.5) 0 0 10px;-webkit-user-select:none;-moz-user-select:none;user-select:none;pointer-events:none;filter:url("data:image/svg+xml;utf9,<svg%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'><filter%20id='blur'><feGaussianBlur%20stdDeviation='10'%20/></filter></svg>#blur");-webkit-filter:blur(10px);-ms-filter:blur(10px);-o-filter:blur(10px);filter:blur(10px)}</style><style type="text/css">@-webkit-keyframes bounce{0%,20%,50%,80%,to{-webkit-transform:translateY(0);transform:translateY(0)}40%{-webkit-transform:translateY(-30px);transform:translateY(-30px)}60%{-webkit-transform:translateY(-15px);transform:translateY(-15px)}}@keyframes bounce{0%,20%,50%,80%,to{-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0)}40%{-webkit-transform:translateY(-30px);-ms-transform:translateY(-30px);transform:translateY(-30px)}60%{-webkit-transform:translateY(-15px);-ms-transform:translateY(-15px);transform:translateY(-15px)}}.om-animation-bounce{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-name:bounce;animation-name:bounce}@-webkit-keyframes bounceIn{0%{opacity:0;-webkit-transform:scale(.3);transform:scale(.3)}50%{opacity:1;-webkit-transform:scale(1.05);transform:scale(1.05)}70%{-webkit-transform:scale(.9);transform:scale(.9)}to{opacity:1;-webkit-transform:scale(1);transform:scale(1)}}@keyframes bounceIn{0%{opacity:0;-webkit-transform:scale(.3);-ms-transform:scale(.3);transform:scale(.3)}50%{opacity:1;-webkit-transform:scale(1.05);-ms-transform:scale(1.05);transform:scale(1.05)}70%{-webkit-transform:scale(.9);-ms-transform:scale(.9);transform:scale(.9)}to{opacity:1;-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}.om-animation-bounce-in{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:bounceIn;animation-name:bounceIn}@-webkit-keyframes bounceInDown{0%{opacity:0;-webkit-transform:translateY(-2000px);transform:translateY(-2000px)}60%{opacity:1;-webkit-transform:translateY(30px);transform:translateY(30px)}80%{-webkit-transform:translateY(-10px);transform:translateY(-10px)}to{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes bounceInDown{0%{opacity:0;-webkit-transform:translateY(-2000px);-ms-transform:translateY(-2000px);transform:translateY(-2000px)}60%{opacity:1;-webkit-transform:translateY(30px);-ms-transform:translateY(30px);transform:translateY(30px)}80%{-webkit-transform:translateY(-10px);-ms-transform:translateY(-10px);transform:translateY(-10px)}to{-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0)}}.om-animation-bounce-in-down{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:bounceInDown;animation-name:bounceInDown}@-webkit-keyframes bounceInLeft{0%{opacity:0;-webkit-transform:translateX(-2000px);transform:translateX(-2000px)}60%{opacity:1;-webkit-transform:translateX(30px);transform:translateX(30px)}80%{-webkit-transform:translateX(-10px);transform:translateX(-10px)}to{-webkit-transform:translateX(0);transform:translateX(0)}}@keyframes bounceInLeft{0%{opacity:0;-webkit-transform:translateX(-2000px);-ms-transform:translateX(-2000px);transform:translateX(-2000px)}60%{opacity:1;-webkit-transform:translateX(30px);-ms-transform:translateX(30px);transform:translateX(30px)}80%{-webkit-transform:translateX(-10px);-ms-transform:translateX(-10px);transform:translateX(-10px)}to{-webkit-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0)}}.om-animation-bounce-in-left{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:bounceInLeft;animation-name:bounceInLeft}@-webkit-keyframes bounceInRight{0%{opacity:0;-webkit-transform:translateX(2000px);transform:translateX(2000px)}60%{opacity:1;-webkit-transform:translateX(-30px);transform:translateX(-30px)}80%{-webkit-transform:translateX(10px);transform:translateX(10px)}to{-webkit-transform:translateX(0);transform:translateX(0)}}@keyframes bounceInRight{0%{opacity:0;-webkit-transform:translateX(2000px);-ms-transform:translateX(2000px);transform:translateX(2000px)}60%{opacity:1;-webkit-transform:translateX(-30px);-ms-transform:translateX(-30px);transform:translateX(-30px)}80%{-webkit-transform:translateX(10px);-ms-transform:translateX(10px);transform:translateX(10px)}to{-webkit-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0)}}.om-animation-bounce-in-right{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:bounceInRight;animation-name:bounceInRight}@-webkit-keyframes bounceInUp{0%{opacity:0;-webkit-transform:translateY(2000px);transform:translateY(2000px)}60%{opacity:1;-webkit-transform:translateY(-30px);transform:translateY(-30px)}80%{-webkit-transform:translateY(10px);transform:translateY(10px)}to{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes bounceInUp{0%{opacity:0;-webkit-transform:translateY(2000px);-ms-transform:translateY(2000px);transform:translateY(2000px)}60%{opacity:1;-webkit-transform:translateY(-30px);-ms-transform:translateY(-30px);transform:translateY(-30px)}80%{-webkit-transform:translateY(10px);-ms-transform:translateY(10px);transform:translateY(10px)}to{-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0)}}.om-animation-bounce-in-up{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:bounceInUp;animation-name:bounceInUp}@-webkit-keyframes flash{0%,50%,to{opacity:1}25%,75%{opacity:0}}@keyframes flash{0%,50%,to{opacity:1}25%,75%{opacity:0}}.om-animation-flash{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-name:flash;animation-name:flash}@-webkit-keyframes flip{0%{-webkit-transform:perspective(800px) translateZ(0) rotateY(0) scale(1);transform:perspective(800px) translateZ(0) rotateY(0) scale(1);-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}40%{-webkit-transform:perspective(800px) translateZ(150px) rotateY(170deg) scale(1);transform:perspective(800px) translateZ(150px) rotateY(170deg) scale(1);-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}50%{-webkit-transform:perspective(800px) translateZ(150px) rotateY(190deg) scale(1);transform:perspective(800px) translateZ(150px) rotateY(190deg) scale(1);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}80%{-webkit-transform:perspective(800px) translateZ(0) rotateY(1turn) scale(.95);transform:perspective(800px) translateZ(0) rotateY(1turn) scale(.95);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}to{-webkit-transform:perspective(800px) translateZ(0) rotateY(1turn) scale(1);transform:perspective(800px) translateZ(0) rotateY(1turn) scale(1);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}}@keyframes flip{0%{-webkit-transform:perspective(800px) translateZ(0) rotateY(0) scale(1);-ms-transform:perspective(800px) translateZ(0) rotateY(0) scale(1);transform:perspective(800px) translateZ(0) rotateY(0) scale(1);-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}40%{-webkit-transform:perspective(800px) translateZ(150px) rotateY(170deg) scale(1);-ms-transform:perspective(800px) translateZ(150px) rotateY(170deg) scale(1);transform:perspective(800px) translateZ(150px) rotateY(170deg) scale(1);-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}50%{-webkit-transform:perspective(800px) translateZ(150px) rotateY(190deg) scale(1);-ms-transform:perspective(800px) translateZ(150px) rotateY(190deg) scale(1);transform:perspective(800px) translateZ(150px) rotateY(190deg) scale(1);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}80%{-webkit-transform:perspective(800px) translateZ(0) rotateY(1turn) scale(.95);-ms-transform:perspective(800px) translateZ(0) rotateY(1turn) scale(.95);transform:perspective(800px) translateZ(0) rotateY(1turn) scale(.95);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}to{-webkit-transform:perspective(800px) translateZ(0) rotateY(1turn) scale(1);-ms-transform:perspective(800px) translateZ(0) rotateY(1turn) scale(1);transform:perspective(800px) translateZ(0) rotateY(1turn) scale(1);-webkit-animation-timing-function:ease-in;animation-timing-function:ease-in}}.om-animation-flip{-webkit-animation-duration:1s;animation-duration:1s;-webkit-backface-visibility:visible;-ms-backface-visibility:visible;backface-visibility:visible;-webkit-animation-name:flip;animation-name:flip}@-webkit-keyframes flipInX{0%{-webkit-transform:perspective(800px) rotateX(90deg);transform:perspective(800px) rotateX(90deg);opacity:0}40%{-webkit-transform:perspective(800px) rotateX(-10deg);transform:perspective(800px) rotateX(-10deg)}70%{-webkit-transform:perspective(800px) rotateX(10deg);transform:perspective(800px) rotateX(10deg)}to{-webkit-transform:perspective(800px) rotateX(0deg);transform:perspective(800px) rotateX(0deg);opacity:1}}@keyframes flipInX{0%{-webkit-transform:perspective(800px) rotateX(90deg);-ms-transform:perspective(800px) rotateX(90deg);transform:perspective(800px) rotateX(90deg);opacity:0}40%{-webkit-transform:perspective(800px) rotateX(-10deg);-ms-transform:perspective(800px) rotateX(-10deg);transform:perspective(800px) rotateX(-10deg)}70%{-webkit-transform:perspective(800px) rotateX(10deg);-ms-transform:perspective(800px) rotateX(10deg);transform:perspective(800px) rotateX(10deg)}to{-webkit-transform:perspective(800px) rotateX(0deg);-ms-transform:perspective(800px) rotateX(0deg);transform:perspective(800px) rotateX(0deg);opacity:1}}.om-animation-flip-down{-webkit-animation-duration:1s;animation-duration:1s;-webkit-backface-visibility:visible;-ms-backface-visibility:visible;backface-visibility:visible;-webkit-animation-name:flipInX;animation-name:flipInX}@-webkit-keyframes flipInY{0%{-webkit-transform:perspective(800px) rotateY(90deg);transform:perspective(800px) rotateY(90deg);opacity:0}40%{-webkit-transform:perspective(800px) rotateY(-10deg);transform:perspective(800px) rotateY(-10deg)}70%{-webkit-transform:perspective(800px) rotateY(10deg);transform:perspective(800px) rotateY(10deg)}to{-webkit-transform:perspective(800px) rotateY(0deg);transform:perspective(800px) rotateY(0deg);opacity:1}}@keyframes flipInY{0%{-webkit-transform:perspective(800px) rotateY(90deg);-ms-transform:perspective(800px) rotateY(90deg);transform:perspective(800px) rotateY(90deg);opacity:0}40%{-webkit-transform:perspective(800px) rotateY(-10deg);-ms-transform:perspective(800px) rotateY(-10deg);transform:perspective(800px) rotateY(-10deg)}70%{-webkit-transform:perspective(800px) rotateY(10deg);-ms-transform:perspective(800px) rotateY(10deg);transform:perspective(800px) rotateY(10deg)}to{-webkit-transform:perspective(800px) rotateY(0deg);-ms-transform:perspective(800px) rotateY(0deg);transform:perspective(800px) rotateY(0deg);opacity:1}}.om-animation-flip-side{-webkit-animation-duration:1s;animation-duration:1s;-webkit-backface-visibility:visible;-ms-backface-visibility:visible;backface-visibility:visible;-webkit-animation-name:flipInY;animation-name:flipInY}@-webkit-keyframes lightSpeedIn{0%{-webkit-transform:translateX(100%) skewX(-30deg);transform:translateX(100%) skewX(-30deg);opacity:0}60%{-webkit-transform:translateX(-20%) skewX(30deg);transform:translateX(-20%) skewX(30deg);opacity:1}80%{-webkit-transform:translateX(0) skewX(-15deg);transform:translateX(0) skewX(-15deg);opacity:1}to{-webkit-transform:translateX(0) skewX(0deg);transform:translateX(0) skewX(0deg);opacity:1}}@keyframes lightSpeedIn{0%{-webkit-transform:translateX(100%) skewX(-30deg);-ms-transform:translateX(100%) skewX(-30deg);transform:translateX(100%) skewX(-30deg);opacity:0}60%{-webkit-transform:translateX(-20%) skewX(30deg);-ms-transform:translateX(-20%) skewX(30deg);transform:translateX(-20%) skewX(30deg);opacity:1}80%{-webkit-transform:translateX(0) skewX(-15deg);-ms-transform:translateX(0) skewX(-15deg);transform:translateX(0) skewX(-15deg);opacity:1}to{-webkit-transform:translateX(0) skewX(0deg);-ms-transform:translateX(0) skewX(0deg);transform:translateX(0) skewX(0deg);opacity:1}}.om-animation-light-speed{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:lightSpeedIn;animation-name:lightSpeedIn;-webkit-animation-timing-function:ease-out;animation-timing-function:ease-out}@-webkit-keyframes pulse{0%{-webkit-transform:scale(1);transform:scale(1)}50%{-webkit-transform:scale(1.1);transform:scale(1.1)}to{-webkit-transform:scale(1);transform:scale(1)}}@keyframes pulse{0%{-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}50%{-webkit-transform:scale(1.1);-ms-transform:scale(1.1);transform:scale(1.1)}to{-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}.om-animation-pulse{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-name:pulse;animation-name:pulse}@-webkit-keyframes rollIn{0%{opacity:0;-webkit-transform:translateX(-100%) rotate(-120deg);transform:translateX(-100%) rotate(-120deg)}to{opacity:1;-webkit-transform:translateX(0) rotate(0deg);transform:translateX(0) rotate(0deg)}}@keyframes rollIn{0%{opacity:0;-webkit-transform:translateX(-100%) rotate(-120deg);-ms-transform:translateX(-100%) rotate(-120deg);transform:translateX(-100%) rotate(-120deg)}to{opacity:1;-webkit-transform:translateX(0) rotate(0deg);-ms-transform:translateX(0) rotate(0deg);transform:translateX(0) rotate(0deg)}}.om-animation-roll-in{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:rollIn;animation-name:rollIn}@-webkit-keyframes rotateIn{0%{-webkit-transform-origin:center center;transform-origin:center center;-webkit-transform:rotate(-200deg);transform:rotate(-200deg);opacity:0}to{-webkit-transform-origin:center center;transform-origin:center center;-webkit-transform:rotate(0);transform:rotate(0);opacity:1}}@keyframes rotateIn{0%{-webkit-transform-origin:center center;-ms-transform-origin:center center;transform-origin:center center;-webkit-transform:rotate(-200deg);-ms-transform:rotate(-200deg);transform:rotate(-200deg);opacity:0}to{-webkit-transform-origin:center center;-ms-transform-origin:center center;transform-origin:center center;-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);opacity:1}}.om-animation-rotate{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:rotateIn;animation-name:rotateIn}@-webkit-keyframes rotateInDownLeft{0%{-webkit-transform-origin:left bottom;transform-origin:left bottom;-webkit-transform:rotate(-90deg);transform:rotate(-90deg);opacity:0}to{-webkit-transform-origin:left bottom;transform-origin:left bottom;-webkit-transform:rotate(0);transform:rotate(0);opacity:1}}@keyframes rotateInDownLeft{0%{-webkit-transform-origin:left bottom;-ms-transform-origin:left bottom;transform-origin:left bottom;-webkit-transform:rotate(-90deg);-ms-transform:rotate(-90deg);transform:rotate(-90deg);opacity:0}to{-webkit-transform-origin:left bottom;-ms-transform-origin:left bottom;transform-origin:left bottom;-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);opacity:1}}.om-animation-rotate-down-left{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:rotateInDownLeft;animation-name:rotateInDownLeft}@-webkit-keyframes rotateInDownRight{0%{-webkit-transform-origin:right bottom;transform-origin:right bottom;-webkit-transform:rotate(90deg);transform:rotate(90deg);opacity:0}to{-webkit-transform-origin:right bottom;transform-origin:right bottom;-webkit-transform:rotate(0);transform:rotate(0);opacity:1}}@keyframes rotateInDownRight{0%{-webkit-transform-origin:right bottom;-ms-transform-origin:right bottom;transform-origin:right bottom;-webkit-transform:rotate(90deg);-ms-transform:rotate(90deg);transform:rotate(90deg);opacity:0}to{-webkit-transform-origin:right bottom;-ms-transform-origin:right bottom;transform-origin:right bottom;-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);opacity:1}}.om-animation-rotate-down-right{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:rotateInDownRight;animation-name:rotateInDownRight}@-webkit-keyframes rotateInUpLeft{0%{-webkit-transform-origin:left bottom;transform-origin:left bottom;-webkit-transform:rotate(90deg);transform:rotate(90deg);opacity:0}to{-webkit-transform-origin:left bottom;transform-origin:left bottom;-webkit-transform:rotate(0);transform:rotate(0);opacity:1}}@keyframes rotateInUpLeft{0%{-webkit-transform-origin:left bottom;-ms-transform-origin:left bottom;transform-origin:left bottom;-webkit-transform:rotate(90deg);-ms-transform:rotate(90deg);transform:rotate(90deg);opacity:0}to{-webkit-transform-origin:left bottom;-ms-transform-origin:left bottom;transform-origin:left bottom;-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);opacity:1}}.om-animation-rotate-up-left{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:rotateInUpLeft;animation-name:rotateInUpLeft}@-webkit-keyframes rotateInUpRight{0%{-webkit-transform-origin:right bottom;transform-origin:right bottom;-webkit-transform:rotate(-90deg);transform:rotate(-90deg);opacity:0}to{-webkit-transform-origin:right bottom;transform-origin:right bottom;-webkit-transform:rotate(0);transform:rotate(0);opacity:1}}@keyframes rotateInUpRight{0%{-webkit-transform-origin:right bottom;-ms-transform-origin:right bottom;transform-origin:right bottom;-webkit-transform:rotate(-90deg);-ms-transform:rotate(-90deg);transform:rotate(-90deg);opacity:0}to{-webkit-transform-origin:right bottom;-ms-transform-origin:right bottom;transform-origin:right bottom;-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);opacity:1}}.om-animation-rotate-up-right{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:rotateInUpRight;animation-name:rotateInUpRight}@-webkit-keyframes rubberBand{0%{-webkit-transform:scale(1);transform:scale(1)}30%{-webkit-transform:scaleX(1.25) scaleY(.75);transform:scaleX(1.25) scaleY(.75)}40%{-webkit-transform:scaleX(.75) scaleY(1.25);transform:scaleX(.75) scaleY(1.25)}60%{-webkit-transform:scaleX(1.15) scaleY(.85);transform:scaleX(1.15) scaleY(.85)}to{-webkit-transform:scale(1);transform:scale(1)}}@keyframes rubberBand{0%{-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}30%{-webkit-transform:scaleX(1.25) scaleY(.75);-ms-transform:scaleX(1.25) scaleY(.75);transform:scaleX(1.25) scaleY(.75)}40%{-webkit-transform:scaleX(.75) scaleY(1.25);-ms-transform:scaleX(.75) scaleY(1.25);transform:scaleX(.75) scaleY(1.25)}60%{-webkit-transform:scaleX(1.15) scaleY(.85);-ms-transform:scaleX(1.15) scaleY(.85);transform:scaleX(1.15) scaleY(.85)}to{-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}}.om-animation-rubber-band{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-name:rubberBand;animation-name:rubberBand}@-webkit-keyframes shake{0%,to{-webkit-transform:translateX(0);transform:translateX(0)}10%,30%,50%,70%,90%{-webkit-transform:translateX(-10px);transform:translateX(-10px)}20%,40%,60%,80%{-webkit-transform:translateX(10px);transform:translateX(10px)}}@keyframes shake{0%,to{-webkit-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0)}10%,30%,50%,70%,90%{-webkit-transform:translateX(-10px);-ms-transform:translateX(-10px);transform:translateX(-10px)}20%,40%,60%,80%{-webkit-transform:translateX(10px);-ms-transform:translateX(10px);transform:translateX(10px)}}.om-animation-shake{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-fill-mode:both;animation-fill-mode:both;-webkit-animation-name:shake;animation-name:shake}@-webkit-keyframes slideInDown{0%{opacity:0;-webkit-transform:translateY(-2000px);transform:translateY(-2000px)}to{-webkit-transform:translateY(0);transform:translateY(0)}}@keyframes slideInDown{0%{opacity:0;-webkit-transform:translateY(-2000px);-ms-transform:translateY(-2000px);transform:translateY(-2000px)}to{-webkit-transform:translateY(0);-ms-transform:translateY(0);transform:translateY(0)}}.om-animation-slide-in-down{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:slideInDown;animation-name:slideInDown}@-webkit-keyframes slideInLeft{0%{opacity:0;-webkit-transform:translateX(-2000px);transform:translateX(-2000px)}to{-webkit-transform:translateX(0);transform:translateX(0)}}@keyframes slideInLeft{0%{opacity:0;-webkit-transform:translateX(-2000px);-ms-transform:translateX(-2000px);transform:translateX(-2000px)}to{-webkit-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0)}}.om-animation-slide-in-left{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:slideInLeft;animation-name:slideInLeft}@-webkit-keyframes slideInRight{0%{opacity:0;-webkit-transform:translateX(2000px);transform:translateX(2000px)}to{-webkit-transform:translateX(0);transform:translateX(0)}}@keyframes slideInRight{0%{opacity:0;-webkit-transform:translateX(2000px);-ms-transform:translateX(2000px);transform:translateX(2000px)}to{-webkit-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0)}}.om-animation-slide-in-right{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:slideInRight;animation-name:slideInRight}@-webkit-keyframes swing{20%{-webkit-transform:rotate(15deg);transform:rotate(15deg)}40%{-webkit-transform:rotate(-10deg);transform:rotate(-10deg)}60%{-webkit-transform:rotate(5deg);transform:rotate(5deg)}80%{-webkit-transform:rotate(-5deg);transform:rotate(-5deg)}to{-webkit-transform:rotate(0deg);transform:rotate(0deg)}}@keyframes swing{20%{-webkit-transform:rotate(15deg);-ms-transform:rotate(15deg);transform:rotate(15deg)}40%{-webkit-transform:rotate(-10deg);-ms-transform:rotate(-10deg);transform:rotate(-10deg)}60%{-webkit-transform:rotate(5deg);-ms-transform:rotate(5deg);transform:rotate(5deg)}80%{-webkit-transform:rotate(-5deg);-ms-transform:rotate(-5deg);transform:rotate(-5deg)}to{-webkit-transform:rotate(0deg);-ms-transform:rotate(0deg);transform:rotate(0deg)}}.om-animation-swing{-webkit-animation-duration:1s;animation-duration:1s;-webkit-transform-origin:top center;-ms-transform-origin:top center;transform-origin:top center;-webkit-animation-name:swing;animation-name:swing}@-webkit-keyframes tada{0%{-webkit-transform:scale(1);transform:scale(1)}10%,20%{-webkit-transform:scale(.9) rotate(-3deg);transform:scale(.9) rotate(-3deg)}30%,50%,70%,90%{-webkit-transform:scale(1.1) rotate(3deg);transform:scale(1.1) rotate(3deg)}40%,60%,80%{-webkit-transform:scale(1.1) rotate(-3deg);transform:scale(1.1) rotate(-3deg)}to{-webkit-transform:scale(1) rotate(0);transform:scale(1) rotate(0)}}@keyframes tada{0%{-webkit-transform:scale(1);-ms-transform:scale(1);transform:scale(1)}10%,20%{-webkit-transform:scale(.9) rotate(-3deg);-ms-transform:scale(.9) rotate(-3deg);transform:scale(.9) rotate(-3deg)}30%,50%,70%,90%{-webkit-transform:scale(1.1) rotate(3deg);-ms-transform:scale(1.1) rotate(3deg);transform:scale(1.1) rotate(3deg)}40%,60%,80%{-webkit-transform:scale(1.1) rotate(-3deg);-ms-transform:scale(1.1) rotate(-3deg);transform:scale(1.1) rotate(-3deg)}to{-webkit-transform:scale(1) rotate(0);-ms-transform:scale(1) rotate(0);transform:scale(1) rotate(0)}}.om-animation-tada{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:tada;animation-name:tada}@-webkit-keyframes wobble{0%{-webkit-transform:translateX(0);transform:translateX(0)}15%{-webkit-transform:translateX(-25%) rotate(-5deg);transform:translateX(-25%) rotate(-5deg)}30%{-webkit-transform:translateX(20%) rotate(3deg);transform:translateX(20%) rotate(3deg)}45%{-webkit-transform:translateX(-15%) rotate(-3deg);transform:translateX(-15%) rotate(-3deg)}60%{-webkit-transform:translateX(10%) rotate(2deg);transform:translateX(10%) rotate(2deg)}75%{-webkit-transform:translateX(-5%) rotate(-1deg);transform:translateX(-5%) rotate(-1deg)}to{-webkit-transform:translateX(0);transform:translateX(0)}}@keyframes wobble{0%{-webkit-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0)}15%{-webkit-transform:translateX(-25%) rotate(-5deg);-ms-transform:translateX(-25%) rotate(-5deg);transform:translateX(-25%) rotate(-5deg)}30%{-webkit-transform:translateX(20%) rotate(3deg);-ms-transform:translateX(20%) rotate(3deg);transform:translateX(20%) rotate(3deg)}45%{-webkit-transform:translateX(-15%) rotate(-3deg);-ms-transform:translateX(-15%) rotate(-3deg);transform:translateX(-15%) rotate(-3deg)}60%{-webkit-transform:translateX(10%) rotate(2deg);-ms-transform:translateX(10%) rotate(2deg);transform:translateX(10%) rotate(2deg)}75%{-webkit-transform:translateX(-5%) rotate(-1deg);-ms-transform:translateX(-5%) rotate(-1deg);transform:translateX(-5%) rotate(-1deg)}to{-webkit-transform:translateX(0);-ms-transform:translateX(0);transform:translateX(0)}}.om-animation-wobble{-webkit-animation-duration:1s;animation-duration:1s;-webkit-animation-name:wobble;animation-name:wobble}.optin-loader{position:relative;color:transparent!important}@keyframes scale{0%{transform:scale(0)}to{transform:scale(1)}}@keyframes opacity{0%{opacity:1}to{opacity:0}}.optin-loader:after,.optin-loader:before{content:"";display:block;position:absolute;border-width:2px;border-style:solid;border-radius:50%;width:26px;height:26px;left:50%;margin-left:-15px;top:50%;margin-top:-15px;opacity:0;animation:scale 1.8s cubic-bezier(.165,.84,.44,1),opacity 1.8s cubic-bezier(.3,.61,.355,1);animation-iteration-count:infinite}.optin-loader:after{animation-delay:.9s}.optin-loader.optin-loader-dark:after,.optin-loader.optin-loader-dark:before{border-color:#60656f}.optin-loader.optin-loader-light:after,.optin-loader.optin-loader-light:before{border-color:#fff}.om-content-lock{color:transparent!important;text-shadow:rgba(0,0,0,.5) 0 0 10px;-webkit-user-select:none;-moz-user-select:none;user-select:none;pointer-events:none;filter:url("data:image/svg+xml;utf9,<svg%20version='1.1'%20xmlns='http://www.w3.org/2000/svg'><filter%20id='blur'><feGaussianBlur%20stdDeviation='10'%20/></filter></svg>#blur");-webkit-filter:blur(10px);-ms-filter:blur(10px);-o-filter:blur(10px);filter:blur(10px)}</style><script type="text/javascript" async="" src="./OpenCV Face Recognition - PyImageSearch_files/in.php"></script><script type="text/javascript" async="" src="./OpenCV Face Recognition - PyImageSearch_files/tagjs"></script><style type="text/css">
  /* === Form-Specific Styles === */
  /* stylelint-disable */

  #drip-129969 .drip-content,
  #drip-129969 .drip-header {
    background: rgb(223,75,75) !important;
    background: rgba(223,75,75,0.90) !important;
  }

  #drip-129969 .drip-content h3 {
    color: #e56f6f !important;
    font-size: 23px !important;
  }

  #drip-129969 .drip-submit-button {
    background-color: #e56f6f !important;
    font-size: 13px !important;
  }

  #drip-129969 .drip-submit-button:hover {
    background-color: #e25d5d !important;
  }

  #drip-129969 .drip-submit-button:active {
    background-color: #c94444 !important;
  }

  #drip-129969 dl dt,
  #drip-129969 .drip-content .drip-description,
  #drip-129969 .drip-content .classic--checkbox,
  #drip-129969 .drip-errors {
    font-size: 14px !important;
  }

  #drip-129969 .drip-text-field {
    font-size: 15px !important;
  }

  /* === Reset styles === */

  .drip-tab h1,
  .drip-tab h2,
  .drip-tab h3,
  .drip-tab div,
  .drip-tab dl,
  .drip-tab dt,
  .drip-tab dd,
  .drip-tab p,
  .drip-tab a,
  .drip-tab .drip-text-field,
  .drip-tab .drip-text-field:focus,
  .drip-tab .drip-submit-button {
    margin: 0;
    padding: 0;
    border: 0;
    font-size: 100%;
    font: inherit;
    vertical-align: baseline;
    float: none;
    width: auto;
    background-image: none;
    letter-spacing: 0;
    -webkit-box-shadow: none;
       -moz-box-shadow: none;
            box-shadow: none;
    -webkit-text-shadow: none !important;
       -moz-text-shadow: none !important;
            text-shadow: none !important;
  }

  .drip-tab a {
    text-decoration: none;
  }

  .drip-tab :focus {
    outline: 0;
  }

  /* === Clearfix === */

  .drip-clearfix:after {
    visibility: hidden;
    display: block;
    font-size: 0;
    content: " ";
    clear: both;
    height: 0;
  }
  * html .drip-clearfix             { zoom: 1; } /* IE6 */
  *:first-child+html .drip-clearfix { zoom: 1; } /* IE7 */

  /* === Main Container === */

  .drip-tab-container * {
    box-sizing: content-box;
  }

  /* === Content === */

  .drip-tab .drip-content {
    margin: 0;
    padding: 5px;
    width: 330px;
    position: fixed;
    font-size: 100%;
    font: inherit;
    z-index: 10000;
    color: #333;
    vertical-align: baseline;
    text-align: left;
    box-sizing: border-box;
    -webkit-box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
       -moz-box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
            box-shadow: 0px 0px 20px rgba(0,0,0,0.25);
  }

  .drip-tab.bottom .drip-content {
    bottom: -800px;
    -webkit-border-radius: 8px 8px 0 0;
       -moz-border-radius: 8px 8px 0 0;
            border-radius: 8px 8px 0 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.bottom.left .drip-content {
    left: 40px;
  }

  .drip-tab.bottom.right .drip-content {
    right: 40px;
  }

  .drip-tab.image-left .drip-content,
  .drip-tab.image-right .drip-content {
    width: 510px;
  }

  .drip-tab.side .drip-content {
    top: 10%;
  }

  .drip-tab.side.right .drip-content {
    right: -550px;
    -webkit-border-radius: 8px 0 0 8px;
       -moz-border-radius: 8px 0 0 8px;
            border-radius: 8px 0 0 8px;
    -webkit-transition: right 200ms ease-in;
       -moz-transition: right 200ms ease-in;
         -o-transition: right 200ms ease-in;
            transition: right 200ms ease-in;
  }

  .drip-tab.side.left .drip-content {
    left: -550px;
    -webkit-border-radius: 0 8px 8px 0;
       -moz-border-radius: 0 8px 8px 0;
            border-radius: 0 8px 8px 0;
    -webkit-transition: left 200ms ease-in;
       -moz-transition: left 200ms ease-in;
         -o-transition: left 200ms ease-in;
            transition: left 200ms ease-in;
  }

  .drip-tab.mobile .drip-content {
    width: 100% !important;
    bottom: -800px;
    left: 0;
    -webkit-border-radius: 0;
       -moz-border-radius: 0;
            border-radius: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.drip-scrollable .drip-content {
    overflow-y: scroll;
  }

  /* === Header === */

  .drip-tab .drip-header {
    margin: 0;
    padding: 0;
    position: fixed;
    font-size: 100%;
    font: inherit;
    z-index: 10000;
    color: #333;
    vertical-align: baseline;
    text-align: left;
    -webkit-border-radius: 8px 8px 0 0;
       -moz-border-radius: 8px 8px 0 0;
            border-radius: 8px 8px 0 0;
    -webkit-box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
       -moz-box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
            box-shadow: 0px 10px 28px rgba(0,0,0,0.36);
  }

  .drip-tab.bottom .drip-header {
    width: 330px;
    bottom: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.bottom .drip-header.drip-hidden {
    bottom: -800px;
  }

  .drip-tab.bottom.left .drip-header {
    left: 40px;
  }

  .drip-tab.bottom.right .drip-header {
    right: 40px;
  }

  .drip-tab.bottom.image-left .drip-header,
  .drip-tab.bottom.image-right .drip-header {
    width: 510px;
  }

  .drip-tab.side .drip-header {
    width: 330px;
    top: 10%;
  }

  .drip-tab.side.right .drip-header {
    right: -100px;
    -webkit-transition: right 400ms ease-in;
       -moz-transition: right 400ms ease-in;
         -o-transition: right 400ms ease-in;
            transition: right 400ms ease-in;
    -webkit-transform: rotate(-90deg) !important;
       -moz-transform: rotate(-90deg) !important;
        -ms-transform: rotate(-90deg) !important;
         -o-transform: rotate(-90deg) !important;
            transform: rotate(-90deg) !important;
    -webkit-transform-origin: right center;
       -moz-transform-origin: right center;
         -o-transform-origin: right center;
            transform-origin: right center;
  }

  .drip-tab.side.right .drip-header.drip-hidden {
    right: -100px;
  }

  .drip-tab.side.left .drip-header {
    left: -100px;
    -webkit-transition: left 400ms ease-in;
       -moz-transition: left 400ms ease-in;
         -o-transition: left 400ms ease-in;
            transition: left 400ms ease-in;
    -webkit-transform: rotate(90deg) !important;
       -moz-transform: rotate(90deg) !important;
        -ms-transform: rotate(90deg) !important;
         -o-transform: rotate(90deg) !important;
            transform: rotate(90deg) !important;
    -webkit-transform-origin: left center;
       -moz-transform-origin: left center;
         -o-transform-origin: left center;
            transform-origin: left center;
  }

  .drip-tab.side.left .drip-header.drip-hidden {
    left: -100px;
  }

  .drip-tab.mobile .drip-header {
    width: 100% !important;
    bottom: 0;
    left: 0;
    -webkit-border-radius: 0;
       -moz-border-radius: 0;
            border-radius: 0;
    -webkit-transition: bottom 200ms ease-in;
       -moz-transition: bottom 200ms ease-in;
         -o-transition: bottom 200ms ease-in;
            transition: bottom 200ms ease-in;
  }

  .drip-tab.mobile .drip-header.drip-hidden {
    bottom: -300px;
  }

  /* === Header Toggle === */

  .drip-tab .drip-toggle {
    display: block;
    text-decoration: none;
    padding: 10px 50px 10px 20px; /* extra padding for the arrow */
  }

  /* === Teaser === */

  .drip-tab .drip-header h2 {
    display: block;
    margin: 0 !important;
    padding: 0 !important;
    border: 0 !important;
    font-size: 14px !important;
    line-height: 1.5 !important;
    font-weight: bold !important;
    text-align: left !important;
    color: #fff !important;
    clear: none !important;
    letter-spacing: 0 !important;
    width: auto !important;
  }

  /* === Arrows === */

  .drip-tab .drip-header span.drip-arrow {
    display: block;
    position: absolute;
    margin: 0;
    padding: 0;
    width: 0;
    height: 0;
    line-height: 0;
    top: 17px;
    right: 32px;
  }

  /* === Panel === */

  .drip-tab .drip-content > div.drip-panel {
    padding: 15px 15px 12px;
    background-color: #fff;
    -webkit-border-radius: 6px;
       -moz-border-radius: 6px;
            border-radius: 6px;
  }

  /* === Powered By === */

  .drip-tab .drip-powered-by {
    padding: 8px;
    margin-bottom: -5px;
    font-family: Helvetica, Arial, sans-serif;
    text-align: left;
    font-weight: bold;
    font-size: 10px;
    line-height: 16px;
    color: #ffffff;
    letter-spacing: 1px;
    text-align: center;
    text-transform: uppercase;
    display: -webkit-box;
    display: -ms-flexbox;
    display: -webkit-flex;
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .drip-tab .drip-powered-by a {
    color: #ffffff !important;
    text-decoration: underline !important;
    letter-spacing: 1px;
    margin-left: 6px;
  }

  /* === Content Headings & Paragraphs === */

  .drip-tab .drip-content h3 {
    display: block;
    margin: 0 20px 0 0 !important;
    padding: 0 0 15px 0 !important;
    line-height: 1.4 !important;
    font-weight: bold !important;
    text-align: left !important;
    color: #4477bd !important;
    clear: none !important;
  }

  .drip-tab .drip-content .drip-description {
    margin: 0;
    padding: 0 0 20px 0;
    line-height: 1.6;
    text-align: left;
  }

  .drip-tab.image-left .drip-content .drip-description {
    margin-left: 170px;
  }

  .drip-tab.image-right .drip-content .drip-description {
    margin-right: 170px;
  }

  @media screen and (max-width: 510px) {
    .drip-tab.image-left .drip-content .drip-description {
      margin-left: 0; /* 120px; */
    }

    .drip-tab.image-right .drip-content .drip-description {
      margin-right: 0; /* 120px; */
    }
  }

  .drip-tab .drip-content .drip-description a {
    text-decoration: underline;
  }

  .drip-tab .drip-content .drip-description em {
    font-style: italic;
  }

  .drip-tab .drip-content .drip-description ul,
  .drip-tab .drip-content .drip-description ol {
    list-style-position: outside;
    margin: 8px 0 8px 30px;
  }

  .drip-tab .drip-content .drip-description ul li
  .drip-tab .drip-content .drip-description ol li {
    padding: 0;
  }

  .drip-tab .drip-content img.drip-image {
    margin-bottom: 20px;
  }

  .drip-tab.image-left .drip-content img.drip-image {
    float: left;
    width: 150px;
  }

  .drip-tab.image-right .drip-content img.drip-image {
    float: right;
    width: 150px;
  }

  @media screen and (max-width: 510px) {
    .drip-tab.image-left .drip-content img.drip-image {
      margin-right: 20px;
      width: 100px;
    }

    .drip-tab.image-right .drip-content img.drip-image {
      margin-left: 20px;
      width: 100px;
    }
  }

  .drip-tab .drip-content a.drip-close {
    font-family: Arial, Helvetica, sans-serif;
    margin: -1px 0 0 0;
    float: right;
    font-size: 28px;
    line-height: 15px;
    font-weight: normal;
    color: #333;
    opacity: 0.4;
  }

  .drip-tab .drip-content a.drip-close:hover {
    text-decoration: none;
    cursor: pointer;
    opacity: 0.6;
  }

  /* === Content Subscribe Form === */

  .drip-tab form {
    margin: 0 !important;
    padding: 0 !important;
  }

  .drip-tab dl {
    display: block;
    margin: 0;
    padding: 0;
  }

  .drip-tab dl dt {
    display: block;
    padding: 0 0 5px 0;
    font-weight: bold;
  }

  .drip-tab dl.no-labels dt {
    display: none;
  }

  .drip-tab dl dd {
    display: block;
    padding: 0 0 10px 0;
  }

  .drip-tab .drip-text-field {
    margin: 0 !important;
    padding: 6px !important;
    height: auto !important;
    width: 100% !important;
    color: #333 !important;
    background-color: #fff !important;
    border: 1px solid #c4c4c4 !important;
    -webkit-box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
       -moz-box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
            box-shadow: inset 0 0 3px rgba(0,0,0,0.18) !important;
    -webkit-border-radius: 4px !important;
       -moz-border-radius: 4px !important;
            border-radius: 4px !important;
    -webkit-box-sizing: border-box !important;
       -moz-box-sizing: border-box !important;
        -ms-box-sizing: border-box !important;
            box-sizing: border-box !important;
    background-image: none !important;
    min-width: 0 !important;
    min-height: 0 !important;
  }

  .drip-tab .drip-text-field::-webkit-input-placeholder { /* WebKit browsers */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field:-moz-placeholder { /* Mozilla Firefox 4 to 18 */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field::-moz-placeholder { /* Mozilla Firefox 19+ */
    color: #999999 !important;
  }
  .drip-tab .drip-text-field:-ms-input-placeholder { /* Internet Explorer 10+ */
    color: #999999 !important;
  }

  .drip-tab .drip-text-field:focus {
    border-color: #a4a4a4 !important;
    outline: 0;
    background-image: none;
    background-color: #fff !important;
  }

  .drip-tab.mobile .drip-text-field {
    font-size: 16px;
  }

  .drip-tab .drip-errors {
    padding: 5px 0 0 0;
    font-weight: normal;
    color: red;
  }

  .drip-tab .drip-submit-button {
    font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif !important;
    padding: 3px 12px !important;
    color: #ffffff !important;
    font-weight: bold !important;
    line-height: 1.6 !important;
    border: 0 !important;
    -webkit-border-radius: 15px !important;
       -moz-border-radius: 15px !important;
            border-radius: 15px !important;
    cursor: pointer !important;
    background-image: none !important;
    min-width: 0 !important;
    min-height: 0 !important;
    height: auto;
  }

  .drip-tab .drip-submit-button:hover {
    background-image: none !important;
  }

  .drip-tab .drip-submit-button:active {
    background-image: none !important;
  }

  /* checkbox */
  .drip-tab .classic--checkbox.hidden {
    margin-bottom: -8px;
    display: none;
  }

  .drip-tab .classic--checkbox input[type="checkbox"] {
    display: inline-block;
    width: auto;
  }

  /* stylelint-enable */

</style><img src="./OpenCV Face Recognition - PyImageSearch_files/saved_resource" width="1" height="1" border="0"><img src="./OpenCV Face Recognition - PyImageSearch_files/saved_resource(1)" width="1" height="1" border="0"><img src="./OpenCV Face Recognition - PyImageSearch_files/saved_resource(2)" width="1" height="1" border="0"><img src="./OpenCV Face Recognition - PyImageSearch_files/saved_resource(3)" width="1" height="1" border="0"><img src="./OpenCV Face Recognition - PyImageSearch_files/tr" width="1" height="1" border="0"><img src="./OpenCV Face Recognition - PyImageSearch_files/seg" width="1" height="1" border="0"><img src="./OpenCV Face Recognition - PyImageSearch_files/tr(1)" width="1" height="1" border="0"><img src="./OpenCV Face Recognition - PyImageSearch_files/seg(1)" width="1" height="1" border="0"><img src="./OpenCV Face Recognition - PyImageSearch_files/tr(2)" width="1" height="1" border="0"><img src="./OpenCV Face Recognition - PyImageSearch_files/seg(2)" width="1" height="1" border="0"><script type="text/javascript" async="" src="./OpenCV Face Recognition - PyImageSearch_files/in(1).php"></script><script type="text/javascript" async="" src="./OpenCV Face Recognition - PyImageSearch_files/in(2).php"></script><script type="text/javascript" async="" src="./OpenCV Face Recognition - PyImageSearch_files/in(3).php"></script><script type="text/javascript" async="" src="./OpenCV Face Recognition - PyImageSearch_files/in(4).php"></script></head>
<body class="post-template-default single single-post postid-8691 single-format-standard chrome alt-style-default two-col-left width-960 two-col-left-960 full-width full-header full-footer">
<div id="wrapper">

	<div id="inner-wrapper">

	    <!--#header-container-->
    <div id="header-container">
<h3 class="nav-toggle icon"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#navigation">Navigation</a></h3>

	<header id="header" class="col-full">

		<div id="logo">
<a href="https://www.pyimagesearch.com/" title="Be awesome at OpenCV, Python, deep learning, and computer vision"><img src="./OpenCV Face Recognition - PyImageSearch_files/logo.png" alt="PyImageSearch"></a>
<span class="site-title"><a href="https://www.pyimagesearch.com/">PyImageSearch</a></span>
<span class="site-description">Be awesome at OpenCV, Python, deep learning, and computer vision</span>
</div>

	</header>

	    </div><!--/#header-container-->
    <!--#nav-container-->
    <div id="nav-container">
<nav id="navigation" class="col-full" role="navigation">

	<section class="menus">

		<a href="https://www.pyimagesearch.com/" class="nav-home"><span>Home</span></a>

	<h3>Main Menu</h3><ul id="main-nav" class="nav fl"><li id="menu-item-4519" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-4519"><a href="https://www.pyimagesearch.com/start-here-learn-computer-vision-opencv/">Start Here</a></li>
<li id="menu-item-2616" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2616"><a href="https://www.pyimagesearch.com/practical-python-opencv/">Practical Python and OpenCV</a></li>
<li id="menu-item-2617" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2617"><a href="https://www.pyimagesearch.com/pyimagesearch-gurus/">PyImageSearch Gurus</a></li>
<li id="menu-item-2615" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2615"><a href="https://www.pyimagesearch.com/opencv-tutorials-resources-guides/">OpenCV 3 Tutorials</a></li>
<li id="menu-item-2618" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2618"><a href="https://www.pyimagesearch.com/free-opencv-crash-course/">FREE OpenCV Course</a></li>
<li id="menu-item-2619" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-2619"><a href="https://www.pyimagesearch.com/about/">About</a></li>
<li id="menu-item-6744" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-6744"><a href="https://www.pyimagesearch.com/contact/">Contact</a></li>
</ul>
	</section><!-- /.menus -->

	<a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#top" class="nav-close"><span>Return to Content</span></a>

</nav>
    </div><!--/#nav-container-->
       
    <!-- #content Starts -->
	    <div id="content" class="col-full">
    
    	<div id="main-sidebar-container">    

            <!-- #main Starts -->
                        <section id="main">                       
<article class="post-8691 post type-post status-publish format-standard hentry category-deep-learning-2 category-faces category-tutorials tag-deep-learning tag-face-detection tag-face-recognition tag-facenet tag-machine-learning tag-neural-nets">
	<header>
	<h1 class="title">OpenCV Face Recognition</h1>	</header>
<div class="post-meta"><span class="small">By</span> <span class="author vcard"><span class="fn"><a href="https://www.pyimagesearch.com/author/adrian/" title="Posts by Adrian Rosebrock" rel="author">Adrian Rosebrock</a></span></span> <span class="small">on</span> <abbr class="date time published" title="2018-09-24T10:00:11-0400">September 24, 2018</abbr>  <span class="small">in</span> <span class="categories"><a href="https://www.pyimagesearch.com/category/deep-learning-2/" title="View all items in Deep Learning">Deep Learning</a>, <a href="https://www.pyimagesearch.com/category/faces/" title="View all items in Faces">Faces</a>, <a href="https://www.pyimagesearch.com/category/tutorials/" title="View all items in Tutorials">Tutorials</a></span>  </div>
	<section class="entry">
<div id="fsb-social-bar" class="fsb-social-bar fsb-fixed" data-post-id="8691" data-socialite="true" style="width: 623px;"><style type="text/css">            #fsb-social-bar { width: 100%; border-bottom: 1px solid #dbdbdb; border-top: 1px solid #dbdbdb; padding: 10px 0; margin: 0px 0 20px 0; float: left; background: #fff; position: relative; clear: both; }            #fsb-social-bar a { border: 0px !important }            #fsb-social-bar.fsb-fixed { position: fixed; top: -2px; z-index: 99999; }            #fsb-social-bar .fsb-title { display: block; float: left; margin: 3px 20px 0 0; font-size: 16px; font-family: Arial, Helvetica, sans-serif; text-decoration: none; color: #333; }            #fsb-social-bar .fsb-share-facebook { width: 120px; float: left; padding: 3px 0 2px; height: 25px; }            #fsb-social-bar .fsb-share-facebook.fsb-hide-count { width: 44px; overflow: hidden; margin-right: 30px; }            #fsb-social-bar .fsb-share-twitter { float: left; width: 135px; padding: 3px 0 2px; height: 25px; }            #fsb-social-bar .fsb-share-twitter.fsb-hide-count { width: 61px; overflow: hidden; margin-right: 30px; }            #fsb-social-bar .fsb-share-google { float: left; width: 105px; padding: 3px 0 2px; height: 25px; }            #fsb-social-bar .fsb-share-google.fsb-hide-count { width: 33px; overflow: hidden; margin-right: 30px; }            #fsb-social-bar .fsb-share-linkedin { float: left; width: 135px; padding: 3px 0 2px; height: 25px; }            #fsb-social-bar .fsb-share-linkedin.fsb-hide-count { width: 61px; overflow: hidden; margin-right: 30px; }            #fsb-social-bar .fsb-share-pinterest { float: left; width: 115px; padding: 3px 0 2px; height: 25px;}            #fsb-social-bar .fsb-share-pinterest.fsb-hide-count { width: 43px; overflow: hidden; margin-right: 30px; }            #fsb-social-bar .socialite { display: block; position: relative; background: url(https://www.pyimagesearch.com/wp-content/plugins/floating-social-bar/images/fsb-sprite.png) no-repeat scroll 0 0; }            #fsb-social-bar .socialite-loaded { background: none !important; }            #fsb-social-bar .fsb-service-title { display: none; }            #fsb-social-bar a { color: #333; text-decoration: none; font-size: 12px; font-family: Arial, Helvetica, sans-serif; }            #fsb-social-bar .fsb-twitter { width: 105px; height: 25px; background-position: -13px -10px; line-height: 25px; vertical-align: middle; }            #fsb-social-bar .fsb-twitter .fsb-count { width: 30px; text-align: center; display: inline-block; margin: 0px 0 0 69px; color: #333; }            #fsb-social-bar .fsb-google { width: 75px; height: 25px; background-position: -136px -10px; line-height: 25px; vertical-align: middle; }            #fsb-social-bar .fsb-google .fsb-count { width: 30px; text-align: center; display: inline-block; margin: 0px 0 0 41px; color: #333; }            #fsb-social-bar .fsb-google .socialite-button { margin: 0 !important; }            #fsb-social-bar .fsb-share-google .socialite-loaded .socialite-button{padding: 2px 0 0}            #fsb-social-bar .fsb-facebook { width: 89px; height: 25px; background-position: -231px -10px; line-height: 25px; vertical-align: middle; }            #fsb-social-bar .fsb-facebook .fsb-count { width: 30px; text-align: center; display: inline-block; margin: 0px 0 0 52px; color: #333; }            #fsb-social-bar .fsb-facebook .socialite-button { margin: 0 !important;}            #fsb-social-bar .fsb-share-facebook .socialite-loaded .socialite-button {padding: 2px 0 0}            #fsb-social-bar .fsb-linkedin { width: 105px; height: 25px; background-position: -347px -10px; line-height: 25px; vertical-align: middle; }            #fsb-social-bar .fsb-linkedin .fsb-count { width: 30px; text-align: center; display: inline-block; margin: 0px 0 0 70px; color: #333; }            #fsb-social-bar .fsb-linkedin .socialite-button { margin: 0 !important; }            #fsb-social-bar .fsb-pinterest { width: 88px; height: 25px; background-position: -484px -10px; line-height: 25px; vertical-align: middle; }            #fsb-social-bar .fsb-pinterest .fsb-count { width: 30px; text-align: center; display: inline-block; margin: 0px 0 0 50px; color: #333; }            #fsb-social-bar .fsb-pinterest .socialite-button { margin: 0 !important; }            .fsb-clear { clear: both; }            .fsb-clear:after { clear:both; content:; display:block; height:0; line-height:0; overflow:auto; visibility:hidden; zoom:1; }            @media (max-width: 768px) { #fsb-social-bar.fsb-fixed { position: relative !important; top: auto !important; } }        </style>
            <a href="https://app.monstercampaigns.com/c/hb8kx28jznwl5ea0fogc/" class="manual-optin-trigger" data-optin-slug="hb8kx28jznwl5ea0fogc" style="display: block;">
                <div style="font-size: 14pt; color: #21212A;">
                    <img src="./OpenCV Face Recognition - PyImageSearch_files/python_icon.png" alt="" style="margin-right: 10px; width: 40px; height: 40px; float: left; border: none;">
                    <div style="padding-top: 10px;">
                        <span style="font-weight: bold; color: #DF4B4B; text-decoration: underline;">Click here to download the source code to this post.</span>
                    </div>
                </div>
            </a>
        </div><div class="fsb-clear"></div><p><img class="aligncenter" src="./OpenCV Face Recognition - PyImageSearch_files/opencv_face_reco_animation.gif" alt="" width="500"></p>
<p><strong>In this tutorial, you will learn how to use OpenCV to perform face recognition.</strong> To build our face recognition system, we’ll first perform face detection, extract face embeddings from each face using deep learning, train a face recognition model on the embeddings, and then finally <strong>recognize faces in both images and video streams with OpenCV.</strong></p>
<p>Today’s tutorial is also a special gift for my fiancée, Trisha (who is now officially my wife). Our wedding was over the weekend, and by the time you’re reading this blog post, we’ll be at the airport preparing to board our flight for the honeymoon.</p>
<p>To celebrate the occasion, and show her how much her support of myself, the PyImageSearch blog, and the PyImageSearch community means to me, I decided to use OpenCV to perform face recognition on a dataset of our faces.</p>
<p><strong>You can swap in your own dataset of faces of course!</strong> All you need to do is follow my directory structure in insert your own face images.</p>
<p>As a bonus, I’ve also included how to label “unknown” faces that cannot be classified with sufficient confidence.</p>
<p><strong>To learn how to perform OpenCV face recognition, <em>just keep reading!</em></strong></p>
<div style="padding-top: 10px; padding-bottom: 15px; padding-right: 10px; height: 70px; background: url(&#39;https://www.pyimagesearch.com/wp-content/uploads/2014/02/download-code-icon.png&#39;); background-size: 70px 70px; background-repeat: no-repeat;">
<p style="margin-top: 1px; margin-left: 80px; font-weight: bold;">Looking for the source code to this post?<br>
<a id="scroll_to_code" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#">Jump right to the downloads section.</a></p>
</div>
<h2>OpenCV Face Recognition</h2>
<p>In today’s tutorial, you will learn how to perform face recognition using the OpenCV library.</p>
<p>You might be wondering how this tutorial is different from the one I wrote a few months back on <a href="https://www.pyimagesearch.com/2018/06/18/face-recognition-with-opencv-python-and-deep-learning/" target="_blank" rel="noopener">face recognition with dlib</a>?</p>
<p>Well, keep in mind that the dlib face recognition post relied on two important external libraries:</p>
<ol>
<li><a href="http://dlib.net/" target="_blank" rel="noopener">dlib</a> (obviously)</li>
<li><a href="https://github.com/ageitgey/face_recognition" target="_blank" rel="noopener">face_recognition</a> (which is an easy to use set of face recognition utilities that wraps around dlib)</li>
</ol>
<p>While we used OpenCV to <em>facilitate</em> face recognition, OpenCV <em>itself</em> was not responsible for identifying faces.</p>
<p>In today’s tutorial, we’ll learn how we can apply deep learning and OpenCV together (with no other libraries other than scikit-learn) to:</p>
<ol>
<li>Detect faces</li>
<li>Compute 128-d face embeddings to quantify a face</li>
<li>Train a Support Vector Machine (SVM) on top of the embeddings</li>
<li>Recognize faces in images and video streams</li>
</ol>
<p>All of these tasks will be accomplished with OpenCV, enabling us to obtain a “pure” OpenCV face recognition pipeline.</p>
<h3>How OpenCV’s face recognition works</h3>
<div id="attachment_8742" style="max-width: 610px" class="wp-caption aligncenter"><a href="./OpenCV Face Recognition - PyImageSearch_files/opencv_face_reco_facenet.jpg"><img class="wp-image-8742" src="./OpenCV Face Recognition - PyImageSearch_files/opencv_face_reco_facenet.jpg" alt="" width="600" height="390" srcset="https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_facenet.jpg 800w, https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_facenet-300x195.jpg 300w, https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_facenet-768x499.jpg 768w" sizes="(max-width: 600px) 100vw, 600px"></a><p class="wp-caption-text"><strong>Figure 1:</strong> An overview of the OpenCV face recognition pipeline. The key step is a CNN feature extractor that generates 128-d facial embeddings. (<a href="https://cmusatyalab.github.io/openface/" target="_blank" rel="noopener">source</a>)</p></div>
<p>In order to build our OpenCV face recognition pipeline, we’ll be applying deep learning in two key steps:</p>
<ol>
<li>To apply <em>face detection</em>, which detects the <em>presence</em> and location of a face in an image, but does not identify it</li>
<li>To extract the 128-d feature vectors (called “embeddings”) that <em>quantify</em> each face in an image</li>
</ol>
<p>I’ve discussed <a href="https://www.pyimagesearch.com/2018/02/26/face-detection-with-opencv-and-deep-learning/" target="_blank" rel="noopener">how OpenCV’s face detection works</a> previously, so please refer to it if you have not detected faces before.</p>
<p>The model responsible for actually quantifying each face in an image is from the <a href="https://cmusatyalab.github.io/openface/" target="_blank" rel="noopener">OpenFace project</a>, a Python and Torch implementation of face recognition with deep learning. This implementation comes from Schroff et al.’s 2015 CVPR publication, <a href="https://www.cv-foundation.org/openaccess/content_cvpr_2015/app/1A_089.pdf" target="_blank" rel="noopener"><em>FaceNet: A&nbsp;</em><em>Unified Embedding for Face Recognition and Clustering</em></a>.</p>
<p>Reviewing the entire FaceNet implementation is outside the scope of this tutorial, but the gist of the pipeline can be seen in <strong>Figure 1</strong> above.</p>
<p>First, we input an image or video frame to our face recognition pipeline. Given the input image, we apply face detection to detect the location of a face in the image.</p>
<p>Optionally we can compute <a href="https://www.pyimagesearch.com/2017/04/03/facial-landmarks-dlib-opencv-python/" target="_blank" rel="noopener">facial landmarks</a>, enabling us to <a href="https://www.pyimagesearch.com/2017/05/22/face-alignment-with-opencv-and-python/" target="_blank" rel="noopener">preprocess and align the face</a>.</p>
<p>Face alignment, as the name suggests, is the process of (1) identifying the geometric structure of the faces and (2) attempting to obtain a canonical alignment of the face based on translation, rotation, and scale.</p>
<p>While optional, face alignment has been demonstrated to increase face recognition accuracy in some pipelines.</p>
<p>After we’ve (optionally) applied face alignment and cropping, we pass the input face through our deep neural network:</p>
<div id="attachment_8743" style="max-width: 610px" class="wp-caption aligncenter"><a href="./OpenCV Face Recognition - PyImageSearch_files/opencv_face_reco_training.png"><img class="size-full wp-image-8743" src="./OpenCV Face Recognition - PyImageSearch_files/opencv_face_reco_training.png" alt="" width="600" height="250" srcset="https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_training.png 600w, https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_training-300x125.png 300w" sizes="(max-width: 600px) 100vw, 600px"></a><p class="wp-caption-text"><strong>Figure 2:</strong> How the deep learning face recognition model computes the face embedding.</p></div>
<p>The FaceNet deep learning model computes a 128-d embedding that quantifies the face itself.</p>
<p>But how does the network actually compute the face embedding?</p>
<p>The answer lies in the training process itself, including:</p>
<ol>
<li>The input data to the network</li>
<li>The triplet loss function</li>
</ol>
<p>To train a face recognition model with deep learning, each input batch of data includes three images:</p>
<ol>
<li>The <em>anchor</em></li>
<li>The <em>positive</em> image</li>
<li>The <em>negative</em> image</li>
</ol>
<p>The anchor is our current face and has identity <em>A</em>.</p>
<p>The second image is our positive image — this image also contains a face of person <em>A</em>.</p>
<p>The negative image, on the other hand, <em><strong>does not have the same identity</strong></em>, and could belong to person <em>B</em>, <em>C</em>, or even <em>Y</em>!</p>
<p>The point is that the anchor and positive image both belong to the same person/face while the negative image does not contain the same face.</p>
<p>The neural network computes the 128-d embeddings for each face and then tweaks the weights of the network (via the triplet loss function) such that:</p>
<ol>
<li>The 128-d embeddings of the anchor and positive image lie closer together</li>
<li>While at the same time, pushing the embeddings for the negative image father away</li>
</ol>
<p>In this manner, the network is able to learn to quantify faces and return highly robust and discriminating embeddings suitable for face recognition.</p>
<p><b>And furthermore, we can actually </b><em style="font-weight: bold;">reuse</em><b> the OpenFace model for our own applications without having to explicitly&nbsp;train it!</b></p>
<p>Even though the deep learning model we’re using today has (very likely) <em>never</em> seen the faces we’re about to pass through it, the model will still be able to compute embeddings for each face — ideally, these face embeddings will be sufficiently different such that we can train a “standard” machine learning classifier (SVM, SGD classifier, Random Forest, etc.) on top of the face embeddings, and therefore obtain our OpenCV face recognition pipeline.</p>
<p>If you are interested in learning more about the details surrounding triplet loss and how it can be used to train a face embedding model, be sure to refer to my <a href="https://www.pyimagesearch.com/2018/06/18/face-recognition-with-opencv-python-and-deep-learning/" target="_blank" rel="noopener">previous blog post</a>&nbsp;as well as the <a href="https://www.cv-foundation.org/openaccess/content_cvpr_2015/app/1A_089.pdf" target="_blank" rel="noopener">Schroff et al. publication</a>.</p>
<h3>Our face recognition dataset</h3>
<div id="attachment_8744" style="max-width: 610px" class="wp-caption aligncenter"><a href="./OpenCV Face Recognition - PyImageSearch_files/opencv_face_reco_dataset.png"><img class="size-full wp-image-8744" src="./OpenCV Face Recognition - PyImageSearch_files/opencv_face_reco_dataset.png" alt="" width="600" height="154" srcset="https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_dataset.png 600w, https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_dataset-300x77.png 300w" sizes="(max-width: 600px) 100vw, 600px"></a><p class="wp-caption-text"><strong>Figure 3:</strong> A small example face dataset for face recognition with OpenCV.</p></div>
<p>The dataset we are using today contains three people:</p>
<ul>
<li>Myself</li>
<li>Trisha (my wife)</li>
<li>“Unknown”, which is used to represent faces of people we do not know and wish to label as such (here I just sampled faces from the movie <em>Jurassic Park</em> which I used in a <a href="https://www.pyimagesearch.com/2018/06/18/face-recognition-with-opencv-python-and-deep-learning/" target="_blank" rel="noopener">previous post</a> — you may want to insert your own “unknown” dataset).</li>
</ul>
<p>As I mentioned in the introduction to today’s face recognition post, I was just married over the weekend, so this post is a “gift” to my new wife&nbsp;<img draggable="false" class="emoji" alt="😉" src="./OpenCV Face Recognition - PyImageSearch_files/1f609.svg">.</p>
<p>Each class contains a total of six images.</p>
<p>If you are <a href="https://www.pyimagesearch.com/2018/06/11/how-to-build-a-custom-face-recognition-dataset/" target="_blank" rel="noopener">building your own face recognition dataset</a>, ideally, I would suggest having 10-20 images per person you wish to recognize — be sure to refer to the <em>“Drawbacks, limitations, and how to obtain higher face recognition accuracy”</em> section of this blog post for more details.</p>
<h3>Project structure</h3>
<p>Once you’ve grabbed the zip from the&nbsp;<em><strong>“Downloads”</strong></em> section of this post, go ahead and unzip the archive and navigate into the directory.</p>
<p>From there, you may use the 
			<span id="crayon-5baa9fe999633460804428" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">tree</span></span></span>&nbsp; command to have the directory structure printed in your terminal:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe999641008518404" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">$ tree --dirsfirst
.
├── dataset
│&nbsp;&nbsp; ├── adrian [6 images]
│&nbsp;&nbsp; ├── trisha [6 images]
│&nbsp;&nbsp; └── unknown [6 images]
├── images
│&nbsp;&nbsp; ├── adrian.jpg
│&nbsp;&nbsp; ├── patrick_bateman.jpg
│&nbsp;&nbsp; └── trisha_adrian.jpg
├── face_detection_model
│&nbsp;&nbsp; ├── deploy.prototxt
│&nbsp;&nbsp; └── res10_300x300_ssd_iter_140000.caffemodel
├── output
│&nbsp;&nbsp; ├── embeddings.pickle
│&nbsp;&nbsp; ├── le.pickle
│&nbsp;&nbsp; └── recognizer.pickle
├── extract_embeddings.py
├── openface_nn4.small2.v1.t7
├── train_model.py
├── recognize.py
└── recognize_video.py

7 directories, 31 files</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe999641008518404-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999641008518404-2">2</div><div class="crayon-num" data-line="crayon-5baa9fe999641008518404-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999641008518404-4">4</div><div class="crayon-num" data-line="crayon-5baa9fe999641008518404-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999641008518404-6">6</div><div class="crayon-num" data-line="crayon-5baa9fe999641008518404-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999641008518404-8">8</div><div class="crayon-num" data-line="crayon-5baa9fe999641008518404-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999641008518404-10">10</div><div class="crayon-num" data-line="crayon-5baa9fe999641008518404-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999641008518404-12">12</div><div class="crayon-num" data-line="crayon-5baa9fe999641008518404-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999641008518404-14">14</div><div class="crayon-num" data-line="crayon-5baa9fe999641008518404-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999641008518404-16">16</div><div class="crayon-num" data-line="crayon-5baa9fe999641008518404-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999641008518404-18">18</div><div class="crayon-num" data-line="crayon-5baa9fe999641008518404-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999641008518404-20">20</div><div class="crayon-num" data-line="crayon-5baa9fe999641008518404-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999641008518404-22">22</div><div class="crayon-num" data-line="crayon-5baa9fe999641008518404-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999641008518404-24">24</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe999641008518404-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-v">tree</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-i">dirsfirst</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999641008518404-2"><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5baa9fe999641008518404-3">├──<span class="crayon-h"> </span><span class="crayon-i">dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999641008518404-4">│&nbsp;&nbsp;<span class="crayon-h"> </span>├──<span class="crayon-h"> </span><span class="crayon-i">adrian</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">6</span><span class="crayon-h"> </span><span class="crayon-v">images</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5baa9fe999641008518404-5">│&nbsp;&nbsp;<span class="crayon-h"> </span>├──<span class="crayon-h"> </span><span class="crayon-i">trisha</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">6</span><span class="crayon-h"> </span><span class="crayon-v">images</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999641008518404-6">│&nbsp;&nbsp;<span class="crayon-h"> </span>└──<span class="crayon-h"> </span><span class="crayon-i">unknown</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-cn">6</span><span class="crayon-h"> </span><span class="crayon-v">images</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5baa9fe999641008518404-7">├──<span class="crayon-h"> </span><span class="crayon-i">images</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999641008518404-8">│&nbsp;&nbsp;<span class="crayon-h"> </span>├──<span class="crayon-h"> </span><span class="crayon-v">adrian</span><span class="crayon-e">.jpg</span></div><div class="crayon-line" id="crayon-5baa9fe999641008518404-9">│&nbsp;&nbsp;<span class="crayon-h"> </span>├──<span class="crayon-h"> </span><span class="crayon-v">patrick_bateman</span><span class="crayon-e">.jpg</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999641008518404-10">│&nbsp;&nbsp;<span class="crayon-h"> </span>└──<span class="crayon-h"> </span><span class="crayon-v">trisha_adrian</span><span class="crayon-e">.jpg</span></div><div class="crayon-line" id="crayon-5baa9fe999641008518404-11">├──<span class="crayon-h"> </span><span class="crayon-v">face_detection</span><span class="crayon-sy">_</span>model</div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999641008518404-12">│&nbsp;&nbsp;<span class="crayon-h"> </span>├──<span class="crayon-h"> </span><span class="crayon-v">deploy</span><span class="crayon-e">.prototxt</span></div><div class="crayon-line" id="crayon-5baa9fe999641008518404-13">│&nbsp;&nbsp;<span class="crayon-h"> </span>└──<span class="crayon-h"> </span><span class="crayon-v">res10_300x300_ssd_iter_140000</span><span class="crayon-e">.caffemodel</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999641008518404-14">├──<span class="crayon-h"> </span><span class="crayon-i">output</span></div><div class="crayon-line" id="crayon-5baa9fe999641008518404-15">│&nbsp;&nbsp;<span class="crayon-h"> </span>├──<span class="crayon-h"> </span><span class="crayon-v">embeddings</span><span class="crayon-e">.pickle</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999641008518404-16">│&nbsp;&nbsp;<span class="crayon-h"> </span>├──<span class="crayon-h"> </span><span class="crayon-v">le</span><span class="crayon-e">.pickle</span></div><div class="crayon-line" id="crayon-5baa9fe999641008518404-17">│&nbsp;&nbsp;<span class="crayon-h"> </span>└──<span class="crayon-h"> </span><span class="crayon-v">recognizer</span><span class="crayon-e">.pickle</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999641008518404-18">├──<span class="crayon-h"> </span><span class="crayon-v">extract_embeddings</span><span class="crayon-e">.py</span></div><div class="crayon-line" id="crayon-5baa9fe999641008518404-19">├──<span class="crayon-h"> </span><span class="crayon-v">openface_nn4</span><span class="crayon-e">.small2</span><span class="crayon-e">.v1</span><span class="crayon-e">.t7</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999641008518404-20">├──<span class="crayon-h"> </span><span class="crayon-v">train_model</span><span class="crayon-e">.py</span></div><div class="crayon-line" id="crayon-5baa9fe999641008518404-21">├──<span class="crayon-h"> </span><span class="crayon-v">recognize</span><span class="crayon-e">.py</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999641008518404-22">└──<span class="crayon-h"> </span><span class="crayon-v">recognize_video</span><span class="crayon-e">.py</span></div><div class="crayon-line" id="crayon-5baa9fe999641008518404-23">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999641008518404-24"><span class="crayon-cn">7</span><span class="crayon-h"> </span><span class="crayon-v">directories</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">31</span><span class="crayon-h"> </span><span class="crayon-v">files</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0033 seconds] -->
<p>There are quite a few moving parts for this project — <strong>take the time now to carefully read this section so you become familiar with all the files in today’s project.</strong></p>
<p>Our project has four directories in the root folder:</p>
<ul>
<li>
			<span id="crayon-5baa9fe999648805414923" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">dataset</span><span class="crayon-o">/</span></span></span>&nbsp;: Contains our face images organized into subfolders by name.</li>
<li>
			<span id="crayon-5baa9fe99964d430249875" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">images</span><span class="crayon-o">/</span></span></span>&nbsp;: Contains three test images that we’ll use to verify the operation of our model.</li>
<li>
			<span id="crayon-5baa9fe999652395039927" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">face_detection_model</span><span class="crayon-o">/</span></span></span>&nbsp;: Contains a pre-trained Caffe deep learning model provided by OpenCV to <em>detect&nbsp;</em>faces. This model&nbsp;<em>detects</em> and&nbsp;<em>localizes</em> faces in an image.</li>
<li>
			<span id="crayon-5baa9fe999657482427631" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">output</span><span class="crayon-o">/</span></span></span>&nbsp;: Contains my output pickle files. If you’re working with your own dataset, you can store your output files here as well. The output files include:
<ul>
<li>
			<span id="crayon-5baa9fe99965b524538992" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">embeddings</span><span class="crayon-sy">.</span><span class="crayon-k ">pickle</span></span></span>&nbsp;: A serialized facial embeddings file. Embeddings have been computed for every face in the dataset and are stored in this file.</li>
<li>
			<span id="crayon-5baa9fe999660860933701" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">le</span><span class="crayon-sy">.</span><span class="crayon-k ">pickle</span></span></span>&nbsp;: Our label encoder. Contains the name labels for the people that our model can recognize.</li>
<li>
			<span id="crayon-5baa9fe999665029177174" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">recognizer</span><span class="crayon-e">.pickle</span></span></span>&nbsp;: Our Linear Support Vector Machine (SVM) model. This is a machine learning model rather than a deep learning model and it is responsible for actually <em>recognizing</em>&nbsp;faces.</li>
</ul>
</li>
</ul>
<p>Let’s summarize the five files in the root directory:</p>
<ul>
<li>
			<span id="crayon-5baa9fe99966a211361842" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">extract_embeddings</span><span class="crayon-e">.py</span></span></span>&nbsp;: We’ll review this file in&nbsp;<strong>Step #1</strong>&nbsp;which is responsible for using a deep learning feature extractor to generate a 128-D vector describing a face. All faces in our dataset will be passed through the neural network to generate embeddings.</li>
<li>
			<span id="crayon-5baa9fe99966e840828316" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">openface_nn4</span><span class="crayon-e">.small2</span><span class="crayon-e">.v1</span><span class="crayon-e">.t7</span></span></span>&nbsp;: A Torch deep learning model which produces the 128-D facial embeddings. We’ll be using this deep learning model in&nbsp;<strong>Steps #1, #2, and #3</strong> as well as the&nbsp;<strong>Bonus</strong> section.</li>
<li>
			<span id="crayon-5baa9fe999673787607238" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">train_model</span><span class="crayon-e">.py</span></span></span>&nbsp;: Our Linear SVM model will be trained by this script in&nbsp;<strong>Step #2</strong>. We’ll&nbsp;<em>detect</em> faces,&nbsp;<em>extract</em> embeddings, and&nbsp;<em>fit</em> our SVM model to the embeddings data.</li>
<li>
			<span id="crayon-5baa9fe999678383093634" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">recognize</span><span class="crayon-e">.py</span></span></span>&nbsp;: In&nbsp;<strong>Step #3</strong>&nbsp;and we’ll&nbsp;<em>recognize</em> faces in images. We’ll&nbsp;<em>detect</em> faces,&nbsp;<em>extract</em> embeddings, and&nbsp;<em>query</em>&nbsp;our SVM model to determine&nbsp;<em>who</em> is in an image. We’ll draw boxes around faces and annotate each box with a name.</li>
<li>
			<span id="crayon-5baa9fe99967c555999565" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">recognize_video</span><span class="crayon-e">.py</span></span></span>&nbsp;: Our&nbsp;<strong>Bonus</strong> section describes how to&nbsp;<em>recognize who</em> is in frames of a video stream just as we did in&nbsp;<strong>Step #3</strong><em>&nbsp;</em>on static images.</li>
</ul>
<p>Let’s move on to the first step!</p>
<h3>Step #1: Extract embeddings from face dataset</h3>
<p>Now that we understand how face recognition works and reviewed our project structure, let’s get started building our OpenCV face recognition pipeline.</p>
<p>Open up the 
			<span id="crayon-5baa9fe999681999295166" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">extract_embeddings</span><span class="crayon-e">.py</span></span></span>&nbsp; file and insert the following code:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe999686528566155" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># import the necessary packages
from imutils import paths
import numpy as np
import argparse
import imutils
import pickle
import cv2
import os

# construct the argument parser and parse the arguments
ap = argparse.ArgumentParser()
ap.add_argument("-i", "--dataset", required=True,
	help="path to input directory of faces + images")
ap.add_argument("-e", "--embeddings", required=True,
	help="path to output serialized db of facial embeddings")
ap.add_argument("-d", "--detector", required=True,
	help="path to OpenCV's deep learning face detector")
ap.add_argument("-m", "--embedding-model", required=True,
	help="path to OpenCV's deep learning face embedding model")
ap.add_argument("-c", "--confidence", type=float, default=0.5,
	help="minimum probability to filter weak detections")
args = vars(ap.parse_args())</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe999686528566155-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999686528566155-2">2</div><div class="crayon-num" data-line="crayon-5baa9fe999686528566155-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999686528566155-4">4</div><div class="crayon-num" data-line="crayon-5baa9fe999686528566155-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999686528566155-6">6</div><div class="crayon-num" data-line="crayon-5baa9fe999686528566155-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999686528566155-8">8</div><div class="crayon-num" data-line="crayon-5baa9fe999686528566155-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999686528566155-10">10</div><div class="crayon-num" data-line="crayon-5baa9fe999686528566155-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999686528566155-12">12</div><div class="crayon-num" data-line="crayon-5baa9fe999686528566155-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999686528566155-14">14</div><div class="crayon-num" data-line="crayon-5baa9fe999686528566155-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999686528566155-16">16</div><div class="crayon-num" data-line="crayon-5baa9fe999686528566155-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999686528566155-18">18</div><div class="crayon-num" data-line="crayon-5baa9fe999686528566155-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999686528566155-20">20</div><div class="crayon-num" data-line="crayon-5baa9fe999686528566155-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999686528566155-22">22</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe999686528566155-1"><span class="crayon-c"># import the necessary packages</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999686528566155-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-e">imutils </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">paths</span></div><div class="crayon-line" id="crayon-5baa9fe999686528566155-3"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">numpy </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">np</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999686528566155-4"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">argparse</span></div><div class="crayon-line" id="crayon-5baa9fe999686528566155-5"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">imutils</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999686528566155-6"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">pickle</span></div><div class="crayon-line" id="crayon-5baa9fe999686528566155-7"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">cv2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999686528566155-8"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">os</span></div><div class="crayon-line" id="crayon-5baa9fe999686528566155-9">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999686528566155-10"><span class="crayon-c"># construct the argument parser and parse the arguments</span></div><div class="crayon-line" id="crayon-5baa9fe999686528566155-11"><span class="crayon-v">ap</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">argparse</span><span class="crayon-sy">.</span><span class="crayon-e">ArgumentParser</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999686528566155-12"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-i"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--dataset"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5baa9fe999686528566155-13"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"path to input directory of faces + images"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999686528566155-14"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-e"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--embeddings"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5baa9fe999686528566155-15"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"path to output serialized db of facial embeddings"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999686528566155-16"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-d"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--detector"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5baa9fe999686528566155-17"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"path to OpenCV's deep learning face detector"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999686528566155-18"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-m"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--embedding-model"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5baa9fe999686528566155-19"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"path to OpenCV's deep learning face embedding model"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999686528566155-20"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-c"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--confidence"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">type</span><span class="crayon-o">=</span><span class="crayon-k ">float</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">default</span><span class="crayon-o">=</span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5baa9fe999686528566155-21"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"minimum probability to filter weak detections"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999686528566155-22"><span class="crayon-v">args</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">vars</span><span class="crayon-sy">(</span><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">parse_args</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0039 seconds] -->
<p>We import our required packages on&nbsp;<strong>Lines 2-8</strong>. You’ll need to have OpenCV and 
			<span id="crayon-5baa9fe99968b617174048" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">imutils</span></span></span>&nbsp; installed. To install OpenCV, <a href="https://www.pyimagesearch.com/opencv-tutorials-resources-guides/" target="_blank" rel="noopener">simply follow one of my guides</a> (I recommend OpenCV 3.4.2, so be sure to download the right version while you follow along). My <a href="https://github.com/jrosebr1/imutils" target="_blank" rel="noopener">imutils</a> package can be installed with pip:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe999690297185956" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">$ pip install --upgrade imutils</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe999690297185956-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe999690297185956-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">pip </span><span class="crayon-v">install</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-e">upgrade </span><span class="crayon-v">imutils</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0003 seconds] -->
<p>Next, we process our command line arguments:</p>
<ul>
<li>
			<span id="crayon-5baa9fe999695132137689" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-o">--</span><span class="crayon-v">dataset</span></span></span>&nbsp;: The path to our input dataset of face images.</li>
<li>
			<span id="crayon-5baa9fe999699257081002" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-o">--</span><span class="crayon-v">embeddings</span></span></span>&nbsp;: The path to our output embeddings file. Our script will compute face embeddings which we’ll serialize to disk.</li>
<li>
			<span id="crayon-5baa9fe99969e774799235" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-o">--</span><span class="crayon-v">detector</span></span></span>&nbsp;: Path to OpenCV’s Caffe-based deep learning face detector used to actually <em>localize</em> the faces in the images.</li>
<li>
			<span id="crayon-5baa9fe9996a2696361137" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-o">--</span><span class="crayon-v">embedding</span><span class="crayon-o">-</span><span class="crayon-v">model</span></span></span>&nbsp;: Path to the OpenCV deep learning Torch embedding model. This model will allow us to&nbsp;<em>extract</em> a 128-D facial embedding vector.</li>
<li>
			<span id="crayon-5baa9fe9996a7289970940" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-o">--</span><span class="crayon-v">confidence</span></span></span>&nbsp;: Optional threshold for filtering week face detections.</li>
</ul>
<p>Now that we’ve imported our packages and parsed command line arguments, lets load the face detector and embedder from disk:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe9996ac739553850" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># load our serialized face detector from disk
print("[INFO] loading face detector...")
protoPath = os.path.sep.join([args["detector"], "deploy.prototxt"])
modelPath = os.path.sep.join([args["detector"],
	"res10_300x300_ssd_iter_140000.caffemodel"])
detector = cv2.dnn.readNetFromCaffe(protoPath, modelPath)

# load our serialized face embedding model from disk
print("[INFO] loading face recognizer...")
embedder = cv2.dnn.readNetFromTorch(args["embedding_model"])</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe9996ac739553850-24">24</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9996ac739553850-25">25</div><div class="crayon-num" data-line="crayon-5baa9fe9996ac739553850-26">26</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9996ac739553850-27">27</div><div class="crayon-num" data-line="crayon-5baa9fe9996ac739553850-28">28</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9996ac739553850-29">29</div><div class="crayon-num" data-line="crayon-5baa9fe9996ac739553850-30">30</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9996ac739553850-31">31</div><div class="crayon-num" data-line="crayon-5baa9fe9996ac739553850-32">32</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9996ac739553850-33">33</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe9996ac739553850-24"><span class="crayon-c"># load our serialized face detector from disk</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9996ac739553850-25"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"[INFO] loading face detector..."</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9996ac739553850-26"><span class="crayon-v">protoPath</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">os.path</span><span class="crayon-sy">.</span><span class="crayon-v">sep</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"detector"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"deploy.prototxt"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9996ac739553850-27"><span class="crayon-v">modelPath</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">os.path</span><span class="crayon-sy">.</span><span class="crayon-v">sep</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"detector"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5baa9fe9996ac739553850-28"><span class="crayon-h">	</span><span class="crayon-s">"res10_300x300_ssd_iter_140000.caffemodel"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9996ac739553850-29"><span class="crayon-v">detector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">dnn</span><span class="crayon-sy">.</span><span class="crayon-e">readNetFromCaffe</span><span class="crayon-sy">(</span><span class="crayon-v">protoPath</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">modelPath</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9996ac739553850-30">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9996ac739553850-31"><span class="crayon-c"># load our serialized face embedding model from disk</span></div><div class="crayon-line" id="crayon-5baa9fe9996ac739553850-32"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"[INFO] loading face recognizer..."</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9996ac739553850-33"><span class="crayon-v">embedder</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">dnn</span><span class="crayon-sy">.</span><span class="crayon-e">readNetFromTorch</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"embedding_model"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0023 seconds] -->
<p>Here we load the face detector and embedder:</p>
<ul>
<li>
			<span id="crayon-5baa9fe9996b1871534524" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">detector</span></span></span>&nbsp;: Loaded via&nbsp;<strong>Lines 26-29</strong>. We’re using a Caffe based DL face detector to <em>localize</em> faces in an image.</li>
<li>
			<span id="crayon-5baa9fe9996b6347270214" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">embedder</span></span></span>&nbsp;: Loaded on&nbsp;<strong>Line 33</strong>. This model is Torch-based and is responsible for <em>extracting</em> facial embeddings via deep learning feature extraction.</li>
</ul>
<p>Notice that we’re using the respective 
			<span id="crayon-5baa9fe9996bb748218259" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">dnn</span></span></span>&nbsp; functions to load the two separate models. The 
			<span id="crayon-5baa9fe9996bf787173144" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">dnn</span></span></span>&nbsp; module wasn’t made available like this until <a href="https://www.pyimagesearch.com/2017/08/21/deep-learning-with-opencv/" target="_blank" rel="noopener">OpenCV 3.3</a>, but I recommend that you are <a href="https://www.pyimagesearch.com/opencv-tutorials-resources-guides/" target="_blank" rel="noopener">using OpenCV 3.4.2 or higher</a> for this blog post.</p>
<p>Moving forward, let’s grab our image paths and perform initializations:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe9996c4270875863" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># grab the paths to the input images in our dataset
print("[INFO] quantifying faces...")
imagePaths = list(paths.list_images(args["dataset"]))

# initialize our lists of extracted facial embeddings and
# corresponding people names
knownEmbeddings = []
knownNames = []

# initialize the total number of faces processed
total = 0</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe9996c4270875863-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9996c4270875863-36">36</div><div class="crayon-num" data-line="crayon-5baa9fe9996c4270875863-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9996c4270875863-38">38</div><div class="crayon-num" data-line="crayon-5baa9fe9996c4270875863-39">39</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9996c4270875863-40">40</div><div class="crayon-num" data-line="crayon-5baa9fe9996c4270875863-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9996c4270875863-42">42</div><div class="crayon-num" data-line="crayon-5baa9fe9996c4270875863-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9996c4270875863-44">44</div><div class="crayon-num" data-line="crayon-5baa9fe9996c4270875863-45">45</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe9996c4270875863-35"><span class="crayon-c"># grab the paths to the input images in our dataset</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9996c4270875863-36"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"[INFO] quantifying faces..."</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9996c4270875863-37"><span class="crayon-v">imagePaths</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">list</span><span class="crayon-sy">(</span><span class="crayon-v">paths</span><span class="crayon-sy">.</span><span class="crayon-e">list_images</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"dataset"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9996c4270875863-38">&nbsp;</div><div class="crayon-line" id="crayon-5baa9fe9996c4270875863-39"><span class="crayon-c"># initialize our lists of extracted facial embeddings and</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9996c4270875863-40"><span class="crayon-c"># corresponding people names</span></div><div class="crayon-line" id="crayon-5baa9fe9996c4270875863-41"><span class="crayon-v">knownEmbeddings</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9996c4270875863-42"><span class="crayon-v">knownNames</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5baa9fe9996c4270875863-43">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9996c4270875863-44"><span class="crayon-c"># initialize the total number of faces processed</span></div><div class="crayon-line" id="crayon-5baa9fe9996c4270875863-45"><span class="crayon-v">total</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-cn">0</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0020 seconds] -->
<p>The 
			<span id="crayon-5baa9fe9996c9148946846" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">imagePaths</span></span></span>&nbsp; list, built on&nbsp;<strong>Line 37</strong>, contains the path to each image in the dataset. I’ve made this easy via my 
			<span id="crayon-5baa9fe9996ce897991746" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">imutils</span></span></span>&nbsp; function, 
			<span id="crayon-5baa9fe9996d2569512926" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">paths</span><span class="crayon-sy">.</span><span class="crayon-v">list_images</span></span></span>&nbsp;.</p>
<p>Our embeddings and corresponding names will be held in two lists: 
			<span id="crayon-5baa9fe9996d7047948008" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">knownEmbeddings</span></span></span>&nbsp; and 
			<span id="crayon-5baa9fe9996dc375834637" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">knownNames</span></span></span>&nbsp; (<strong>Lines 41 and 42</strong>).</p>
<p>We’ll also be keeping track of how many faces we’ve processed via a variable called 
			<span id="crayon-5baa9fe9996e1257140138" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">total</span></span></span>&nbsp; (<strong>Line 45</strong>).</p>
<p>Let’s begin looping over the image paths — this loop will be responsible for extracting embeddings from faces found in each image:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe9996e5926427654" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># loop over the image paths
for (i, imagePath) in enumerate(imagePaths):
	# extract the person name from the image path
	print("[INFO] processing image {}/{}".format(i + 1,
		len(imagePaths)))
	name = imagePath.split(os.path.sep)[-2]

	# load the image, resize it to have a width of 600 pixels (while
	# maintaining the aspect ratio), and then grab the image
	# dimensions
	image = cv2.imread(imagePath)
	image = imutils.resize(image, width=600)
	(h, w) = image.shape[:2]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe9996e5926427654-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9996e5926427654-48">48</div><div class="crayon-num" data-line="crayon-5baa9fe9996e5926427654-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9996e5926427654-50">50</div><div class="crayon-num" data-line="crayon-5baa9fe9996e5926427654-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9996e5926427654-52">52</div><div class="crayon-num" data-line="crayon-5baa9fe9996e5926427654-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9996e5926427654-54">54</div><div class="crayon-num" data-line="crayon-5baa9fe9996e5926427654-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9996e5926427654-56">56</div><div class="crayon-num" data-line="crayon-5baa9fe9996e5926427654-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9996e5926427654-58">58</div><div class="crayon-num" data-line="crayon-5baa9fe9996e5926427654-59">59</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe9996e5926427654-47"><span class="crayon-c"># loop over the image paths</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9996e5926427654-48"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">imagePath</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">enumerate</span><span class="crayon-sy">(</span><span class="crayon-v">imagePaths</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5baa9fe9996e5926427654-49"><span class="crayon-h">	</span><span class="crayon-c"># extract the person name from the image path</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9996e5926427654-50"><span class="crayon-h">	</span><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"[INFO] processing image {}/{}"</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5baa9fe9996e5926427654-51"><span class="crayon-h">		</span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">imagePaths</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9996e5926427654-52"><span class="crayon-h">	</span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">imagePath</span><span class="crayon-sy">.</span><span class="crayon-e">split</span><span class="crayon-sy">(</span><span class="crayon-k ">os.path</span><span class="crayon-sy">.</span><span class="crayon-v">sep</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5baa9fe9996e5926427654-53">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9996e5926427654-54"><span class="crayon-h">	</span><span class="crayon-c"># load the image, resize it to have a width of 600 pixels (while</span></div><div class="crayon-line" id="crayon-5baa9fe9996e5926427654-55"><span class="crayon-h">	</span><span class="crayon-c"># maintaining the aspect ratio), and then grab the image</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9996e5926427654-56"><span class="crayon-h">	</span><span class="crayon-c"># dimensions</span></div><div class="crayon-line" id="crayon-5baa9fe9996e5926427654-57"><span class="crayon-h">	</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imread</span><span class="crayon-sy">(</span><span class="crayon-v">imagePath</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9996e5926427654-58"><span class="crayon-h">	</span><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">imutils</span><span class="crayon-sy">.</span><span class="crayon-e">resize</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-o">=</span><span class="crayon-cn">600</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9996e5926427654-59"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-v">h</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">w</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0055 seconds] -->
<p>We begin looping over 
			<span id="crayon-5baa9fe9996ea974044842" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">imagePaths</span></span></span>&nbsp; on <strong>Line 48</strong>.</p>
<p>First, we extract the 
			<span id="crayon-5baa9fe9996ef830860553" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">name</span></span></span>&nbsp; of the person from the path (<strong>Line 52</strong>). To explain how this works, consider the following example in my Python shell:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe9996f4488927258" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">$ python
&gt;&gt;&gt; from imutils import paths
&gt;&gt;&gt; import os
&gt;&gt;&gt; imagePaths = list(paths.list_images("dataset"))
&gt;&gt;&gt; imagePath = imagePaths[0]
&gt;&gt;&gt; imagePath
'dataset/adrian/00004.jpg'
&gt;&gt;&gt; imagePath.split(os.path.sep)
['dataset', 'adrian', '00004.jpg']
&gt;&gt;&gt; imagePath.split(os.path.sep)[-2]
'adrian'
&gt;&gt;&gt;</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe9996f4488927258-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9996f4488927258-2">2</div><div class="crayon-num" data-line="crayon-5baa9fe9996f4488927258-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9996f4488927258-4">4</div><div class="crayon-num" data-line="crayon-5baa9fe9996f4488927258-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9996f4488927258-6">6</div><div class="crayon-num" data-line="crayon-5baa9fe9996f4488927258-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9996f4488927258-8">8</div><div class="crayon-num" data-line="crayon-5baa9fe9996f4488927258-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9996f4488927258-10">10</div><div class="crayon-num" data-line="crayon-5baa9fe9996f4488927258-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9996f4488927258-12">12</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe9996f4488927258-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-v">python</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9996f4488927258-2"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-e">from </span><span class="crayon-e">imutils </span><span class="crayon-e">import </span><span class="crayon-v">paths</span></div><div class="crayon-line" id="crayon-5baa9fe9996f4488927258-3"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-e">import </span><span class="crayon-v">os</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9996f4488927258-4"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">imagePaths</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">list</span><span class="crayon-sy">(</span><span class="crayon-v">paths</span><span class="crayon-e">.list_images</span><span class="crayon-sy">(</span><span class="crayon-s">"dataset"</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9996f4488927258-5"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">imagePath</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">imagePaths</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9996f4488927258-6"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-i">imagePath</span></div><div class="crayon-line" id="crayon-5baa9fe9996f4488927258-7"><span class="crayon-s">'dataset/adrian/00004.jpg'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9996f4488927258-8"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">imagePath</span><span class="crayon-e">.split</span><span class="crayon-sy">(</span><span class="crayon-v">os</span><span class="crayon-e">.path</span><span class="crayon-e">.sep</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9996f4488927258-9"><span class="crayon-sy">[</span><span class="crayon-s">'dataset'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'adrian'</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">'00004.jpg'</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9996f4488927258-10"><span class="crayon-o">&gt;&gt;&gt;</span><span class="crayon-h"> </span><span class="crayon-v">imagePath</span><span class="crayon-e">.split</span><span class="crayon-sy">(</span><span class="crayon-v">os</span><span class="crayon-e">.path</span><span class="crayon-e">.sep</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5baa9fe9996f4488927258-11"><span class="crayon-s">'adrian'</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9996f4488927258-12"><span class="crayon-o">&gt;&gt;&gt;</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0016 seconds] -->
<p>Notice how by using&nbsp;
			<span id="crayon-5baa9fe9996f9815768867" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">imagePath</span><span class="crayon-sy">.</span><span class="crayon-v">split</span></span></span>&nbsp;&nbsp;and providing the split character (the OS path separator — “/” on unix and “\” on Windows), the function produces a list of folder/file names (strings) which walk down the directory tree. We grab the second-to-last index, the persons 
			<span id="crayon-5baa9fe9996fd817041328" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">name</span></span></span>&nbsp;, which in this case is 
			<span id="crayon-5baa9fe999702499472846" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-s">'adrian'</span></span></span>&nbsp;.</p>
<p>Finally, we wrap up the above code block by loading the 
			<span id="crayon-5baa9fe999707926379020" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">image</span></span></span>&nbsp; and 
			<span id="crayon-5baa9fe99970b083212284" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">resize</span></span></span>&nbsp; it to a known 
			<span id="crayon-5baa9fe999710568040085" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">width</span></span></span>&nbsp; (<strong>Lines 57 and 58</strong>).</p>
<p>Let’s detect and localize faces:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe999714522857676" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">	# construct a blob from the image
	imageBlob = cv2.dnn.blobFromImage(
		cv2.resize(image, (300, 300)), 1.0, (300, 300),
		(104.0, 177.0, 123.0), swapRB=False, crop=False)

	# apply OpenCV's deep learning-based face detector to localize
	# faces in the input image
	detector.setInput(imageBlob)
	detections = detector.forward()</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe999714522857676-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999714522857676-62">62</div><div class="crayon-num" data-line="crayon-5baa9fe999714522857676-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999714522857676-64">64</div><div class="crayon-num" data-line="crayon-5baa9fe999714522857676-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999714522857676-66">66</div><div class="crayon-num" data-line="crayon-5baa9fe999714522857676-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999714522857676-68">68</div><div class="crayon-num" data-line="crayon-5baa9fe999714522857676-69">69</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe999714522857676-61"><span class="crayon-h">	</span><span class="crayon-c"># construct a blob from the image</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999714522857676-62"><span class="crayon-h">	</span><span class="crayon-v">imageBlob</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">dnn</span><span class="crayon-sy">.</span><span class="crayon-e">blobFromImage</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="crayon-5baa9fe999714522857676-63"><span class="crayon-h">		</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">resize</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">300</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">300</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">300</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">300</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999714522857676-64"><span class="crayon-h">		</span><span class="crayon-sy">(</span><span class="crayon-cn">104.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">177.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">123.0</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">swapRB</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">crop</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe999714522857676-65">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999714522857676-66"><span class="crayon-h">	</span><span class="crayon-c"># apply OpenCV's deep learning-based face detector to localize</span></div><div class="crayon-line" id="crayon-5baa9fe999714522857676-67"><span class="crayon-h">	</span><span class="crayon-c"># faces in the input image</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999714522857676-68"><span class="crayon-h">	</span><span class="crayon-v">detector</span><span class="crayon-sy">.</span><span class="crayon-e">setInput</span><span class="crayon-sy">(</span><span class="crayon-v">imageBlob</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe999714522857676-69"><span class="crayon-h">	</span><span class="crayon-v">detections</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">detector</span><span class="crayon-sy">.</span><span class="crayon-e">forward</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0022 seconds] -->
<p>On&nbsp;<strong>Lines 62-64</strong>, we construct a blob. To learn more about this process, please read&nbsp;<a href="https://www.pyimagesearch.com/2017/11/06/deep-learning-opencvs-blobfromimage-works/" target="_blank" rel="noopener"><em>Deep learning: How OpenCV’s blobFromImage works</em></a>.</p>
<p>From there we detect faces in the image by passing the 
			<span id="crayon-5baa9fe999719126925377" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">imageBlob</span></span></span>&nbsp; through the 
			<span id="crayon-5baa9fe99971e225575328" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">detector</span></span></span>&nbsp; network (<strong>Lines 68 and 69</strong>).</p>
<p>Let’s process the 
			<span id="crayon-5baa9fe999722010026515" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">detections</span></span></span>&nbsp;:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe999727637732930" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">	# ensure at least one face was found
	if len(detections) &gt; 0:
		# we're making the assumption that each image has only ONE
		# face, so find the bounding box with the largest probability
		i = np.argmax(detections[0, 0, :, 2])
		confidence = detections[0, 0, i, 2]

		# ensure that the detection with the largest probability also
		# means our minimum probability test (thus helping filter out
		# weak detections)
		if confidence &gt; args["confidence"]:
			# compute the (x, y)-coordinates of the bounding box for
			# the face
			box = detections[0, 0, i, 3:7] * np.array([w, h, w, h])
			(startX, startY, endX, endY) = box.astype("int")

			# extract the face ROI and grab the ROI dimensions
			face = image[startY:endY, startX:endX]
			(fH, fW) = face.shape[:2]

			# ensure the face width and height are sufficiently large
			if fW &lt; 20 or fH &lt; 20:
				continue</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe999727637732930-71">71</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999727637732930-72">72</div><div class="crayon-num" data-line="crayon-5baa9fe999727637732930-73">73</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999727637732930-74">74</div><div class="crayon-num" data-line="crayon-5baa9fe999727637732930-75">75</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999727637732930-76">76</div><div class="crayon-num" data-line="crayon-5baa9fe999727637732930-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999727637732930-78">78</div><div class="crayon-num" data-line="crayon-5baa9fe999727637732930-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999727637732930-80">80</div><div class="crayon-num" data-line="crayon-5baa9fe999727637732930-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999727637732930-82">82</div><div class="crayon-num" data-line="crayon-5baa9fe999727637732930-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999727637732930-84">84</div><div class="crayon-num" data-line="crayon-5baa9fe999727637732930-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999727637732930-86">86</div><div class="crayon-num" data-line="crayon-5baa9fe999727637732930-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999727637732930-88">88</div><div class="crayon-num" data-line="crayon-5baa9fe999727637732930-89">89</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999727637732930-90">90</div><div class="crayon-num" data-line="crayon-5baa9fe999727637732930-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999727637732930-92">92</div><div class="crayon-num" data-line="crayon-5baa9fe999727637732930-93">93</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe999727637732930-71"><span class="crayon-h">	</span><span class="crayon-c"># ensure at least one face was found</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999727637732930-72"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-k ">len</span><span class="crayon-sy">(</span><span class="crayon-v">detections</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5baa9fe999727637732930-73"><span class="crayon-h">		</span><span class="crayon-c"># we're making the assumption that each image has only ONE</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999727637732930-74"><span class="crayon-h">		</span><span class="crayon-c"># face, so find the bounding box with the largest probability</span></div><div class="crayon-line" id="crayon-5baa9fe999727637732930-75"><span class="crayon-h">		</span><span class="crayon-v">i</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">argmax</span><span class="crayon-sy">(</span><span class="crayon-v">detections</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">:</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999727637732930-76"><span class="crayon-h">		</span><span class="crayon-v">confidence</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">detections</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5baa9fe999727637732930-77">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999727637732930-78"><span class="crayon-h">		</span><span class="crayon-c"># ensure that the detection with the largest probability also</span></div><div class="crayon-line" id="crayon-5baa9fe999727637732930-79"><span class="crayon-h">		</span><span class="crayon-c"># means our minimum probability test (thus helping filter out</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999727637732930-80"><span class="crayon-h">		</span><span class="crayon-c"># weak detections)</span></div><div class="crayon-line" id="crayon-5baa9fe999727637732930-81"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">confidence</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"confidence"</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999727637732930-82"><span class="crayon-h">			</span><span class="crayon-c"># compute the (x, y)-coordinates of the bounding box for</span></div><div class="crayon-line" id="crayon-5baa9fe999727637732930-83"><span class="crayon-h">			</span><span class="crayon-c"># the face</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999727637732930-84"><span class="crayon-h">			</span><span class="crayon-v">box</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">detections</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-o">:</span><span class="crayon-cn">7</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-k ">w</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">h</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">w</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">h</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe999727637732930-85"><span class="crayon-h">			</span><span class="crayon-sy">(</span><span class="crayon-v">startX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">startY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">endX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">endY</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">box</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">"int"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999727637732930-86">&nbsp;</div><div class="crayon-line" id="crayon-5baa9fe999727637732930-87"><span class="crayon-h">			</span><span class="crayon-c"># extract the face ROI and grab the ROI dimensions</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999727637732930-88"><span class="crayon-h">			</span><span class="crayon-v">face</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">[</span><span class="crayon-v">startY</span><span class="crayon-o">:</span><span class="crayon-v">endY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">startX</span><span class="crayon-o">:</span><span class="crayon-v">endX</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5baa9fe999727637732930-89"><span class="crayon-h">			</span><span class="crayon-sy">(</span><span class="crayon-v">fH</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fW</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">face</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999727637732930-90">&nbsp;</div><div class="crayon-line" id="crayon-5baa9fe999727637732930-91"><span class="crayon-h">			</span><span class="crayon-c"># ensure the face width and height are sufficiently large</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999727637732930-92"><span class="crayon-h">			</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">fW</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-v">fH</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5baa9fe999727637732930-93"><span class="crayon-h">				</span><span class="crayon-st">continue</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0052 seconds] -->
<p>The 
			<span id="crayon-5baa9fe99972d642472112" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">detections</span></span></span>&nbsp; list contains probabilities and coordinates to localize faces in an image.</p>
<p>Assuming we have at least one detection, we’ll proceed into the body of the if-statement (<strong>Line 72</strong>).</p>
<p>We make the assumption that there is only <em>one</em> face in the image, so we extract the detection with the highest 
			<span id="crayon-5baa9fe999732710852295" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">confidence</span></span></span>&nbsp; and check to make sure that the confidence meets the minimum probability threshold used to filter out weak detections (<strong>Lines 75-81</strong>).</p>
<p>Assuming we’ve met that threshold, we extract the 
			<span id="crayon-5baa9fe999736068986313" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">face</span></span></span>&nbsp; ROI and grab/check dimensions to make sure the 
			<span id="crayon-5baa9fe99973b439850044" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">face</span></span></span>&nbsp; ROI is sufficiently large (<strong>Lines 84-93</strong>).</p>
<p>From there, we’ll take advantage of our 
			<span id="crayon-5baa9fe99973f159170316" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">embedder</span></span></span>&nbsp; CNN and extract the face embeddings:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe999744773532461" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">			# construct a blob for the face ROI, then pass the blob
			# through our face embedding model to obtain the 128-d
			# quantification of the face
			faceBlob = cv2.dnn.blobFromImage(face, 1.0 / 255,
				(96, 96), (0, 0, 0), swapRB=True, crop=False)
			embedder.setInput(faceBlob)
			vec = embedder.forward()

			# add the name of the person + corresponding face
			# embedding to their respective lists
			knownNames.append(name)
			knownEmbeddings.append(vec.flatten())
			total += 1</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe999744773532461-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999744773532461-96">96</div><div class="crayon-num" data-line="crayon-5baa9fe999744773532461-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999744773532461-98">98</div><div class="crayon-num" data-line="crayon-5baa9fe999744773532461-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999744773532461-100">100</div><div class="crayon-num" data-line="crayon-5baa9fe999744773532461-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999744773532461-102">102</div><div class="crayon-num" data-line="crayon-5baa9fe999744773532461-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999744773532461-104">104</div><div class="crayon-num" data-line="crayon-5baa9fe999744773532461-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999744773532461-106">106</div><div class="crayon-num" data-line="crayon-5baa9fe999744773532461-107">107</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe999744773532461-95"><span class="crayon-h">			</span><span class="crayon-c"># construct a blob for the face ROI, then pass the blob</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999744773532461-96"><span class="crayon-h">			</span><span class="crayon-c"># through our face embedding model to obtain the 128-d</span></div><div class="crayon-line" id="crayon-5baa9fe999744773532461-97"><span class="crayon-h">			</span><span class="crayon-c"># quantification of the face</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999744773532461-98"><span class="crayon-h">			</span><span class="crayon-v">faceBlob</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">dnn</span><span class="crayon-sy">.</span><span class="crayon-e">blobFromImage</span><span class="crayon-sy">(</span><span class="crayon-v">face</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5baa9fe999744773532461-99"><span class="crayon-h">				</span><span class="crayon-sy">(</span><span class="crayon-cn">96</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">96</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">swapRB</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">crop</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999744773532461-100"><span class="crayon-h">			</span><span class="crayon-v">embedder</span><span class="crayon-sy">.</span><span class="crayon-e">setInput</span><span class="crayon-sy">(</span><span class="crayon-v">faceBlob</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe999744773532461-101"><span class="crayon-h">			</span><span class="crayon-v">vec</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">embedder</span><span class="crayon-sy">.</span><span class="crayon-e">forward</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999744773532461-102">&nbsp;</div><div class="crayon-line" id="crayon-5baa9fe999744773532461-103"><span class="crayon-h">			</span><span class="crayon-c"># add the name of the person + corresponding face</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999744773532461-104"><span class="crayon-h">			</span><span class="crayon-c"># embedding to their respective lists</span></div><div class="crayon-line" id="crayon-5baa9fe999744773532461-105"><span class="crayon-h">			</span><span class="crayon-v">knownNames</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">name</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999744773532461-106"><span class="crayon-h">			</span><span class="crayon-v">knownEmbeddings</span><span class="crayon-sy">.</span><span class="crayon-e">append</span><span class="crayon-sy">(</span><span class="crayon-v">vec</span><span class="crayon-sy">.</span><span class="crayon-e">flatten</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe999744773532461-107"><span class="crayon-h">			</span><span class="crayon-v">total</span><span class="crayon-h"> </span><span class="crayon-o">+=</span><span class="crayon-h"> </span><span class="crayon-cn">1</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0026 seconds] -->
<p>We construct another blob, this time from the face ROI (not the whole image as we did before) on&nbsp;<strong>Lines 98 and 99</strong>.</p>
<p>Subsequently, we pass the 
			<span id="crayon-5baa9fe999749051210681" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">faceBlob</span></span></span>&nbsp; through the embedder CNN (<strong>Lines 100 and 101</strong>). This generates a 128-D vector (
			<span id="crayon-5baa9fe99974d531022555" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">vec</span></span></span>&nbsp;) which describes the face. We’ll leverage this data to recognize new faces via machine learning.</p>
<p>And then we simply add the 
			<span id="crayon-5baa9fe999752748615379" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">name</span></span></span>&nbsp; and embedding 
			<span id="crayon-5baa9fe999757672103537" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">vec</span></span></span>&nbsp; to 
			<span id="crayon-5baa9fe99975b670939341" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">knownNames</span></span></span>&nbsp; and 
			<span id="crayon-5baa9fe99975f220970919" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">knownEmbeddings</span></span></span>&nbsp;, respectively (<strong>Lines 105 and 106</strong>).</p>
<p>We also can’t forget about the variable we set to track the 
			<span id="crayon-5baa9fe999764276736857" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">total</span></span></span>&nbsp; number of faces either — we go ahead and increment the value on&nbsp;<strong>Line 107</strong>.</p>
<p>We continue this process of looping over images, detecting faces, and extracting face embeddings for&nbsp;<em>each and every image</em> in our dataset.</p>
<p>All that’s left when the loop finishes is to dump the data to disk:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe999769197352129" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># dump the facial embeddings + names to disk
print("[INFO] serializing {} encodings...".format(total))
data = {"embeddings": knownEmbeddings, "names": knownNames}
f = open(args["embeddings"], "wb")
f.write(pickle.dumps(data))
f.close()</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe999769197352129-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999769197352129-110">110</div><div class="crayon-num" data-line="crayon-5baa9fe999769197352129-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999769197352129-112">112</div><div class="crayon-num" data-line="crayon-5baa9fe999769197352129-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999769197352129-114">114</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe999769197352129-109"><span class="crayon-c"># dump the facial embeddings + names to disk</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999769197352129-110"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"[INFO] serializing {} encodings..."</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">total</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe999769197352129-111"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-sy">{</span><span class="crayon-s">"embeddings"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">knownEmbeddings</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"names"</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">knownNames</span><span class="crayon-sy">}</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999769197352129-112"><span class="crayon-v">f</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">open</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"embeddings"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"wb"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe999769197352129-113"><span class="crayon-v">f</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-k ">pickle</span><span class="crayon-sy">.</span><span class="crayon-e">dumps</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999769197352129-114"><span class="crayon-v">f</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0015 seconds] -->
<p>We add the name and embedding data to a dictionary and then serialize the 
			<span id="crayon-5baa9fe99976e677304840" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">data</span></span></span>&nbsp; in a pickle file on <strong>Lines 110-114</strong>.</p>
<p>At this point we’re ready to extract embeddings by running our script.</p>
<p>To follow along with this face recognition tutorial, use the <em><strong>“Downloads”</strong></em> section of the post to download the source code, OpenCV models, and example face recognition dataset.</p>
<p>From there, open up a terminal and execute the following command to compute the face embeddings with OpenCV:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe999773885798962" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important; margin-top: -18px; display: none;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">$ python extract_embeddings.py --dataset dataset \
	--embeddings output/embeddings.pickle \
	--detector face_detection_model \
	--embedding-model openface_nn4.small2.v1.t7
[INFO] loading face detector...
[INFO] loading face recognizer...
[INFO] quantifying faces...
[INFO] processing image 1/18
[INFO] processing image 2/18
[INFO] processing image 3/18
[INFO] processing image 4/18
[INFO] processing image 5/18
[INFO] processing image 6/18
[INFO] processing image 7/18
[INFO] processing image 8/18
[INFO] processing image 9/18
[INFO] processing image 10/18
[INFO] processing image 11/18
[INFO] processing image 12/18
[INFO] processing image 13/18
[INFO] processing image 14/18
[INFO] processing image 15/18
[INFO] processing image 16/18
[INFO] processing image 17/18
[INFO] processing image 18/18
[INFO] serializing 18 encodings...</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe999773885798962-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999773885798962-2">2</div><div class="crayon-num" data-line="crayon-5baa9fe999773885798962-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999773885798962-4">4</div><div class="crayon-num" data-line="crayon-5baa9fe999773885798962-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999773885798962-6">6</div><div class="crayon-num" data-line="crayon-5baa9fe999773885798962-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999773885798962-8">8</div><div class="crayon-num" data-line="crayon-5baa9fe999773885798962-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999773885798962-10">10</div><div class="crayon-num" data-line="crayon-5baa9fe999773885798962-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999773885798962-12">12</div><div class="crayon-num" data-line="crayon-5baa9fe999773885798962-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999773885798962-14">14</div><div class="crayon-num" data-line="crayon-5baa9fe999773885798962-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999773885798962-16">16</div><div class="crayon-num" data-line="crayon-5baa9fe999773885798962-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999773885798962-18">18</div><div class="crayon-num" data-line="crayon-5baa9fe999773885798962-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999773885798962-20">20</div><div class="crayon-num" data-line="crayon-5baa9fe999773885798962-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999773885798962-22">22</div><div class="crayon-num" data-line="crayon-5baa9fe999773885798962-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999773885798962-24">24</div><div class="crayon-num" data-line="crayon-5baa9fe999773885798962-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999773885798962-26">26</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe999773885798962-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">python </span><span class="crayon-v">extract_embeddings</span><span class="crayon-e">.py</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-e">dataset </span><span class="crayon-i">dataset</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999773885798962-2"><span class="crayon-h">	</span><span class="crayon-o">--</span><span class="crayon-e">embeddings </span><span class="crayon-v">output</span><span class="crayon-o">/</span><span class="crayon-v">embeddings</span><span class="crayon-e">.pickle</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line" id="crayon-5baa9fe999773885798962-3"><span class="crayon-h">	</span><span class="crayon-o">--</span><span class="crayon-e">detector </span><span class="crayon-v">face_detection</span><span class="crayon-sy">_</span>model<span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999773885798962-4"><span class="crayon-h">	</span><span class="crayon-o">--</span><span class="crayon-v">embedding</span><span class="crayon-o">-</span><span class="crayon-e">model </span><span class="crayon-v">openface_nn4</span><span class="crayon-e">.small2</span><span class="crayon-e">.v1</span><span class="crayon-e">.t7</span></div><div class="crayon-line" id="crayon-5baa9fe999773885798962-5"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">loading </span><span class="crayon-e">face </span><span class="crayon-v">detector</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999773885798962-6"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">loading </span><span class="crayon-e">face </span><span class="crayon-v">recognizer</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5baa9fe999773885798962-7"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">quantifying </span><span class="crayon-v">faces</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999773885798962-8"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">processing </span><span class="crayon-i">image</span><span class="crayon-h"> </span><span class="crayon-cn">1</span><span class="crayon-o">/</span><span class="crayon-cn">18</span></div><div class="crayon-line" id="crayon-5baa9fe999773885798962-9"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">processing </span><span class="crayon-i">image</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-o">/</span><span class="crayon-cn">18</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999773885798962-10"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">processing </span><span class="crayon-i">image</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-o">/</span><span class="crayon-cn">18</span></div><div class="crayon-line" id="crayon-5baa9fe999773885798962-11"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">processing </span><span class="crayon-i">image</span><span class="crayon-h"> </span><span class="crayon-cn">4</span><span class="crayon-o">/</span><span class="crayon-cn">18</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999773885798962-12"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">processing </span><span class="crayon-i">image</span><span class="crayon-h"> </span><span class="crayon-cn">5</span><span class="crayon-o">/</span><span class="crayon-cn">18</span></div><div class="crayon-line" id="crayon-5baa9fe999773885798962-13"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">processing </span><span class="crayon-i">image</span><span class="crayon-h"> </span><span class="crayon-cn">6</span><span class="crayon-o">/</span><span class="crayon-cn">18</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999773885798962-14"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">processing </span><span class="crayon-i">image</span><span class="crayon-h"> </span><span class="crayon-cn">7</span><span class="crayon-o">/</span><span class="crayon-cn">18</span></div><div class="crayon-line" id="crayon-5baa9fe999773885798962-15"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">processing </span><span class="crayon-i">image</span><span class="crayon-h"> </span><span class="crayon-cn">8</span><span class="crayon-o">/</span><span class="crayon-cn">18</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999773885798962-16"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">processing </span><span class="crayon-i">image</span><span class="crayon-h"> </span><span class="crayon-cn">9</span><span class="crayon-o">/</span><span class="crayon-cn">18</span></div><div class="crayon-line" id="crayon-5baa9fe999773885798962-17"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">processing </span><span class="crayon-i">image</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-o">/</span><span class="crayon-cn">18</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999773885798962-18"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">processing </span><span class="crayon-i">image</span><span class="crayon-h"> </span><span class="crayon-cn">11</span><span class="crayon-o">/</span><span class="crayon-cn">18</span></div><div class="crayon-line" id="crayon-5baa9fe999773885798962-19"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">processing </span><span class="crayon-i">image</span><span class="crayon-h"> </span><span class="crayon-cn">12</span><span class="crayon-o">/</span><span class="crayon-cn">18</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999773885798962-20"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">processing </span><span class="crayon-i">image</span><span class="crayon-h"> </span><span class="crayon-cn">13</span><span class="crayon-o">/</span><span class="crayon-cn">18</span></div><div class="crayon-line" id="crayon-5baa9fe999773885798962-21"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">processing </span><span class="crayon-i">image</span><span class="crayon-h"> </span><span class="crayon-cn">14</span><span class="crayon-o">/</span><span class="crayon-cn">18</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999773885798962-22"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">processing </span><span class="crayon-i">image</span><span class="crayon-h"> </span><span class="crayon-cn">15</span><span class="crayon-o">/</span><span class="crayon-cn">18</span></div><div class="crayon-line" id="crayon-5baa9fe999773885798962-23"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">processing </span><span class="crayon-i">image</span><span class="crayon-h"> </span><span class="crayon-cn">16</span><span class="crayon-o">/</span><span class="crayon-cn">18</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999773885798962-24"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">processing </span><span class="crayon-i">image</span><span class="crayon-h"> </span><span class="crayon-cn">17</span><span class="crayon-o">/</span><span class="crayon-cn">18</span></div><div class="crayon-line" id="crayon-5baa9fe999773885798962-25"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">processing </span><span class="crayon-i">image</span><span class="crayon-h"> </span><span class="crayon-cn">18</span><span class="crayon-o">/</span><span class="crayon-cn">18</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999773885798962-26"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-i">serializing</span><span class="crayon-h"> </span><span class="crayon-cn">18</span><span class="crayon-h"> </span><span class="crayon-v">encodings</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0060 seconds] -->
<p>Here you can see that we have extracted 18 face embeddings, one for each of the images (6 per class) in our input face dataset.</p>
<h3>Step #2: Train face recognition model</h3>
<p>At this point we have extracted 128-d embeddings for each face — <em>but how do we actually recognize a person based on these embeddings?</em> The answer is that we need to train a “standard” machine learning model (such as an SVM, k-NN classifier, Random Forest, etc.) on top of the embeddings.</p>
<p>In my <a href="https://www.pyimagesearch.com/2018/06/18/face-recognition-with-opencv-python-and-deep-learning/" target="_blank" rel="noopener">previous face recognition tutorial</a>&nbsp;we discovered how a modified version of k-NN can be used for face recognition on 128-d embeddings created via the <a href="http://dlib.net/" target="_blank" rel="noopener">dlib</a> and <a href="https://github.com/ageitgey/face_recognition" target="_blank" rel="noopener">face_recognition</a> libraries.</p>
<p>Today, I want to share how we can build a more powerful classifier on top of the embeddings — you’ll be able to use this same method in your dlib-based face recognition pipelines as well if you are so inclined.</p>
<p>Open up the 
			<span id="crayon-5baa9fe99977a990322532" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">train_model</span><span class="crayon-e">.py</span></span></span>&nbsp; file and insert the following code:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe99977f401232374" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># import the necessary packages
from sklearn.preprocessing import LabelEncoder
from sklearn.svm import SVC
import argparse
import pickle

# construct the argument parser and parse the arguments
ap = argparse.ArgumentParser()
ap.add_argument("-e", "--embeddings", required=True,
	help="path to serialized db of facial embeddings")
ap.add_argument("-r", "--recognizer", required=True,
	help="path to output model trained to recognize faces")
ap.add_argument("-l", "--le", required=True,
	help="path to output label encoder")
args = vars(ap.parse_args())</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe99977f401232374-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe99977f401232374-2">2</div><div class="crayon-num" data-line="crayon-5baa9fe99977f401232374-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe99977f401232374-4">4</div><div class="crayon-num" data-line="crayon-5baa9fe99977f401232374-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe99977f401232374-6">6</div><div class="crayon-num" data-line="crayon-5baa9fe99977f401232374-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe99977f401232374-8">8</div><div class="crayon-num" data-line="crayon-5baa9fe99977f401232374-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe99977f401232374-10">10</div><div class="crayon-num" data-line="crayon-5baa9fe99977f401232374-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe99977f401232374-12">12</div><div class="crayon-num" data-line="crayon-5baa9fe99977f401232374-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe99977f401232374-14">14</div><div class="crayon-num" data-line="crayon-5baa9fe99977f401232374-15">15</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe99977f401232374-1"><span class="crayon-c"># import the necessary packages</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe99977f401232374-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">preprocessing </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">LabelEncoder</span></div><div class="crayon-line" id="crayon-5baa9fe99977f401232374-3"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">sklearn</span><span class="crayon-sy">.</span><span class="crayon-e">svm </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">SVC</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe99977f401232374-4"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">argparse</span></div><div class="crayon-line" id="crayon-5baa9fe99977f401232374-5"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">pickle</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe99977f401232374-6">&nbsp;</div><div class="crayon-line" id="crayon-5baa9fe99977f401232374-7"><span class="crayon-c"># construct the argument parser and parse the arguments</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe99977f401232374-8"><span class="crayon-v">ap</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">argparse</span><span class="crayon-sy">.</span><span class="crayon-e">ArgumentParser</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe99977f401232374-9"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-e"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--embeddings"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe99977f401232374-10"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"path to serialized db of facial embeddings"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe99977f401232374-11"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-r"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--recognizer"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe99977f401232374-12"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"path to output model trained to recognize faces"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe99977f401232374-13"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-l"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--le"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe99977f401232374-14"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"path to output label encoder"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe99977f401232374-15"><span class="crayon-v">args</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">vars</span><span class="crayon-sy">(</span><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">parse_args</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0028 seconds] -->
<p>We’ll need <a href="http://scikit-learn.org/stable/" target="_blank" rel="noopener">scikit-learn</a>, a machine learning library, installed in our environment prior to running this script. You can install it via pip:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe999784832608732" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">$ pip install scikit-learn</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe999784832608732-1">1</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe999784832608732-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">pip </span><span class="crayon-e">install </span><span class="crayon-v">scikit</span><span class="crayon-o">-</span><span class="crayon-v">learn</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0004 seconds] -->
<p>We import our packages and modules on&nbsp;<strong>Lines 2-5</strong>. We’ll be using scikit-learn’s implementation of Support Vector Machines (SVM), a common machine learning model.</p>
<p>From there we parse our command line arguments:</p>
<ul>
<li>
			<span id="crayon-5baa9fe999789597375168" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-o">--</span><span class="crayon-v">embeddings</span></span></span>&nbsp;: The path to the serialized embeddings (we exported it by running the previous 
			<span id="crayon-5baa9fe99978d127589578" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">extract_embeddings</span><span class="crayon-e">.py</span></span></span>&nbsp; script).</li>
<li>
			<span id="crayon-5baa9fe999792516035350" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-o">--</span><span class="crayon-v">recognizer</span></span></span>&nbsp;: This will be our output model that <em>recognizes</em> faces. It is based on SVM. We’ll be saving it so we can use it in the next two recognition scripts.</li>
<li>
			<span id="crayon-5baa9fe999797119936440" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-o">--</span><span class="crayon-v">le</span></span></span>&nbsp;: Our label encoder output file path. We’ll serialize our label encoder to disk so that we can use it and the recognizer model in our image/video face recognition scripts.</li>
</ul>
<p>Each of these arguments is&nbsp;<em>required</em>.</p>
<p>Let’s load our facial embeddings and encode our labels:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe99979b158727830" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># load the face embeddings
print("[INFO] loading face embeddings...")
data = pickle.loads(open(args["embeddings"], "rb").read())

# encode the labels
print("[INFO] encoding labels...")
le = LabelEncoder()
labels = le.fit_transform(data["names"])</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe99979b158727830-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe99979b158727830-18">18</div><div class="crayon-num" data-line="crayon-5baa9fe99979b158727830-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe99979b158727830-20">20</div><div class="crayon-num" data-line="crayon-5baa9fe99979b158727830-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe99979b158727830-22">22</div><div class="crayon-num" data-line="crayon-5baa9fe99979b158727830-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe99979b158727830-24">24</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe99979b158727830-17"><span class="crayon-c"># load the face embeddings</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe99979b158727830-18"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"[INFO] loading face embeddings..."</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe99979b158727830-19"><span class="crayon-v">data</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">pickle</span><span class="crayon-sy">.</span><span class="crayon-e">loads</span><span class="crayon-sy">(</span><span class="crayon-k ">open</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"embeddings"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"rb"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe99979b158727830-20">&nbsp;</div><div class="crayon-line" id="crayon-5baa9fe99979b158727830-21"><span class="crayon-c"># encode the labels</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe99979b158727830-22"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"[INFO] encoding labels..."</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe99979b158727830-23"><span class="crayon-v">le</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">LabelEncoder</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe99979b158727830-24"><span class="crayon-v">labels</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">le</span><span class="crayon-sy">.</span><span class="crayon-e">fit_transform</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">"names"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0014 seconds] -->
<p>Here we load our embeddings from&nbsp;<strong>Step #1</strong> on&nbsp;<strong>Line 19</strong>. We won’t be generating any embeddings in this model training script — we’ll use the embeddings previously generated and serialized.</p>
<p>Then we initialize our scikit-learn 
			<span id="crayon-5baa9fe9997a1473613899" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">LabelEncoder</span></span></span>&nbsp; and encode our name 
			<span id="crayon-5baa9fe9997a5538230739" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">labels</span></span></span>&nbsp; (<strong>Lines 23 and 24</strong>).</p>
<p>Now it’s time to train our SVM model for recognizing faces:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe9997aa834408897" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># train the model used to accept the 128-d embeddings of the face and
# then produce the actual face recognition
print("[INFO] training model...")
recognizer = SVC(C=1.0, kernel="linear", probability=True)
recognizer.fit(data["embeddings"], labels)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe9997aa834408897-26">26</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9997aa834408897-27">27</div><div class="crayon-num" data-line="crayon-5baa9fe9997aa834408897-28">28</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9997aa834408897-29">29</div><div class="crayon-num" data-line="crayon-5baa9fe9997aa834408897-30">30</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe9997aa834408897-26"><span class="crayon-c"># train the model used to accept the 128-d embeddings of the face and</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9997aa834408897-27"><span class="crayon-c"># then produce the actual face recognition</span></div><div class="crayon-line" id="crayon-5baa9fe9997aa834408897-28"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"[INFO] training model..."</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9997aa834408897-29"><span class="crayon-v">recognizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">SVC</span><span class="crayon-sy">(</span><span class="crayon-v">C</span><span class="crayon-o">=</span><span class="crayon-cn">1.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">kernel</span><span class="crayon-o">=</span><span class="crayon-s">"linear"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">probability</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9997aa834408897-30"><span class="crayon-v">recognizer</span><span class="crayon-sy">.</span><span class="crayon-e">fit</span><span class="crayon-sy">(</span><span class="crayon-v">data</span><span class="crayon-sy">[</span><span class="crayon-s">"embeddings"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">labels</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0012 seconds] -->
<p>On&nbsp;<strong>Line 29</strong> we initialize our SVM model, and on&nbsp;<strong>Line 30</strong> we 
			<span id="crayon-5baa9fe9997af684743524" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">fit</span></span></span>&nbsp; the model (also known as “training the model”).</p>
<p>Here we are using a Linear Support Vector Machine (SVM) but you can try experimenting with other machine learning models if you so wish.</p>
<p>After training the model we output the model and label encoder to disk as pickle files.</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe9997b3424092564" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># write the actual face recognition model to disk
f = open(args["recognizer"], "wb")
f.write(pickle.dumps(recognizer))
f.close()

# write the label encoder to disk
f = open(args["le"], "wb")
f.write(pickle.dumps(le))
f.close()</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe9997b3424092564-32">32</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9997b3424092564-33">33</div><div class="crayon-num" data-line="crayon-5baa9fe9997b3424092564-34">34</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9997b3424092564-35">35</div><div class="crayon-num" data-line="crayon-5baa9fe9997b3424092564-36">36</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9997b3424092564-37">37</div><div class="crayon-num" data-line="crayon-5baa9fe9997b3424092564-38">38</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9997b3424092564-39">39</div><div class="crayon-num" data-line="crayon-5baa9fe9997b3424092564-40">40</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe9997b3424092564-32"><span class="crayon-c"># write the actual face recognition model to disk</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9997b3424092564-33"><span class="crayon-v">f</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">open</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"recognizer"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"wb"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9997b3424092564-34"><span class="crayon-v">f</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-k ">pickle</span><span class="crayon-sy">.</span><span class="crayon-e">dumps</span><span class="crayon-sy">(</span><span class="crayon-v">recognizer</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9997b3424092564-35"><span class="crayon-v">f</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9997b3424092564-36">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9997b3424092564-37"><span class="crayon-c"># write the label encoder to disk</span></div><div class="crayon-line" id="crayon-5baa9fe9997b3424092564-38"><span class="crayon-v">f</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">open</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"le"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"wb"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9997b3424092564-39"><span class="crayon-v">f</span><span class="crayon-sy">.</span><span class="crayon-e">write</span><span class="crayon-sy">(</span><span class="crayon-k ">pickle</span><span class="crayon-sy">.</span><span class="crayon-e">dumps</span><span class="crayon-sy">(</span><span class="crayon-v">le</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9997b3424092564-40"><span class="crayon-v">f</span><span class="crayon-sy">.</span><span class="crayon-e">close</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0017 seconds] -->
<p>We write two pickle files to disk in this block — the <em>face recognizer model</em> and the <em>label encoder</em>.</p>
<p>At this point, be sure you executed the code from&nbsp;<strong>Step #1</strong> first. You can grab the zip containing the code and data from the&nbsp;<em><strong>“Downloads”</strong></em> section.</p>
<p>Now that we have finished coding 
			<span id="crayon-5baa9fe9997b9854887526" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">train_model</span><span class="crayon-e">.py</span></span></span>&nbsp; as well, let’s apply it to our extracted face embeddings:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe9997bd912665299" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">$ python train_model.py --embeddings output/embeddings.pickle \
	--recognizer output/recognizer.pickle \
	--le output/le.pickle
[INFO] loading face embeddings...
[INFO] encoding labels...
[INFO] training model...
$ ls output/
embeddings.pickle	le.pickle		recognizer.pickle</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe9997bd912665299-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9997bd912665299-2">2</div><div class="crayon-num" data-line="crayon-5baa9fe9997bd912665299-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9997bd912665299-4">4</div><div class="crayon-num" data-line="crayon-5baa9fe9997bd912665299-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9997bd912665299-6">6</div><div class="crayon-num" data-line="crayon-5baa9fe9997bd912665299-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9997bd912665299-8">8</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe9997bd912665299-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">python </span><span class="crayon-v">train_model</span><span class="crayon-e">.py</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-e">embeddings </span><span class="crayon-v">output</span><span class="crayon-o">/</span><span class="crayon-v">embeddings</span><span class="crayon-e">.pickle</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9997bd912665299-2"><span class="crayon-h">	</span><span class="crayon-o">--</span><span class="crayon-e">recognizer </span><span class="crayon-v">output</span><span class="crayon-o">/</span><span class="crayon-v">recognizer</span><span class="crayon-e">.pickle</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line" id="crayon-5baa9fe9997bd912665299-3"><span class="crayon-h">	</span><span class="crayon-o">--</span><span class="crayon-e">le </span><span class="crayon-v">output</span><span class="crayon-o">/</span><span class="crayon-v">le</span><span class="crayon-e">.pickle</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9997bd912665299-4"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">loading </span><span class="crayon-e">face </span><span class="crayon-v">embeddings</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5baa9fe9997bd912665299-5"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">encoding </span><span class="crayon-v">labels</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9997bd912665299-6"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">training </span><span class="crayon-v">model</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5baa9fe9997bd912665299-7"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-r">ls</span><span class="crayon-h"> </span><span class="crayon-v">output</span><span class="crayon-o">/</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9997bd912665299-8"><span class="crayon-v">embeddings</span><span class="crayon-e">.pickle</span><span class="crayon-h">	</span><span class="crayon-v">le</span><span class="crayon-e">.pickle</span><span class="crayon-h">		</span><span class="crayon-v">recognizer</span><span class="crayon-e">.pickle</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0017 seconds] -->
<p>Here you can see that our SVM has been trained on the embeddings and both the (1) SVM itself and (2) the label encoding have been written to disk, enabling us to apply them to input images and video.</p>
<h3>Step #3: Recognize faces with OpenCV</h3>
<p>We are now ready to perform face recognition with OpenCV!</p>
<p>We’ll start with recognizing faces in images in this section and then move on to recognizing faces in video streams in the following section.</p>
<p>Open up the 
			<span id="crayon-5baa9fe9997c3154033280" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">recognize</span><span class="crayon-e">.py</span></span></span>&nbsp; file in your project and insert the following code:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe9997c7067515907" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># import the necessary packages
import numpy as np
import argparse
import imutils
import pickle
import cv2
import os

# construct the argument parser and parse the arguments
ap = argparse.ArgumentParser()
ap.add_argument("-i", "--image", required=True,
	help="path to input image")
ap.add_argument("-d", "--detector", required=True,
	help="path to OpenCV's deep learning face detector")
ap.add_argument("-m", "--embedding-model", required=True,
	help="path to OpenCV's deep learning face embedding model")
ap.add_argument("-r", "--recognizer", required=True,
	help="path to model trained to recognize faces")
ap.add_argument("-l", "--le", required=True,
	help="path to label encoder")
ap.add_argument("-c", "--confidence", type=float, default=0.5,
	help="minimum probability to filter weak detections")
args = vars(ap.parse_args())</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe9997c7067515907-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9997c7067515907-2">2</div><div class="crayon-num" data-line="crayon-5baa9fe9997c7067515907-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9997c7067515907-4">4</div><div class="crayon-num" data-line="crayon-5baa9fe9997c7067515907-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9997c7067515907-6">6</div><div class="crayon-num" data-line="crayon-5baa9fe9997c7067515907-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9997c7067515907-8">8</div><div class="crayon-num" data-line="crayon-5baa9fe9997c7067515907-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9997c7067515907-10">10</div><div class="crayon-num" data-line="crayon-5baa9fe9997c7067515907-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9997c7067515907-12">12</div><div class="crayon-num" data-line="crayon-5baa9fe9997c7067515907-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9997c7067515907-14">14</div><div class="crayon-num" data-line="crayon-5baa9fe9997c7067515907-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9997c7067515907-16">16</div><div class="crayon-num" data-line="crayon-5baa9fe9997c7067515907-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9997c7067515907-18">18</div><div class="crayon-num" data-line="crayon-5baa9fe9997c7067515907-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9997c7067515907-20">20</div><div class="crayon-num" data-line="crayon-5baa9fe9997c7067515907-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9997c7067515907-22">22</div><div class="crayon-num" data-line="crayon-5baa9fe9997c7067515907-23">23</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe9997c7067515907-1"><span class="crayon-c"># import the necessary packages</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9997c7067515907-2"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">numpy </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">np</span></div><div class="crayon-line" id="crayon-5baa9fe9997c7067515907-3"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">argparse</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9997c7067515907-4"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">imutils</span></div><div class="crayon-line" id="crayon-5baa9fe9997c7067515907-5"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">pickle</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9997c7067515907-6"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">cv2</span></div><div class="crayon-line" id="crayon-5baa9fe9997c7067515907-7"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">os</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9997c7067515907-8">&nbsp;</div><div class="crayon-line" id="crayon-5baa9fe9997c7067515907-9"><span class="crayon-c"># construct the argument parser and parse the arguments</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9997c7067515907-10"><span class="crayon-v">ap</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">argparse</span><span class="crayon-sy">.</span><span class="crayon-e">ArgumentParser</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9997c7067515907-11"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-i"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--image"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9997c7067515907-12"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"path to input image"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9997c7067515907-13"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-d"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--detector"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9997c7067515907-14"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"path to OpenCV's deep learning face detector"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9997c7067515907-15"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-m"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--embedding-model"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9997c7067515907-16"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"path to OpenCV's deep learning face embedding model"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9997c7067515907-17"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-r"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--recognizer"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9997c7067515907-18"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"path to model trained to recognize faces"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9997c7067515907-19"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-l"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--le"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9997c7067515907-20"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"path to label encoder"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9997c7067515907-21"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-c"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--confidence"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">type</span><span class="crayon-o">=</span><span class="crayon-k ">float</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">default</span><span class="crayon-o">=</span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9997c7067515907-22"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"minimum probability to filter weak detections"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9997c7067515907-23"><span class="crayon-v">args</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">vars</span><span class="crayon-sy">(</span><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">parse_args</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0041 seconds] -->
<p>We 
			<span id="crayon-5baa9fe9997cc727808588" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-r">import</span></span></span>&nbsp; our required packages on&nbsp;<strong>Lines 2-7</strong>. At this point, you should have each of these packages installed.</p>
<p>Our six command line arguments are parsed on&nbsp;<strong>Lines 10-23</strong>:</p>
<ul>
<li>
			<span id="crayon-5baa9fe9997d1425564653" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-o">--</span><span class="crayon-v">image</span></span></span>&nbsp;: The path to the input image. We will attempt to recognize the faces in this image.</li>
<li>
			<span id="crayon-5baa9fe9997d6587333742" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-o">--</span><span class="crayon-v">detector</span></span></span>&nbsp;: The path to OpenCV’s deep learning face detector. We’ll use this model to&nbsp;<em>detect</em> where in the image the face ROIs are.</li>
<li>
			<span id="crayon-5baa9fe9997db712132572" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-o">--</span><span class="crayon-v">embedding</span><span class="crayon-o">-</span><span class="crayon-v">model</span></span></span>&nbsp;: The path to OpenCV’s deep learning face embedding model. We’ll use this model to <em>extract</em> the 128-D face embedding from the face ROI — we’ll feed the data into the recognizer.</li>
<li>
			<span id="crayon-5baa9fe9997e7629071256" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-o">--</span><span class="crayon-v">recognizer</span></span></span>&nbsp;: The path to our recognizer model. We trained our SVM recognizer in&nbsp;<strong>Step #2</strong>. This is what will actually&nbsp;<em>determine who</em> a face is.</li>
<li>
			<span id="crayon-5baa9fe9997ec256469946" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-o">--</span><span class="crayon-v">le</span></span></span>&nbsp;: The path to our label encoder. This contains our face labels such as 
			<span id="crayon-5baa9fe9997f1069479874" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-s">'adrian'</span></span></span>&nbsp; or 
			<span id="crayon-5baa9fe9997f6096809105" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-s">'trisha'</span></span></span>&nbsp;.</li>
<li>
			<span id="crayon-5baa9fe9997fa734780523" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-o">--</span><span class="crayon-v">confidence</span></span></span>&nbsp;: The optional threshold to filter weak face <em>detections</em>.</li>
</ul>
<p>Be sure to study these command line arguments — it is important to know the difference between the two deep learning models and the SVM model. If you find yourself confused later in this script, you should refer back to here.</p>
<p>Now that we’ve handled our imports and command line arguments, let’s load the three models from disk into memory:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe9997ff077271356" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># load our serialized face detector from disk
print("[INFO] loading face detector...")
protoPath = os.path.sep.join([args["detector"], "deploy.prototxt"])
modelPath = os.path.sep.join([args["detector"],
	"res10_300x300_ssd_iter_140000.caffemodel"])
detector = cv2.dnn.readNetFromCaffe(protoPath, modelPath)

# load our serialized face embedding model from disk
print("[INFO] loading face recognizer...")
embedder = cv2.dnn.readNetFromTorch(args["embedding_model"])

# load the actual face recognition model along with the label encoder
recognizer = pickle.loads(open(args["recognizer"], "rb").read())
le = pickle.loads(open(args["le"], "rb").read())</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe9997ff077271356-25">25</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9997ff077271356-26">26</div><div class="crayon-num" data-line="crayon-5baa9fe9997ff077271356-27">27</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9997ff077271356-28">28</div><div class="crayon-num" data-line="crayon-5baa9fe9997ff077271356-29">29</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9997ff077271356-30">30</div><div class="crayon-num" data-line="crayon-5baa9fe9997ff077271356-31">31</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9997ff077271356-32">32</div><div class="crayon-num" data-line="crayon-5baa9fe9997ff077271356-33">33</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9997ff077271356-34">34</div><div class="crayon-num" data-line="crayon-5baa9fe9997ff077271356-35">35</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9997ff077271356-36">36</div><div class="crayon-num" data-line="crayon-5baa9fe9997ff077271356-37">37</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9997ff077271356-38">38</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe9997ff077271356-25"><span class="crayon-c"># load our serialized face detector from disk</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9997ff077271356-26"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"[INFO] loading face detector..."</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9997ff077271356-27"><span class="crayon-v">protoPath</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">os.path</span><span class="crayon-sy">.</span><span class="crayon-v">sep</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"detector"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"deploy.prototxt"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9997ff077271356-28"><span class="crayon-v">modelPath</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">os.path</span><span class="crayon-sy">.</span><span class="crayon-v">sep</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"detector"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5baa9fe9997ff077271356-29"><span class="crayon-h">	</span><span class="crayon-s">"res10_300x300_ssd_iter_140000.caffemodel"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9997ff077271356-30"><span class="crayon-v">detector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">dnn</span><span class="crayon-sy">.</span><span class="crayon-e">readNetFromCaffe</span><span class="crayon-sy">(</span><span class="crayon-v">protoPath</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">modelPath</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9997ff077271356-31">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9997ff077271356-32"><span class="crayon-c"># load our serialized face embedding model from disk</span></div><div class="crayon-line" id="crayon-5baa9fe9997ff077271356-33"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"[INFO] loading face recognizer..."</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9997ff077271356-34"><span class="crayon-v">embedder</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">dnn</span><span class="crayon-sy">.</span><span class="crayon-e">readNetFromTorch</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"embedding_model"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9997ff077271356-35">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9997ff077271356-36"><span class="crayon-c"># load the actual face recognition model along with the label encoder</span></div><div class="crayon-line" id="crayon-5baa9fe9997ff077271356-37"><span class="crayon-v">recognizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">pickle</span><span class="crayon-sy">.</span><span class="crayon-e">loads</span><span class="crayon-sy">(</span><span class="crayon-k ">open</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"recognizer"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"rb"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9997ff077271356-38"><span class="crayon-v">le</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">pickle</span><span class="crayon-sy">.</span><span class="crayon-e">loads</span><span class="crayon-sy">(</span><span class="crayon-k ">open</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"le"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"rb"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0032 seconds] -->
<p>We load three models in this block. At the risk of being redundant, I want to explicitly remind you of the differences&nbsp;among the models:</p>
<ol>
<li>
			<span id="crayon-5baa9fe999805835529069" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">detector</span></span></span>&nbsp;: A <em>pre-trained</em> Caffe DL model to <em>detect where in the image the faces are</em> (<strong>Lines 27-30</strong>).</li>
<li>
			<span id="crayon-5baa9fe99980a951049311" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">embedder</span></span></span>&nbsp;: A <em>pre-trained</em>&nbsp;Torch DL model to <em>calculate our 128-D face embeddings</em> (<strong>Line 34</strong>).</li>
<li>
			<span id="crayon-5baa9fe99980f310111459" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">recognizer</span></span></span>&nbsp;: Our Linear SVM <em>face recognition</em> model (<strong>Line 37</strong>).&nbsp;We trained this model in&nbsp;<strong>Step 2</strong>.</li>
</ol>
<p>Both 1 &amp; 2 are&nbsp;<em>pre-trained</em> meaning that they are provided to you as-is by OpenCV. They are buried in the OpenCV project on GitHub, but I’ve included them for your convenience in the&nbsp;<em><strong>“Downloads”</strong></em> section of today’s post. I’ve also numbered the models in the order that we’ll apply them to recognize faces with OpenCV.</p>
<p>We also load our label encoder which holds the names of the people our model can recognize (<strong>Line 38</strong>).</p>
<p>Now let’s load our image and&nbsp;<em>detect</em> faces:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe999814698327628" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># load the image, resize it to have a width of 600 pixels (while
# maintaining the aspect ratio), and then grab the image dimensions
image = cv2.imread(args["image"])
image = imutils.resize(image, width=600)
(h, w) = image.shape[:2]

# construct a blob from the image
imageBlob = cv2.dnn.blobFromImage(
	cv2.resize(image, (300, 300)), 1.0, (300, 300),
	(104.0, 177.0, 123.0), swapRB=False, crop=False)

# apply OpenCV's deep learning-based face detector to localize
# faces in the input image
detector.setInput(imageBlob)
detections = detector.forward()</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe999814698327628-40">40</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999814698327628-41">41</div><div class="crayon-num" data-line="crayon-5baa9fe999814698327628-42">42</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999814698327628-43">43</div><div class="crayon-num" data-line="crayon-5baa9fe999814698327628-44">44</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999814698327628-45">45</div><div class="crayon-num" data-line="crayon-5baa9fe999814698327628-46">46</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999814698327628-47">47</div><div class="crayon-num" data-line="crayon-5baa9fe999814698327628-48">48</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999814698327628-49">49</div><div class="crayon-num" data-line="crayon-5baa9fe999814698327628-50">50</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999814698327628-51">51</div><div class="crayon-num" data-line="crayon-5baa9fe999814698327628-52">52</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999814698327628-53">53</div><div class="crayon-num" data-line="crayon-5baa9fe999814698327628-54">54</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe999814698327628-40"><span class="crayon-c"># load the image, resize it to have a width of 600 pixels (while</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999814698327628-41"><span class="crayon-c"># maintaining the aspect ratio), and then grab the image dimensions</span></div><div class="crayon-line" id="crayon-5baa9fe999814698327628-42"><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imread</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"image"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999814698327628-43"><span class="crayon-v">image</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">imutils</span><span class="crayon-sy">.</span><span class="crayon-e">resize</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-o">=</span><span class="crayon-cn">600</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe999814698327628-44"><span class="crayon-sy">(</span><span class="crayon-v">h</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">w</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999814698327628-45">&nbsp;</div><div class="crayon-line" id="crayon-5baa9fe999814698327628-46"><span class="crayon-c"># construct a blob from the image</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999814698327628-47"><span class="crayon-v">imageBlob</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">dnn</span><span class="crayon-sy">.</span><span class="crayon-e">blobFromImage</span><span class="crayon-sy">(</span></div><div class="crayon-line" id="crayon-5baa9fe999814698327628-48"><span class="crayon-h">	</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">resize</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">300</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">300</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">300</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">300</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999814698327628-49"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-cn">104.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">177.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">123.0</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">swapRB</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">crop</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe999814698327628-50">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999814698327628-51"><span class="crayon-c"># apply OpenCV's deep learning-based face detector to localize</span></div><div class="crayon-line" id="crayon-5baa9fe999814698327628-52"><span class="crayon-c"># faces in the input image</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999814698327628-53"><span class="crayon-v">detector</span><span class="crayon-sy">.</span><span class="crayon-e">setInput</span><span class="crayon-sy">(</span><span class="crayon-v">imageBlob</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe999814698327628-54"><span class="crayon-v">detections</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">detector</span><span class="crayon-sy">.</span><span class="crayon-e">forward</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0034 seconds] -->
<p>Here we:</p>
<ul>
<li>Load the image into memory and construct a blob (<strong>Lines 42-49</strong>). Learn about&nbsp;
			<span id="crayon-5baa9fe999819944646509" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">dnn</span><span class="crayon-sy">.</span><span class="crayon-v">blobFromImage</span></span></span>&nbsp; <a href="https://www.pyimagesearch.com/2017/11/06/deep-learning-opencvs-blobfromimage-works/" target="_blank" rel="noopener">here</a>.</li>
<li>Localize faces in the image via our 
			<span id="crayon-5baa9fe99981e840531424" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">detector</span></span></span>&nbsp; (<strong>Lines 53 and 54</strong>).</li>
</ul>
<p>Given our new 
			<span id="crayon-5baa9fe999823455302702" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">detections</span></span></span>&nbsp;, let’s recognize faces in the image. But first we need to filter weak 
			<span id="crayon-5baa9fe999827852839791" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">detections</span></span></span>&nbsp; and extract the 
			<span id="crayon-5baa9fe99982c342698501" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">face</span></span></span>&nbsp; ROI:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe999831518113587" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># loop over the detections
for i in range(0, detections.shape[2]):
	# extract the confidence (i.e., probability) associated with the
	# prediction
	confidence = detections[0, 0, i, 2]

	# filter out weak detections
	if confidence &gt; args["confidence"]:
		# compute the (x, y)-coordinates of the bounding box for the
		# face
		box = detections[0, 0, i, 3:7] * np.array([w, h, w, h])
		(startX, startY, endX, endY) = box.astype("int")

		# extract the face ROI
		face = image[startY:endY, startX:endX]
		(fH, fW) = face.shape[:2]

		# ensure the face width and height are sufficiently large
		if fW &lt; 20 or fH &lt; 20:
			continue</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe999831518113587-56">56</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999831518113587-57">57</div><div class="crayon-num" data-line="crayon-5baa9fe999831518113587-58">58</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999831518113587-59">59</div><div class="crayon-num" data-line="crayon-5baa9fe999831518113587-60">60</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999831518113587-61">61</div><div class="crayon-num" data-line="crayon-5baa9fe999831518113587-62">62</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999831518113587-63">63</div><div class="crayon-num" data-line="crayon-5baa9fe999831518113587-64">64</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999831518113587-65">65</div><div class="crayon-num" data-line="crayon-5baa9fe999831518113587-66">66</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999831518113587-67">67</div><div class="crayon-num" data-line="crayon-5baa9fe999831518113587-68">68</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999831518113587-69">69</div><div class="crayon-num" data-line="crayon-5baa9fe999831518113587-70">70</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999831518113587-71">71</div><div class="crayon-num" data-line="crayon-5baa9fe999831518113587-72">72</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999831518113587-73">73</div><div class="crayon-num" data-line="crayon-5baa9fe999831518113587-74">74</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999831518113587-75">75</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe999831518113587-56"><span class="crayon-c"># loop over the detections</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999831518113587-57"><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">detections</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5baa9fe999831518113587-58"><span class="crayon-h">	</span><span class="crayon-c"># extract the confidence (i.e., probability) associated with the</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999831518113587-59"><span class="crayon-h">	</span><span class="crayon-c"># prediction</span></div><div class="crayon-line" id="crayon-5baa9fe999831518113587-60"><span class="crayon-h">	</span><span class="crayon-v">confidence</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">detections</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999831518113587-61">&nbsp;</div><div class="crayon-line" id="crayon-5baa9fe999831518113587-62"><span class="crayon-h">	</span><span class="crayon-c"># filter out weak detections</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999831518113587-63"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">confidence</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"confidence"</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5baa9fe999831518113587-64"><span class="crayon-h">		</span><span class="crayon-c"># compute the (x, y)-coordinates of the bounding box for the</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999831518113587-65"><span class="crayon-h">		</span><span class="crayon-c"># face</span></div><div class="crayon-line" id="crayon-5baa9fe999831518113587-66"><span class="crayon-h">		</span><span class="crayon-v">box</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">detections</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-o">:</span><span class="crayon-cn">7</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-k ">w</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">h</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">w</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">h</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999831518113587-67"><span class="crayon-h">		</span><span class="crayon-sy">(</span><span class="crayon-v">startX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">startY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">endX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">endY</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">box</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">"int"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe999831518113587-68">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999831518113587-69"><span class="crayon-h">		</span><span class="crayon-c"># extract the face ROI</span></div><div class="crayon-line" id="crayon-5baa9fe999831518113587-70"><span class="crayon-h">		</span><span class="crayon-v">face</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">[</span><span class="crayon-v">startY</span><span class="crayon-o">:</span><span class="crayon-v">endY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">startX</span><span class="crayon-o">:</span><span class="crayon-v">endX</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999831518113587-71"><span class="crayon-h">		</span><span class="crayon-sy">(</span><span class="crayon-v">fH</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fW</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">face</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5baa9fe999831518113587-72">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999831518113587-73"><span class="crayon-h">		</span><span class="crayon-c"># ensure the face width and height are sufficiently large</span></div><div class="crayon-line" id="crayon-5baa9fe999831518113587-74"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">fW</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-v">fH</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999831518113587-75"><span class="crayon-h">			</span><span class="crayon-st">continue</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0046 seconds] -->
<p>You’ll recognize this block from&nbsp;<strong>Step #1</strong>. I’ll explain it here once more:</p>
<ul>
<li>We loop over the 
			<span id="crayon-5baa9fe999836775075208" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">detections</span></span></span>&nbsp; on&nbsp;<strong>Line 57</strong> and extract the 
			<span id="crayon-5baa9fe99983b127421369" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">confidence</span></span></span>&nbsp; of each on&nbsp;<strong>Line 60</strong>.</li>
<li>Then we compare the 
			<span id="crayon-5baa9fe999840097564401" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">confidence</span></span></span>&nbsp; to the minimum probability detection threshold contained in our command line 
			<span id="crayon-5baa9fe999845720779706" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">args</span></span></span>&nbsp; dictionary, ensuring that the computed probability is larger than the minimum probability (<strong>Line 63</strong>).</li>
<li>From there, we extract the 
			<span id="crayon-5baa9fe999849949012121" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">face</span></span></span>&nbsp; ROI (<strong>Lines 66-70</strong>) as well as ensure it’s spatial dimensions are sufficiently large (<strong>Lines 74 and 75</strong>).</li>
</ul>
<p>Recognizing the name of the 
			<span id="crayon-5baa9fe99984e711836282" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">face</span></span></span>&nbsp; ROI requires just a few steps:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe999853026429925" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">		# construct a blob for the face ROI, then pass the blob
		# through our face embedding model to obtain the 128-d
		# quantification of the face
		faceBlob = cv2.dnn.blobFromImage(face, 1.0 / 255, (96, 96),
			(0, 0, 0), swapRB=True, crop=False)
		embedder.setInput(faceBlob)
		vec = embedder.forward()

		# perform classification to recognize the face
		preds = recognizer.predict_proba(vec)[0]
		j = np.argmax(preds)
		proba = preds[j]
		name = le.classes_[j]</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe999853026429925-77">77</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999853026429925-78">78</div><div class="crayon-num" data-line="crayon-5baa9fe999853026429925-79">79</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999853026429925-80">80</div><div class="crayon-num" data-line="crayon-5baa9fe999853026429925-81">81</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999853026429925-82">82</div><div class="crayon-num" data-line="crayon-5baa9fe999853026429925-83">83</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999853026429925-84">84</div><div class="crayon-num" data-line="crayon-5baa9fe999853026429925-85">85</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999853026429925-86">86</div><div class="crayon-num" data-line="crayon-5baa9fe999853026429925-87">87</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999853026429925-88">88</div><div class="crayon-num" data-line="crayon-5baa9fe999853026429925-89">89</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe999853026429925-77"><span class="crayon-h">		</span><span class="crayon-c"># construct a blob for the face ROI, then pass the blob</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999853026429925-78"><span class="crayon-h">		</span><span class="crayon-c"># through our face embedding model to obtain the 128-d</span></div><div class="crayon-line" id="crayon-5baa9fe999853026429925-79"><span class="crayon-h">		</span><span class="crayon-c"># quantification of the face</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999853026429925-80"><span class="crayon-h">		</span><span class="crayon-v">faceBlob</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">dnn</span><span class="crayon-sy">.</span><span class="crayon-e">blobFromImage</span><span class="crayon-sy">(</span><span class="crayon-v">face</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">96</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">96</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5baa9fe999853026429925-81"><span class="crayon-h">			</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">swapRB</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">crop</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999853026429925-82"><span class="crayon-h">		</span><span class="crayon-v">embedder</span><span class="crayon-sy">.</span><span class="crayon-e">setInput</span><span class="crayon-sy">(</span><span class="crayon-v">faceBlob</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe999853026429925-83"><span class="crayon-h">		</span><span class="crayon-v">vec</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">embedder</span><span class="crayon-sy">.</span><span class="crayon-e">forward</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999853026429925-84">&nbsp;</div><div class="crayon-line" id="crayon-5baa9fe999853026429925-85"><span class="crayon-h">		</span><span class="crayon-c"># perform classification to recognize the face</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999853026429925-86"><span class="crayon-h">		</span><span class="crayon-v">preds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">recognizer</span><span class="crayon-sy">.</span><span class="crayon-e">predict_proba</span><span class="crayon-sy">(</span><span class="crayon-v">vec</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5baa9fe999853026429925-87"><span class="crayon-h">		</span><span class="crayon-v">j</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">argmax</span><span class="crayon-sy">(</span><span class="crayon-v">preds</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999853026429925-88"><span class="crayon-h">		</span><span class="crayon-v">proba</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">preds</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5baa9fe999853026429925-89"><span class="crayon-h">		</span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">le</span><span class="crayon-sy">.</span><span class="crayon-v">classes_</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0031 seconds] -->
<p>First, we construct a 
			<span id="crayon-5baa9fe999858282231837" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">faceBlob</span></span></span>&nbsp; (from the 
			<span id="crayon-5baa9fe99985d365966326" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">face</span></span></span>&nbsp; ROI) and pass it through the 
			<span id="crayon-5baa9fe999861076612603" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">embedder</span></span></span>&nbsp; to generate a 128-D vector which describes the face (<strong>Lines 80-83</strong>)</p>
<p>Then, we pass the 
			<span id="crayon-5baa9fe999866886513825" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">vec</span></span></span>&nbsp; through our SVM recognizer model (<strong>Line 86</strong>), the result of which is our predictions for&nbsp;<em>who</em> is in the face ROI.</p>
<p>We take the highest probability index (<strong>Line 87</strong>) and query our label encoder to find the 
			<span id="crayon-5baa9fe99986b387482545" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">name</span></span></span>&nbsp; (<strong>Line 89</strong>). In between, I extract the probability on&nbsp;<strong>Line 88</strong>.</p>
<p><em><strong>Note:&nbsp;</strong>You cam further filter out weak face recognitions by applying an additional threshold test on the probability. For example, inserting 
			<span id="crayon-5baa9fe999870652926543" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">proba</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-v">T</span></span></span>&nbsp; (where 
			<span id="crayon-5baa9fe999874716975093" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">T</span></span></span>&nbsp; is a variable you define) can provide an additional layer of filtering to ensure there are less false-positive face recognitions.</em></p>
<p>Now, let’s display OpenCV face recognition results:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe999879990865219" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">		# draw the bounding box of the face along with the associated
		# probability
		text = "{}: {:.2f}%".format(name, proba * 100)
		y = startY - 10 if startY - 10 &gt; 10 else startY + 10
		cv2.rectangle(image, (startX, startY), (endX, endY),
			(0, 0, 255), 2)
		cv2.putText(image, text, (startX, y),
			cv2.FONT_HERSHEY_SIMPLEX, 0.45, (0, 0, 255), 2)

# show the output image
cv2.imshow("Image", image)
cv2.waitKey(0)</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe999879990865219-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999879990865219-92">92</div><div class="crayon-num" data-line="crayon-5baa9fe999879990865219-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999879990865219-94">94</div><div class="crayon-num" data-line="crayon-5baa9fe999879990865219-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999879990865219-96">96</div><div class="crayon-num" data-line="crayon-5baa9fe999879990865219-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999879990865219-98">98</div><div class="crayon-num" data-line="crayon-5baa9fe999879990865219-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999879990865219-100">100</div><div class="crayon-num" data-line="crayon-5baa9fe999879990865219-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999879990865219-102">102</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe999879990865219-91"><span class="crayon-h">		</span><span class="crayon-c"># draw the bounding box of the face along with the associated</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999879990865219-92"><span class="crayon-h">		</span><span class="crayon-c"># probability</span></div><div class="crayon-line" id="crayon-5baa9fe999879990865219-93"><span class="crayon-h">		</span><span class="crayon-v">text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"{}: {:.2f}%"</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">proba</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999879990865219-94"><span class="crayon-h">		</span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">startY</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">startY</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-v">startY</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">10</span></div><div class="crayon-line" id="crayon-5baa9fe999879990865219-95"><span class="crayon-h">		</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">rectangle</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">startX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">startY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">endX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">endY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999879990865219-96"><span class="crayon-h">			</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe999879990865219-97"><span class="crayon-h">		</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">putText</span><span class="crayon-sy">(</span><span class="crayon-v">image</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">text</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">startX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999879990865219-98"><span class="crayon-h">			</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">FONT_HERSHEY_SIMPLEX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.45</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe999879990865219-99">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999879990865219-100"><span class="crayon-c"># show the output image</span></div><div class="crayon-line" id="crayon-5baa9fe999879990865219-101"><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-s">"Image"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">image</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999879990865219-102"><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">waitKey</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0037 seconds] -->
<p>For every face we recognize in the loop (including the “unknown”) people:</p>
<ul>
<li>We construct a 
			<span id="crayon-5baa9fe99987e919135238" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">text</span></span></span>&nbsp; string containing the 
			<span id="crayon-5baa9fe999883725326600" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">name</span></span></span>&nbsp; and probability on <strong>Line 93</strong>.</li>
<li>And then we draw a rectangle around the face and place the text above the box (<strong>Lines 94-98</strong>).</li>
</ul>
<p>And then finally we visualize the results on the screen until a key is pressed (<strong>Lines 101 and 102</strong>).</p>
<p>It is time to recognize faces in images with OpenCV!</p>
<p>To apply our OpenCV face recognition pipeline to my provided images (or your own dataset + test images), make sure you use the <em><strong>“Downloads”</strong></em> section of the blog post to download the code, trained models, and example images.</p>
<p>From there, open up a terminal and execute the following command:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe999888393577266" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important; margin-top: -18px; display: none;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">$ python recognize.py --detector face_detection_model \
	--embedding-model openface_nn4.small2.v1.t7 \
	--recognizer output/recognizer.pickle \
	--le output/le.pickle \
	--image images/adrian.jpg
[INFO] loading face detector...
[INFO] loading face recognizer...</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe999888393577266-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999888393577266-2">2</div><div class="crayon-num" data-line="crayon-5baa9fe999888393577266-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999888393577266-4">4</div><div class="crayon-num" data-line="crayon-5baa9fe999888393577266-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999888393577266-6">6</div><div class="crayon-num" data-line="crayon-5baa9fe999888393577266-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe999888393577266-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">python </span><span class="crayon-v">recognize</span><span class="crayon-e">.py</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-e">detector </span><span class="crayon-v">face_detection</span><span class="crayon-sy">_</span>model<span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999888393577266-2"><span class="crayon-h">	</span><span class="crayon-o">--</span><span class="crayon-v">embedding</span><span class="crayon-o">-</span><span class="crayon-e">model </span><span class="crayon-v">openface_nn4</span><span class="crayon-e">.small2</span><span class="crayon-e">.v1</span><span class="crayon-e">.t7</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line" id="crayon-5baa9fe999888393577266-3"><span class="crayon-h">	</span><span class="crayon-o">--</span><span class="crayon-e">recognizer </span><span class="crayon-v">output</span><span class="crayon-o">/</span><span class="crayon-v">recognizer</span><span class="crayon-e">.pickle</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999888393577266-4"><span class="crayon-h">	</span><span class="crayon-o">--</span><span class="crayon-e">le </span><span class="crayon-v">output</span><span class="crayon-o">/</span><span class="crayon-v">le</span><span class="crayon-e">.pickle</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line" id="crayon-5baa9fe999888393577266-5"><span class="crayon-h">	</span><span class="crayon-o">--</span><span class="crayon-e">image </span><span class="crayon-v">images</span><span class="crayon-o">/</span><span class="crayon-v">adrian</span><span class="crayon-e">.jpg</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999888393577266-6"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">loading </span><span class="crayon-e">face </span><span class="crayon-v">detector</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5baa9fe999888393577266-7"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">loading </span><span class="crayon-e">face </span><span class="crayon-v">recognizer</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0018 seconds] -->
<p></p><div id="attachment_8745" style="max-width: 510px" class="wp-caption aligncenter"><a href="./OpenCV Face Recognition - PyImageSearch_files/opencv_face_reco_result01.jpg"><img class="wp-image-8745" src="./OpenCV Face Recognition - PyImageSearch_files/opencv_face_reco_result01.jpg" alt="" width="500" height="663" srcset="https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_result01.jpg 600w, https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_result01-226x300.jpg 226w" sizes="(max-width: 500px) 100vw, 500px"></a><p class="wp-caption-text"><strong>Figure 4:</strong> OpenCV face recognition has recognized <em>me</em> at the <a href="https://www.imdb.com/title/tt4881806/" target="_blank" rel="noopener"><em>Jurassic World: Fallen Kingdom</em></a> movie showing.</p></div><p></p>
<p>Here you can see me sipping on a beer and sporting one of my favorite&nbsp;<em>Jurassic Park&nbsp;</em>shirts, along with a special&nbsp;<em>Jurassic World</em> pint glass and commemorative book. My face prediction only has 47.15% confidence; however, that confidence is higher than the&nbsp;<em>“Unknown”</em> class.</p>
<p>Let’s try another OpenCV face recognition example:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe99988d198031960" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">$ python recognize.py --detector face_detection_model \
	--embedding-model openface_nn4.small2.v1.t7 \
	--recognizer output/recognizer.pickle \
	--le output/le.pickle \
	--image images/trisha_adrian.jpg 
[INFO] loading face detector...
[INFO] loading face recognizer...</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe99988d198031960-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe99988d198031960-2">2</div><div class="crayon-num" data-line="crayon-5baa9fe99988d198031960-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe99988d198031960-4">4</div><div class="crayon-num" data-line="crayon-5baa9fe99988d198031960-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe99988d198031960-6">6</div><div class="crayon-num" data-line="crayon-5baa9fe99988d198031960-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe99988d198031960-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">python </span><span class="crayon-v">recognize</span><span class="crayon-e">.py</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-e">detector </span><span class="crayon-v">face_detection</span><span class="crayon-sy">_</span>model<span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe99988d198031960-2"><span class="crayon-h">	</span><span class="crayon-o">--</span><span class="crayon-v">embedding</span><span class="crayon-o">-</span><span class="crayon-e">model </span><span class="crayon-v">openface_nn4</span><span class="crayon-e">.small2</span><span class="crayon-e">.v1</span><span class="crayon-e">.t7</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line" id="crayon-5baa9fe99988d198031960-3"><span class="crayon-h">	</span><span class="crayon-o">--</span><span class="crayon-e">recognizer </span><span class="crayon-v">output</span><span class="crayon-o">/</span><span class="crayon-v">recognizer</span><span class="crayon-e">.pickle</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe99988d198031960-4"><span class="crayon-h">	</span><span class="crayon-o">--</span><span class="crayon-e">le </span><span class="crayon-v">output</span><span class="crayon-o">/</span><span class="crayon-v">le</span><span class="crayon-e">.pickle</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line" id="crayon-5baa9fe99988d198031960-5"><span class="crayon-h">	</span><span class="crayon-o">--</span><span class="crayon-e">image </span><span class="crayon-v">images</span><span class="crayon-o">/</span><span class="crayon-v">trisha_adrian</span><span class="crayon-e">.jpg</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe99988d198031960-6"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">loading </span><span class="crayon-e">face </span><span class="crayon-v">detector</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5baa9fe99988d198031960-7"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">loading </span><span class="crayon-e">face </span><span class="crayon-v">recognizer</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0017 seconds] -->
<p></p><div id="attachment_8746" style="max-width: 510px" class="wp-caption aligncenter"><a href="./OpenCV Face Recognition - PyImageSearch_files/opencv_face_reco_result02.jpg"><img class="wp-image-8746" src="./OpenCV Face Recognition - PyImageSearch_files/opencv_face_reco_result02.jpg" alt="" width="500" height="663" srcset="https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_result02.jpg 600w, https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_result02-226x300.jpg 226w" sizes="(max-width: 500px) 100vw, 500px"></a><p class="wp-caption-text"><strong>Figure 5:</strong> My wife, Trisha, and I are recognized in a selfie picture on an airplane with OpenCV + deep learning facial recognition.</p></div><p></p>
<p>Here are Trisha and I, ready to start our vacation!</p>
<p>In a final example, let’s look at what happens when our model is unable to recognize the actual face:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe999893567367266" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">$ python recognize.py --detector face_detection_model \
	--embedding-model openface_nn4.small2.v1.t7 \
	--recognizer output/recognizer.pickle \
	--le output/le.pickle \
	--image images/patrick_bateman.jpg 
[INFO] loading face detector...
[INFO] loading face recognizer...</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe999893567367266-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999893567367266-2">2</div><div class="crayon-num" data-line="crayon-5baa9fe999893567367266-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999893567367266-4">4</div><div class="crayon-num" data-line="crayon-5baa9fe999893567367266-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999893567367266-6">6</div><div class="crayon-num" data-line="crayon-5baa9fe999893567367266-7">7</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe999893567367266-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">python </span><span class="crayon-v">recognize</span><span class="crayon-e">.py</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-e">detector </span><span class="crayon-v">face_detection</span><span class="crayon-sy">_</span>model<span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999893567367266-2"><span class="crayon-h">	</span><span class="crayon-o">--</span><span class="crayon-v">embedding</span><span class="crayon-o">-</span><span class="crayon-e">model </span><span class="crayon-v">openface_nn4</span><span class="crayon-e">.small2</span><span class="crayon-e">.v1</span><span class="crayon-e">.t7</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line" id="crayon-5baa9fe999893567367266-3"><span class="crayon-h">	</span><span class="crayon-o">--</span><span class="crayon-e">recognizer </span><span class="crayon-v">output</span><span class="crayon-o">/</span><span class="crayon-v">recognizer</span><span class="crayon-e">.pickle</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999893567367266-4"><span class="crayon-h">	</span><span class="crayon-o">--</span><span class="crayon-e">le </span><span class="crayon-v">output</span><span class="crayon-o">/</span><span class="crayon-v">le</span><span class="crayon-e">.pickle</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line" id="crayon-5baa9fe999893567367266-5"><span class="crayon-h">	</span><span class="crayon-o">--</span><span class="crayon-e">image </span><span class="crayon-v">images</span><span class="crayon-o">/</span><span class="crayon-v">patrick_bateman</span><span class="crayon-e">.jpg</span><span class="crayon-h"> </span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999893567367266-6"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">loading </span><span class="crayon-e">face </span><span class="crayon-v">detector</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5baa9fe999893567367266-7"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">loading </span><span class="crayon-e">face </span><span class="crayon-v">recognizer</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0017 seconds] -->
<p></p><div id="attachment_8747" style="max-width: 510px" class="wp-caption aligncenter"><a href="./OpenCV Face Recognition - PyImageSearch_files/opencv_face_reco_result03.jpg"><img class="wp-image-8747" src="./OpenCV Face Recognition - PyImageSearch_files/opencv_face_reco_result03.jpg" alt="" width="500" height="516" srcset="https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_result03.jpg 600w, https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_result03-291x300.jpg 291w" sizes="(max-width: 500px) 100vw, 500px"></a><p class="wp-caption-text"><strong>Figure 6:</strong> Facial recognition with OpenCV has determined that this person is “unknown”.</p></div><p></p>
<p>The third image is an example of an “unknown” person who is actually Patrick Bateman from <a href="https://www.imdb.com/title/tt0144084/" target="_blank" rel="noopener"><em>American Psycho</em></a> — believe me, this is not a person you would want to see show up in your images or video streams!</p>
<h3>BONUS: Recognize faces in video streams</h3>
<p>As a bonus, I decided to include a section dedicated to OpenCV face recognition in video streams!</p>
<p>The actual pipeline itself is near identical to recognizing faces in images, with only a few updates which we’ll review along the way.</p>
<p>Open up the 
			<span id="crayon-5baa9fe999899591564695" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">recognize_video</span><span class="crayon-e">.py</span></span></span>&nbsp; file and let’s get started:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe99989e039202042" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># import the necessary packages
from imutils.video import VideoStream
from imutils.video import FPS
import numpy as np
import argparse
import imutils
import pickle
import time
import cv2
import os

# construct the argument parser and parse the arguments
ap = argparse.ArgumentParser()
ap.add_argument("-d", "--detector", required=True,
	help="path to OpenCV's deep learning face detector")
ap.add_argument("-m", "--embedding-model", required=True,
	help="path to OpenCV's deep learning face embedding model")
ap.add_argument("-r", "--recognizer", required=True,
	help="path to model trained to recognize faces")
ap.add_argument("-l", "--le", required=True,
	help="path to label encoder")
ap.add_argument("-c", "--confidence", type=float, default=0.5,
	help="minimum probability to filter weak detections")
args = vars(ap.parse_args())</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe99989e039202042-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe99989e039202042-2">2</div><div class="crayon-num" data-line="crayon-5baa9fe99989e039202042-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe99989e039202042-4">4</div><div class="crayon-num" data-line="crayon-5baa9fe99989e039202042-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe99989e039202042-6">6</div><div class="crayon-num" data-line="crayon-5baa9fe99989e039202042-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe99989e039202042-8">8</div><div class="crayon-num" data-line="crayon-5baa9fe99989e039202042-9">9</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe99989e039202042-10">10</div><div class="crayon-num" data-line="crayon-5baa9fe99989e039202042-11">11</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe99989e039202042-12">12</div><div class="crayon-num" data-line="crayon-5baa9fe99989e039202042-13">13</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe99989e039202042-14">14</div><div class="crayon-num" data-line="crayon-5baa9fe99989e039202042-15">15</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe99989e039202042-16">16</div><div class="crayon-num" data-line="crayon-5baa9fe99989e039202042-17">17</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe99989e039202042-18">18</div><div class="crayon-num" data-line="crayon-5baa9fe99989e039202042-19">19</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe99989e039202042-20">20</div><div class="crayon-num" data-line="crayon-5baa9fe99989e039202042-21">21</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe99989e039202042-22">22</div><div class="crayon-num" data-line="crayon-5baa9fe99989e039202042-23">23</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe99989e039202042-24">24</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe99989e039202042-1"><span class="crayon-c"># import the necessary packages</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe99989e039202042-2"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">imutils</span><span class="crayon-sy">.</span><span class="crayon-e">video </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">VideoStream</span></div><div class="crayon-line" id="crayon-5baa9fe99989e039202042-3"><span class="crayon-st">from</span><span class="crayon-h"> </span><span class="crayon-v">imutils</span><span class="crayon-sy">.</span><span class="crayon-e">video </span><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">FPS</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe99989e039202042-4"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">numpy </span><span class="crayon-st">as</span><span class="crayon-h"> </span><span class="crayon-e">np</span></div><div class="crayon-line" id="crayon-5baa9fe99989e039202042-5"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">argparse</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe99989e039202042-6"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">imutils</span></div><div class="crayon-line" id="crayon-5baa9fe99989e039202042-7"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">pickle</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe99989e039202042-8"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">time</span></div><div class="crayon-line" id="crayon-5baa9fe99989e039202042-9"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-e">cv2</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe99989e039202042-10"><span class="crayon-r">import</span><span class="crayon-h"> </span><span class="crayon-k ">os</span></div><div class="crayon-line" id="crayon-5baa9fe99989e039202042-11">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe99989e039202042-12"><span class="crayon-c"># construct the argument parser and parse the arguments</span></div><div class="crayon-line" id="crayon-5baa9fe99989e039202042-13"><span class="crayon-v">ap</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">argparse</span><span class="crayon-sy">.</span><span class="crayon-e">ArgumentParser</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe99989e039202042-14"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-d"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--detector"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5baa9fe99989e039202042-15"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"path to OpenCV's deep learning face detector"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe99989e039202042-16"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-m"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--embedding-model"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5baa9fe99989e039202042-17"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"path to OpenCV's deep learning face embedding model"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe99989e039202042-18"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-r"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--recognizer"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5baa9fe99989e039202042-19"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"path to model trained to recognize faces"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe99989e039202042-20"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-l"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--le"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">required</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5baa9fe99989e039202042-21"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"path to label encoder"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe99989e039202042-22"><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">add_argument</span><span class="crayon-sy">(</span><span class="crayon-s">"-c"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"--confidence"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">type</span><span class="crayon-o">=</span><span class="crayon-k ">float</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">default</span><span class="crayon-o">=</span><span class="crayon-cn">0.5</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5baa9fe99989e039202042-23"><span class="crayon-h">	</span><span class="crayon-k ">help</span><span class="crayon-o">=</span><span class="crayon-s">"minimum probability to filter weak detections"</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe99989e039202042-24"><span class="crayon-v">args</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">vars</span><span class="crayon-sy">(</span><span class="crayon-v">ap</span><span class="crayon-sy">.</span><span class="crayon-e">parse_args</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0043 seconds] -->
<p>Our imports are the same as the&nbsp;<strong>Step #3</strong>&nbsp;section above, except for&nbsp;<strong>Lines 2 and 3</strong> where we use the 
			<span id="crayon-5baa9fe9998a3194502433" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">imutils</span><span class="crayon-sy">.</span><span class="crayon-v">video</span></span></span>&nbsp; module. We’ll use 
			<span id="crayon-5baa9fe9998a8694605343" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">VideoStream</span></span></span>&nbsp; to capture frames from our camera and 
			<span id="crayon-5baa9fe9998ac717388926" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">FPS</span></span></span>&nbsp; to calculate frames per second statistics.</p>
<p>The command line arguments are also the same except we aren’t passing a path to a static image via the command line. Rather, we’ll grab a reference to our webcam and then process the video. Refer to&nbsp;<strong>Step #3</strong> if you need to review the arguments.</p>
<p>Our three models and label encoder are loaded here:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe9998b1530502638" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># load our serialized face detector from disk
print("[INFO] loading face detector...")
protoPath = os.path.sep.join([args["detector"], "deploy.prototxt"])
modelPath = os.path.sep.join([args["detector"],
	"res10_300x300_ssd_iter_140000.caffemodel"])
detector = cv2.dnn.readNetFromCaffe(protoPath, modelPath)

# load our serialized face embedding model from disk
print("[INFO] loading face recognizer...")
embedder = cv2.dnn.readNetFromTorch(args["embedding_model"])

# load the actual face recognition model along with the label encoder
recognizer = pickle.loads(open(args["recognizer"], "rb").read())
le = pickle.loads(open(args["le"], "rb").read())</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe9998b1530502638-26">26</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998b1530502638-27">27</div><div class="crayon-num" data-line="crayon-5baa9fe9998b1530502638-28">28</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998b1530502638-29">29</div><div class="crayon-num" data-line="crayon-5baa9fe9998b1530502638-30">30</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998b1530502638-31">31</div><div class="crayon-num" data-line="crayon-5baa9fe9998b1530502638-32">32</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998b1530502638-33">33</div><div class="crayon-num" data-line="crayon-5baa9fe9998b1530502638-34">34</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998b1530502638-35">35</div><div class="crayon-num" data-line="crayon-5baa9fe9998b1530502638-36">36</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998b1530502638-37">37</div><div class="crayon-num" data-line="crayon-5baa9fe9998b1530502638-38">38</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998b1530502638-39">39</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe9998b1530502638-26"><span class="crayon-c"># load our serialized face detector from disk</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998b1530502638-27"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"[INFO] loading face detector..."</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9998b1530502638-28"><span class="crayon-v">protoPath</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">os.path</span><span class="crayon-sy">.</span><span class="crayon-v">sep</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"detector"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"deploy.prototxt"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998b1530502638-29"><span class="crayon-v">modelPath</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">os.path</span><span class="crayon-sy">.</span><span class="crayon-v">sep</span><span class="crayon-sy">.</span><span class="crayon-e">join</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"detector"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5baa9fe9998b1530502638-30"><span class="crayon-h">	</span><span class="crayon-s">"res10_300x300_ssd_iter_140000.caffemodel"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998b1530502638-31"><span class="crayon-v">detector</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">dnn</span><span class="crayon-sy">.</span><span class="crayon-e">readNetFromCaffe</span><span class="crayon-sy">(</span><span class="crayon-v">protoPath</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">modelPath</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9998b1530502638-32">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998b1530502638-33"><span class="crayon-c"># load our serialized face embedding model from disk</span></div><div class="crayon-line" id="crayon-5baa9fe9998b1530502638-34"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"[INFO] loading face recognizer..."</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998b1530502638-35"><span class="crayon-v">embedder</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">dnn</span><span class="crayon-sy">.</span><span class="crayon-e">readNetFromTorch</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"embedding_model"</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9998b1530502638-36">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998b1530502638-37"><span class="crayon-c"># load the actual face recognition model along with the label encoder</span></div><div class="crayon-line" id="crayon-5baa9fe9998b1530502638-38"><span class="crayon-v">recognizer</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">pickle</span><span class="crayon-sy">.</span><span class="crayon-e">loads</span><span class="crayon-sy">(</span><span class="crayon-k ">open</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"recognizer"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"rb"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998b1530502638-39"><span class="crayon-v">le</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-k ">pickle</span><span class="crayon-sy">.</span><span class="crayon-e">loads</span><span class="crayon-sy">(</span><span class="crayon-k ">open</span><span class="crayon-sy">(</span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"le"</span><span class="crayon-sy">]</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-s">"rb"</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0032 seconds] -->
<p>Here we load face 
			<span id="crayon-5baa9fe9998b7538619606" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">detector</span></span></span>&nbsp;, face 
			<span id="crayon-5baa9fe9998bb332952197" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">embedder</span></span></span>&nbsp; model, face 
			<span id="crayon-5baa9fe9998c0320221865" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">recognizer</span></span></span>&nbsp; model (Linear SVM), and label encoder.</p>
<p>Again, be sure to refer to&nbsp;<strong>Step #3</strong> if you are confused about the three models or label encoder.</p>
<p>Let’s initialize our video stream and begin processing frames:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe9998c4399227833" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;"># initialize the video stream, then allow the camera sensor to warm up
print("[INFO] starting video stream...")
vs = VideoStream(src=0).start()
time.sleep(2.0)

# start the FPS throughput estimator
fps = FPS().start()

# loop over frames from the video file stream
while True:
	# grab the frame from the threaded video stream
	frame = vs.read()

	# resize the frame to have a width of 600 pixels (while
	# maintaining the aspect ratio), and then grab the image
	# dimensions
	frame = imutils.resize(frame, width=600)
	(h, w) = frame.shape[:2]

	# construct a blob from the image
	imageBlob = cv2.dnn.blobFromImage(
		cv2.resize(frame, (300, 300)), 1.0, (300, 300),
		(104.0, 177.0, 123.0), swapRB=False, crop=False)

	# apply OpenCV's deep learning-based face detector to localize
	# faces in the input image
	detector.setInput(imageBlob)
	detections = detector.forward()</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe9998c4399227833-41">41</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998c4399227833-42">42</div><div class="crayon-num" data-line="crayon-5baa9fe9998c4399227833-43">43</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998c4399227833-44">44</div><div class="crayon-num" data-line="crayon-5baa9fe9998c4399227833-45">45</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998c4399227833-46">46</div><div class="crayon-num" data-line="crayon-5baa9fe9998c4399227833-47">47</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998c4399227833-48">48</div><div class="crayon-num" data-line="crayon-5baa9fe9998c4399227833-49">49</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998c4399227833-50">50</div><div class="crayon-num" data-line="crayon-5baa9fe9998c4399227833-51">51</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998c4399227833-52">52</div><div class="crayon-num" data-line="crayon-5baa9fe9998c4399227833-53">53</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998c4399227833-54">54</div><div class="crayon-num" data-line="crayon-5baa9fe9998c4399227833-55">55</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998c4399227833-56">56</div><div class="crayon-num" data-line="crayon-5baa9fe9998c4399227833-57">57</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998c4399227833-58">58</div><div class="crayon-num" data-line="crayon-5baa9fe9998c4399227833-59">59</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998c4399227833-60">60</div><div class="crayon-num" data-line="crayon-5baa9fe9998c4399227833-61">61</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998c4399227833-62">62</div><div class="crayon-num" data-line="crayon-5baa9fe9998c4399227833-63">63</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998c4399227833-64">64</div><div class="crayon-num" data-line="crayon-5baa9fe9998c4399227833-65">65</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998c4399227833-66">66</div><div class="crayon-num" data-line="crayon-5baa9fe9998c4399227833-67">67</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998c4399227833-68">68</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe9998c4399227833-41"><span class="crayon-c"># initialize the video stream, then allow the camera sensor to warm up</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998c4399227833-42"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"[INFO] starting video stream..."</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9998c4399227833-43"><span class="crayon-v">vs</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">VideoStream</span><span class="crayon-sy">(</span><span class="crayon-v">src</span><span class="crayon-o">=</span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">start</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998c4399227833-44"><span class="crayon-k ">time</span><span class="crayon-sy">.</span><span class="crayon-e">sleep</span><span class="crayon-sy">(</span><span class="crayon-cn">2.0</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9998c4399227833-45">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998c4399227833-46"><span class="crayon-c"># start the FPS throughput estimator</span></div><div class="crayon-line" id="crayon-5baa9fe9998c4399227833-47"><span class="crayon-v">fps</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-e">FPS</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">.</span><span class="crayon-e">start</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998c4399227833-48">&nbsp;</div><div class="crayon-line" id="crayon-5baa9fe9998c4399227833-49"><span class="crayon-c"># loop over frames from the video file stream</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998c4399227833-50"><span class="crayon-st">while</span><span class="crayon-h"> </span><span class="crayon-t">True</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5baa9fe9998c4399227833-51"><span class="crayon-h">	</span><span class="crayon-c"># grab the frame from the threaded video stream</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998c4399227833-52"><span class="crayon-h">	</span><span class="crayon-v">frame</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">vs</span><span class="crayon-sy">.</span><span class="crayon-e">read</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9998c4399227833-53">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998c4399227833-54"><span class="crayon-h">	</span><span class="crayon-c"># resize the frame to have a width of 600 pixels (while</span></div><div class="crayon-line" id="crayon-5baa9fe9998c4399227833-55"><span class="crayon-h">	</span><span class="crayon-c"># maintaining the aspect ratio), and then grab the image</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998c4399227833-56"><span class="crayon-h">	</span><span class="crayon-c"># dimensions</span></div><div class="crayon-line" id="crayon-5baa9fe9998c4399227833-57"><span class="crayon-h">	</span><span class="crayon-v">frame</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">imutils</span><span class="crayon-sy">.</span><span class="crayon-e">resize</span><span class="crayon-sy">(</span><span class="crayon-v">frame</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">width</span><span class="crayon-o">=</span><span class="crayon-cn">600</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998c4399227833-58"><span class="crayon-h">	</span><span class="crayon-sy">(</span><span class="crayon-v">h</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">w</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">frame</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5baa9fe9998c4399227833-59">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998c4399227833-60"><span class="crayon-h">	</span><span class="crayon-c"># construct a blob from the image</span></div><div class="crayon-line" id="crayon-5baa9fe9998c4399227833-61"><span class="crayon-h">	</span><span class="crayon-v">imageBlob</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">dnn</span><span class="crayon-sy">.</span><span class="crayon-e">blobFromImage</span><span class="crayon-sy">(</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998c4399227833-62"><span class="crayon-h">		</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">resize</span><span class="crayon-sy">(</span><span class="crayon-v">frame</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">300</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">300</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">300</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">300</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5baa9fe9998c4399227833-63"><span class="crayon-h">		</span><span class="crayon-sy">(</span><span class="crayon-cn">104.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">177.0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">123.0</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">swapRB</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">crop</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998c4399227833-64">&nbsp;</div><div class="crayon-line" id="crayon-5baa9fe9998c4399227833-65"><span class="crayon-h">	</span><span class="crayon-c"># apply OpenCV's deep learning-based face detector to localize</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998c4399227833-66"><span class="crayon-h">	</span><span class="crayon-c"># faces in the input image</span></div><div class="crayon-line" id="crayon-5baa9fe9998c4399227833-67"><span class="crayon-h">	</span><span class="crayon-v">detector</span><span class="crayon-sy">.</span><span class="crayon-e">setInput</span><span class="crayon-sy">(</span><span class="crayon-v">imageBlob</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998c4399227833-68"><span class="crayon-h">	</span><span class="crayon-v">detections</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">detector</span><span class="crayon-sy">.</span><span class="crayon-e">forward</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0047 seconds] -->
<p>Our 
			<span id="crayon-5baa9fe9998ca783600646" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">VideoStream</span></span></span>&nbsp; object is initialized and started on&nbsp;<strong>Line 43</strong>. We wait for the camera sensor to warm up on&nbsp;<strong>Line 44</strong>.</p>
<p>We also initialize our frames per second counter (<strong>Line 47</strong>) and begin looping over frames on&nbsp;<strong>Line 50</strong>. We grab a 
			<span id="crayon-5baa9fe9998cf561400522" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">frame</span></span></span>&nbsp; from the webcam on&nbsp;<strong>Line 52</strong>.</p>
<p>From here everything is the same as <strong>Step 3</strong>. We 
			<span id="crayon-5baa9fe9998d3732613630" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">resize</span></span></span>&nbsp; the frame (<strong>L</strong><strong>ine 57</strong>) and then we construct a blob from the frame + detect where the faces are (<strong>Lines 61-68</strong>).</p>
<p>Now let’s process the detections:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe9998d8012293685" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">	# loop over the detections
	for i in range(0, detections.shape[2]):
		# extract the confidence (i.e., probability) associated with
		# the prediction
		confidence = detections[0, 0, i, 2]

		# filter out weak detections
		if confidence &gt; args["confidence"]:
			# compute the (x, y)-coordinates of the bounding box for
			# the face
			box = detections[0, 0, i, 3:7] * np.array([w, h, w, h])
			(startX, startY, endX, endY) = box.astype("int")

			# extract the face ROI
			face = frame[startY:endY, startX:endX]
			(fH, fW) = face.shape[:2]

			# ensure the face width and height are sufficiently large
			if fW &lt; 20 or fH &lt; 20:
				continue</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe9998d8012293685-70">70</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998d8012293685-71">71</div><div class="crayon-num" data-line="crayon-5baa9fe9998d8012293685-72">72</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998d8012293685-73">73</div><div class="crayon-num" data-line="crayon-5baa9fe9998d8012293685-74">74</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998d8012293685-75">75</div><div class="crayon-num" data-line="crayon-5baa9fe9998d8012293685-76">76</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998d8012293685-77">77</div><div class="crayon-num" data-line="crayon-5baa9fe9998d8012293685-78">78</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998d8012293685-79">79</div><div class="crayon-num" data-line="crayon-5baa9fe9998d8012293685-80">80</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998d8012293685-81">81</div><div class="crayon-num" data-line="crayon-5baa9fe9998d8012293685-82">82</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998d8012293685-83">83</div><div class="crayon-num" data-line="crayon-5baa9fe9998d8012293685-84">84</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998d8012293685-85">85</div><div class="crayon-num" data-line="crayon-5baa9fe9998d8012293685-86">86</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998d8012293685-87">87</div><div class="crayon-num" data-line="crayon-5baa9fe9998d8012293685-88">88</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998d8012293685-89">89</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe9998d8012293685-70"><span class="crayon-h">	</span><span class="crayon-c"># loop over the detections</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998d8012293685-71"><span class="crayon-h">	</span><span class="crayon-st">for</span><span class="crayon-h"> </span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-st">in</span><span class="crayon-h"> </span><span class="crayon-k ">range</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">detections</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5baa9fe9998d8012293685-72"><span class="crayon-h">		</span><span class="crayon-c"># extract the confidence (i.e., probability) associated with</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998d8012293685-73"><span class="crayon-h">		</span><span class="crayon-c"># the prediction</span></div><div class="crayon-line" id="crayon-5baa9fe9998d8012293685-74"><span class="crayon-h">		</span><span class="crayon-v">confidence</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">detections</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998d8012293685-75">&nbsp;</div><div class="crayon-line" id="crayon-5baa9fe9998d8012293685-76"><span class="crayon-h">		</span><span class="crayon-c"># filter out weak detections</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998d8012293685-77"><span class="crayon-h">		</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">confidence</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-v">args</span><span class="crayon-sy">[</span><span class="crayon-s">"confidence"</span><span class="crayon-sy">]</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5baa9fe9998d8012293685-78"><span class="crayon-h">			</span><span class="crayon-c"># compute the (x, y)-coordinates of the bounding box for</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998d8012293685-79"><span class="crayon-h">			</span><span class="crayon-c"># the face</span></div><div class="crayon-line" id="crayon-5baa9fe9998d8012293685-80"><span class="crayon-h">			</span><span class="crayon-v">box</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">detections</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">i</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">3</span><span class="crayon-o">:</span><span class="crayon-cn">7</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-k ">array</span><span class="crayon-sy">(</span><span class="crayon-sy">[</span><span class="crayon-k ">w</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">h</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-k ">w</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">h</span><span class="crayon-sy">]</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998d8012293685-81"><span class="crayon-h">			</span><span class="crayon-sy">(</span><span class="crayon-v">startX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">startY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">endX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">endY</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">box</span><span class="crayon-sy">.</span><span class="crayon-e">astype</span><span class="crayon-sy">(</span><span class="crayon-s">"int"</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9998d8012293685-82">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998d8012293685-83"><span class="crayon-h">			</span><span class="crayon-c"># extract the face ROI</span></div><div class="crayon-line" id="crayon-5baa9fe9998d8012293685-84"><span class="crayon-h">			</span><span class="crayon-v">face</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">frame</span><span class="crayon-sy">[</span><span class="crayon-v">startY</span><span class="crayon-o">:</span><span class="crayon-v">endY</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">startX</span><span class="crayon-o">:</span><span class="crayon-v">endX</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998d8012293685-85"><span class="crayon-h">			</span><span class="crayon-sy">(</span><span class="crayon-v">fH</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">fW</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">face</span><span class="crayon-sy">.</span><span class="crayon-v">shape</span><span class="crayon-sy">[</span><span class="crayon-o">:</span><span class="crayon-cn">2</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5baa9fe9998d8012293685-86">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998d8012293685-87"><span class="crayon-h">			</span><span class="crayon-c"># ensure the face width and height are sufficiently large</span></div><div class="crayon-line" id="crayon-5baa9fe9998d8012293685-88"><span class="crayon-h">			</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">fW</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-h"> </span><span class="crayon-st">or</span><span class="crayon-h"> </span><span class="crayon-v">fH</span><span class="crayon-h"> </span><span class="crayon-o">&lt;</span><span class="crayon-h"> </span><span class="crayon-cn">20</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998d8012293685-89"><span class="crayon-h">				</span><span class="crayon-st">continue</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0047 seconds] -->
<p>Just as in the previous section, we begin looping over 
			<span id="crayon-5baa9fe9998de357190961" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">detections</span></span></span>&nbsp; and filter out weak ones (<strong>Lines 71-77</strong>). Then we extract the 
			<span id="crayon-5baa9fe9998e2912240231" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">face</span></span></span>&nbsp; ROI as well as ensure the spatial dimensions are sufficiently large enough for the next steps (<strong>Lines 84-89</strong>).</p>
<p>Now it’s time to perform OpenCV face recognition:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe9998e7404781630" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">			# construct a blob for the face ROI, then pass the blob
			# through our face embedding model to obtain the 128-d
			# quantification of the face
			faceBlob = cv2.dnn.blobFromImage(face, 1.0 / 255,
				(96, 96), (0, 0, 0), swapRB=True, crop=False)
			embedder.setInput(faceBlob)
			vec = embedder.forward()

			# perform classification to recognize the face
			preds = recognizer.predict_proba(vec)[0]
			j = np.argmax(preds)
			proba = preds[j]
			name = le.classes_[j]

			# draw the bounding box of the face along with the
			# associated probability
			text = "{}: {:.2f}%".format(name, proba * 100)
			y = startY - 10 if startY - 10 &gt; 10 else startY + 10
			cv2.rectangle(frame, (startX, startY), (endX, endY),
				(0, 0, 255), 2)
			cv2.putText(frame, text, (startX, y),
				cv2.FONT_HERSHEY_SIMPLEX, 0.45, (0, 0, 255), 2)

	# update the FPS counter
	fps.update()</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe9998e7404781630-91">91</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998e7404781630-92">92</div><div class="crayon-num" data-line="crayon-5baa9fe9998e7404781630-93">93</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998e7404781630-94">94</div><div class="crayon-num" data-line="crayon-5baa9fe9998e7404781630-95">95</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998e7404781630-96">96</div><div class="crayon-num" data-line="crayon-5baa9fe9998e7404781630-97">97</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998e7404781630-98">98</div><div class="crayon-num" data-line="crayon-5baa9fe9998e7404781630-99">99</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998e7404781630-100">100</div><div class="crayon-num" data-line="crayon-5baa9fe9998e7404781630-101">101</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998e7404781630-102">102</div><div class="crayon-num" data-line="crayon-5baa9fe9998e7404781630-103">103</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998e7404781630-104">104</div><div class="crayon-num" data-line="crayon-5baa9fe9998e7404781630-105">105</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998e7404781630-106">106</div><div class="crayon-num" data-line="crayon-5baa9fe9998e7404781630-107">107</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998e7404781630-108">108</div><div class="crayon-num" data-line="crayon-5baa9fe9998e7404781630-109">109</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998e7404781630-110">110</div><div class="crayon-num" data-line="crayon-5baa9fe9998e7404781630-111">111</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998e7404781630-112">112</div><div class="crayon-num" data-line="crayon-5baa9fe9998e7404781630-113">113</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998e7404781630-114">114</div><div class="crayon-num" data-line="crayon-5baa9fe9998e7404781630-115">115</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe9998e7404781630-91"><span class="crayon-h">			</span><span class="crayon-c"># construct a blob for the face ROI, then pass the blob</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998e7404781630-92"><span class="crayon-h">			</span><span class="crayon-c"># through our face embedding model to obtain the 128-d</span></div><div class="crayon-line" id="crayon-5baa9fe9998e7404781630-93"><span class="crayon-h">			</span><span class="crayon-c"># quantification of the face</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998e7404781630-94"><span class="crayon-h">			</span><span class="crayon-v">faceBlob</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">dnn</span><span class="crayon-sy">.</span><span class="crayon-e">blobFromImage</span><span class="crayon-sy">(</span><span class="crayon-v">face</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">1.0</span><span class="crayon-h"> </span><span class="crayon-o">/</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">,</span></div><div class="crayon-line" id="crayon-5baa9fe9998e7404781630-95"><span class="crayon-h">				</span><span class="crayon-sy">(</span><span class="crayon-cn">96</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">96</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">swapRB</span><span class="crayon-o">=</span><span class="crayon-t">True</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">crop</span><span class="crayon-o">=</span><span class="crayon-t">False</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998e7404781630-96"><span class="crayon-h">			</span><span class="crayon-v">embedder</span><span class="crayon-sy">.</span><span class="crayon-e">setInput</span><span class="crayon-sy">(</span><span class="crayon-v">faceBlob</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9998e7404781630-97"><span class="crayon-h">			</span><span class="crayon-v">vec</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">embedder</span><span class="crayon-sy">.</span><span class="crayon-e">forward</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998e7404781630-98">&nbsp;</div><div class="crayon-line" id="crayon-5baa9fe9998e7404781630-99"><span class="crayon-h">			</span><span class="crayon-c"># perform classification to recognize the face</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998e7404781630-100"><span class="crayon-h">			</span><span class="crayon-v">preds</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">recognizer</span><span class="crayon-sy">.</span><span class="crayon-e">predict_proba</span><span class="crayon-sy">(</span><span class="crayon-v">vec</span><span class="crayon-sy">)</span><span class="crayon-sy">[</span><span class="crayon-cn">0</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5baa9fe9998e7404781630-101"><span class="crayon-h">			</span><span class="crayon-v">j</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">np</span><span class="crayon-sy">.</span><span class="crayon-e">argmax</span><span class="crayon-sy">(</span><span class="crayon-v">preds</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998e7404781630-102"><span class="crayon-h">			</span><span class="crayon-v">proba</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">preds</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5baa9fe9998e7404781630-103"><span class="crayon-h">			</span><span class="crayon-v">name</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">le</span><span class="crayon-sy">.</span><span class="crayon-v">classes_</span><span class="crayon-sy">[</span><span class="crayon-v">j</span><span class="crayon-sy">]</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998e7404781630-104">&nbsp;</div><div class="crayon-line" id="crayon-5baa9fe9998e7404781630-105"><span class="crayon-h">			</span><span class="crayon-c"># draw the bounding box of the face along with the</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998e7404781630-106"><span class="crayon-h">			</span><span class="crayon-c"># associated probability</span></div><div class="crayon-line" id="crayon-5baa9fe9998e7404781630-107"><span class="crayon-h">			</span><span class="crayon-v">text</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-s">"{}: {:.2f}%"</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">name</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">proba</span><span class="crayon-h"> </span><span class="crayon-o">*</span><span class="crayon-h"> </span><span class="crayon-cn">100</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998e7404781630-108"><span class="crayon-h">			</span><span class="crayon-v">y</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">startY</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-h"> </span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">startY</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-h"> </span><span class="crayon-o">&gt;</span><span class="crayon-h"> </span><span class="crayon-cn">10</span><span class="crayon-h"> </span><span class="crayon-st">else</span><span class="crayon-h"> </span><span class="crayon-v">startY</span><span class="crayon-h"> </span><span class="crayon-o">+</span><span class="crayon-h"> </span><span class="crayon-cn">10</span></div><div class="crayon-line" id="crayon-5baa9fe9998e7404781630-109"><span class="crayon-h">			</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">rectangle</span><span class="crayon-sy">(</span><span class="crayon-v">frame</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">startX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">startY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">endX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">endY</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998e7404781630-110"><span class="crayon-h">				</span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9998e7404781630-111"><span class="crayon-h">			</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">putText</span><span class="crayon-sy">(</span><span class="crayon-v">frame</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">text</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-v">startX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">y</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998e7404781630-112"><span class="crayon-h">				</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-v">FONT_HERSHEY_SIMPLEX</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0.45</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-sy">(</span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">0</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">255</span><span class="crayon-sy">)</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-cn">2</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9998e7404781630-113">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998e7404781630-114"><span class="crayon-h">	</span><span class="crayon-c"># update the FPS counter</span></div><div class="crayon-line" id="crayon-5baa9fe9998e7404781630-115"><span class="crayon-h">	</span><span class="crayon-v">fps</span><span class="crayon-sy">.</span><span class="crayon-e">update</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0064 seconds] -->
<p>Here we:</p>
<ul>
<li>Construct the 
			<span id="crayon-5baa9fe9998ec767643887" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">faceBlob</span></span></span>&nbsp; (<strong>Lines 94 and 95</strong>) and calculate the facial embeddings via deep learning (<strong>Lines 96 and 97</strong>).</li>
<li>Recognize the most-likely 
			<span id="crayon-5baa9fe9998f1568287006" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">name</span></span></span>&nbsp; of the face while calculating the probability (<strong>Line 100-103</strong>).</li>
<li>Draw a bounding box around the face and the person’s 
			<span id="crayon-5baa9fe9998f5764855807" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">name</span></span></span>&nbsp; + probability (<strong>Lines 107 -112</strong>).</li>
</ul>
<p>Our 
			<span id="crayon-5baa9fe9998fa571745079" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">fps</span></span></span>&nbsp; counter is updated on&nbsp;<strong>Line 115</strong>.</p>
<p>Let’s display the results and clean up:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe9998fe620539359" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Python</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">	# show the output frame
	cv2.imshow("Frame", frame)
	key = cv2.waitKey(1) &amp; 0xFF

	# if the `q` key was pressed, break from the loop
	if key == ord("q"):
		break

# stop the timer and display FPS information
fps.stop()
print("[INFO] elasped time: {:.2f}".format(fps.elapsed()))
print("[INFO] approx. FPS: {:.2f}".format(fps.fps()))

# do a bit of cleanup
cv2.destroyAllWindows()
vs.stop()</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe9998fe620539359-117">117</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998fe620539359-118">118</div><div class="crayon-num" data-line="crayon-5baa9fe9998fe620539359-119">119</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998fe620539359-120">120</div><div class="crayon-num" data-line="crayon-5baa9fe9998fe620539359-121">121</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998fe620539359-122">122</div><div class="crayon-num" data-line="crayon-5baa9fe9998fe620539359-123">123</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998fe620539359-124">124</div><div class="crayon-num" data-line="crayon-5baa9fe9998fe620539359-125">125</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998fe620539359-126">126</div><div class="crayon-num" data-line="crayon-5baa9fe9998fe620539359-127">127</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998fe620539359-128">128</div><div class="crayon-num" data-line="crayon-5baa9fe9998fe620539359-129">129</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998fe620539359-130">130</div><div class="crayon-num" data-line="crayon-5baa9fe9998fe620539359-131">131</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe9998fe620539359-132">132</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe9998fe620539359-117"><span class="crayon-h">	</span><span class="crayon-c"># show the output frame</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998fe620539359-118"><span class="crayon-h">	</span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">imshow</span><span class="crayon-sy">(</span><span class="crayon-s">"Frame"</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-v">frame</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9998fe620539359-119"><span class="crayon-h">	</span><span class="crayon-v">key</span><span class="crayon-h"> </span><span class="crayon-o">=</span><span class="crayon-h"> </span><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">waitKey</span><span class="crayon-sy">(</span><span class="crayon-cn">1</span><span class="crayon-sy">)</span><span class="crayon-h"> </span><span class="crayon-o">&amp;</span><span class="crayon-h"> </span><span class="crayon-cn">0xFF</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998fe620539359-120">&nbsp;</div><div class="crayon-line" id="crayon-5baa9fe9998fe620539359-121"><span class="crayon-h">	</span><span class="crayon-c"># if the `q` key was pressed, break from the loop</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998fe620539359-122"><span class="crayon-h">	</span><span class="crayon-st">if</span><span class="crayon-h"> </span><span class="crayon-v">key</span><span class="crayon-h"> </span><span class="crayon-o">==</span><span class="crayon-h"> </span><span class="crayon-k ">ord</span><span class="crayon-sy">(</span><span class="crayon-s">"q"</span><span class="crayon-sy">)</span><span class="crayon-o">:</span></div><div class="crayon-line" id="crayon-5baa9fe9998fe620539359-123"><span class="crayon-h">		</span><span class="crayon-st">break</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998fe620539359-124">&nbsp;</div><div class="crayon-line" id="crayon-5baa9fe9998fe620539359-125"><span class="crayon-c"># stop the timer and display FPS information</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998fe620539359-126"><span class="crayon-v">fps</span><span class="crayon-sy">.</span><span class="crayon-e">stop</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9998fe620539359-127"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"[INFO] elasped time: {:.2f}"</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">fps</span><span class="crayon-sy">.</span><span class="crayon-e">elapsed</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998fe620539359-128"><span class="crayon-k ">print</span><span class="crayon-sy">(</span><span class="crayon-s">"[INFO] approx. FPS: {:.2f}"</span><span class="crayon-sy">.</span><span class="crayon-k ">format</span><span class="crayon-sy">(</span><span class="crayon-v">fps</span><span class="crayon-sy">.</span><span class="crayon-e">fps</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span><span class="crayon-sy">)</span></div><div class="crayon-line" id="crayon-5baa9fe9998fe620539359-129">&nbsp;</div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998fe620539359-130"><span class="crayon-c"># do a bit of cleanup</span></div><div class="crayon-line" id="crayon-5baa9fe9998fe620539359-131"><span class="crayon-v">cv2</span><span class="crayon-sy">.</span><span class="crayon-e">destroyAllWindows</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe9998fe620539359-132"><span class="crayon-v">vs</span><span class="crayon-sy">.</span><span class="crayon-e">stop</span><span class="crayon-sy">(</span><span class="crayon-sy">)</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0022 seconds] -->
<p>To close out the script, we:</p>
<ul>
<li>Display the annotated 
			<span id="crayon-5baa9fe999903989315545" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">frame</span></span></span>&nbsp; (<strong>Line 118</strong>) and wait for the “q” key to be pressed at which point we break out of the loop (<strong>Lines 119-123</strong>).</li>
<li>Stop our 
			<span id="crayon-5baa9fe999908994797613" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">fps</span></span></span>&nbsp; counter and print statistics in the terminal (<strong>Lines 126-128</strong>).</li>
<li>Cleanup by closing windows and releasing pointers (<strong>Lines 131 and 132</strong>).</li>
</ul>
<p>To execute our OpenCV face recognition pipeline on a video stream, open up a terminal and execute the following command:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe99990d794236498" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate" data-settings=" minimize scroll-mouseover" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea wrap="soft" class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">$ python recognize_video.py --detector face_detection_model \
	--embedding-model openface_nn4.small2.v1.t7 \
	--recognizer output/recognizer.pickle \
	--le output/le.pickle
[INFO] loading face detector...
[INFO] loading face recognizer...
[INFO] starting video stream...
[INFO] elasped time: 12.52
[INFO] approx. FPS: 16.13</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe99990d794236498-1">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe99990d794236498-2">2</div><div class="crayon-num" data-line="crayon-5baa9fe99990d794236498-3">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe99990d794236498-4">4</div><div class="crayon-num" data-line="crayon-5baa9fe99990d794236498-5">5</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe99990d794236498-6">6</div><div class="crayon-num" data-line="crayon-5baa9fe99990d794236498-7">7</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe99990d794236498-8">8</div><div class="crayon-num" data-line="crayon-5baa9fe99990d794236498-9">9</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe99990d794236498-1"><span class="crayon-sy">$</span><span class="crayon-h"> </span><span class="crayon-e">python </span><span class="crayon-v">recognize_video</span><span class="crayon-e">.py</span><span class="crayon-h"> </span><span class="crayon-o">--</span><span class="crayon-e">detector </span><span class="crayon-v">face_detection</span><span class="crayon-sy">_</span>model<span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe99990d794236498-2"><span class="crayon-h">	</span><span class="crayon-o">--</span><span class="crayon-v">embedding</span><span class="crayon-o">-</span><span class="crayon-e">model </span><span class="crayon-v">openface_nn4</span><span class="crayon-e">.small2</span><span class="crayon-e">.v1</span><span class="crayon-e">.t7</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line" id="crayon-5baa9fe99990d794236498-3"><span class="crayon-h">	</span><span class="crayon-o">--</span><span class="crayon-e">recognizer </span><span class="crayon-v">output</span><span class="crayon-o">/</span><span class="crayon-v">recognizer</span><span class="crayon-e">.pickle</span><span class="crayon-h"> </span><span class="crayon-sy">\</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe99990d794236498-4"><span class="crayon-h">	</span><span class="crayon-o">--</span><span class="crayon-e">le </span><span class="crayon-v">output</span><span class="crayon-o">/</span><span class="crayon-v">le</span><span class="crayon-e">.pickle</span></div><div class="crayon-line" id="crayon-5baa9fe99990d794236498-5"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">loading </span><span class="crayon-e">face </span><span class="crayon-v">detector</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe99990d794236498-6"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">loading </span><span class="crayon-e">face </span><span class="crayon-v">recognizer</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line" id="crayon-5baa9fe99990d794236498-7"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">starting </span><span class="crayon-e">video </span><span class="crayon-v">stream</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span><span class="crayon-sy">.</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe99990d794236498-8"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-e">elasped </span><span class="crayon-r">time</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">12.52</span></div><div class="crayon-line" id="crayon-5baa9fe99990d794236498-9"><span class="crayon-sy">[</span><span class="crayon-v">INFO</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-v">approx</span><span class="crayon-sy">.</span><span class="crayon-h"> </span><span class="crayon-v">FPS</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-cn">16.13</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0021 seconds] -->
<p></p>
<div class="wp-caption aligncenter" style="max-width: 510px;">
<p><a href="./OpenCV Face Recognition - PyImageSearch_files/opencv_face_reco_animation.gif"><img class="size-full" src="./OpenCV Face Recognition - PyImageSearch_files/opencv_face_reco_animation.gif" alt="" width="500"></a></p>
<p class="wp-caption-text"><strong>Figure 7:</strong>&nbsp;Face recognition in video with OpenCV.</p>
</div>
<p>As you can see, both Trisha and my face are correctly identified! Our OpenCV face recognition pipeline is also obtaining ~16 FPS on my iMac. On my MacBook Pro I was getting ~14 FPS throughput rate.</p>
<h3>Drawbacks, limitations, and how to obtain higher face recognition accuracy</h3>
<div id="attachment_8748" style="max-width: 510px" class="wp-caption aligncenter"><a href="./OpenCV Face Recognition - PyImageSearch_files/opencv_face_reco_misclassification.jpg"><img class="wp-image-8748" src="./OpenCV Face Recognition - PyImageSearch_files/opencv_face_reco_misclassification.jpg" alt="" width="500" height="663" srcset="https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_misclassification.jpg 600w, https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_misclassification-226x300.jpg 226w" sizes="(max-width: 500px) 100vw, 500px"></a><p class="wp-caption-text"><strong>Figure 8:</strong> All face recognition systems are error-prone. There will never be a 100% accurate face recognition system.</p></div>
<p>Inevitably, you’ll run into a situation where OpenCV does not recognize a face correctly.</p>
<p>What do you do in those situations?</p>
<p>And how do you improve your OpenCV face recognition accuracy? In this section, I’ll detail a few of the suggested methods to increase the accuracy of your face recognition pipeline</p>
<h4>You may need more data</h4>
<div id="attachment_8760" style="max-width: 460px" class="wp-caption aligncenter"><a href="./OpenCV Face Recognition - PyImageSearch_files/opencv_face_reco_more_data.jpg"><img class="wp-image-8760" src="./OpenCV Face Recognition - PyImageSearch_files/opencv_face_reco_more_data.jpg" alt="" width="450" height="338" srcset="https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_more_data.jpg 600w, https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_more_data-300x225.jpg 300w" sizes="(max-width: 450px) 100vw, 450px"></a><p class="wp-caption-text"><strong>Figure 9:</strong> Most people aren’t training their OpenCV face recognition models with enough data. (<a href="http://chenlab.ece.cornell.edu/projects/KinshipVerification/" target="_blank" rel="noopener">image source</a>)</p></div>
<p>My first suggestion is likely the most obvious one, but it’s worth sharing.</p>
<p>In my <a href="https://www.pyimagesearch.com/2018/06/18/face-recognition-with-opencv-python-and-deep-learning/" target="_blank" rel="noopener">previous tutorial on face recognition</a>, a handful of PyImageSearch readers asked why their face recognition accuracy was low and faces were being misclassified — the conversation went something like this (paraphrased):</p>
<blockquote><p><strong>Them:</strong> Hey Adrian, I am trying to perform face recognition on a dataset of my classmate’s faces, but the accuracy is really low. What can I do to increase face recognition accuracy?</p>
<p><strong>Me:</strong> How many face images do you have per person?</p>
<p><strong>Them:</strong> Only one or two.</p>
<p><strong>Me:</strong> Gather more data.</p></blockquote>
<p>I get the impression that most readers already know they need more face images when they only have one or two example faces per person, but I suspect they are hoping for me to pull a computer vision technique out of my bag of tips and tricks to solve the problem.</p>
<p>It doesn’t work like that.</p>
<p>If you find yourself with low face recognition accuracy and only have a few example faces per person, gather more data — there are no “computer vision tricks” that will save you from the data gathering process.</p>
<p><strong>Invest in your data and you’ll have a better OpenCV face recognition pipeline.&nbsp;</strong>In general, I would recommend a <strong>minimum of 10-20 faces per person.</strong></p>
<p><em><strong>Note:</strong> You may be thinking, “But Adrian, you only gathered 6 images per person in today’s post!” Yes, you are right — and I did that to prove a point. The OpenCV face recognition system we discussed here today worked but can always be improved. There are times when smaller datasets will give you your desired results, and there’s nothing wrong with trying a small dataset — but when you don’t achieve your desired accuracy you’ll want to gather more data.</em></p>
<h4>Perform face alignment</h4>
<div id="attachment_8761" style="max-width: 510px" class="wp-caption aligncenter"><a href="./OpenCV Face Recognition - PyImageSearch_files/opencv_face_reco_alignment.jpg"><img class="wp-image-8761" src="./OpenCV Face Recognition - PyImageSearch_files/opencv_face_reco_alignment.jpg" alt="" width="500" height="388" srcset="https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_alignment.jpg 600w, https://www.pyimagesearch.com/wp-content/uploads/2018/09/opencv_face_reco_alignment-300x233.jpg 300w" sizes="(max-width: 500px) 100vw, 500px"></a><p class="wp-caption-text"><strong>Figure 9:</strong> Performing face alignment for OpenCV facial recognition can dramatically improve face recognition performance.</p></div>
<p>The face recognition model OpenCV uses to compute the 128-d face embeddings comes from the <a href="https://cmusatyalab.github.io/openface/" target="_blank" rel="noopener">OpenFace project</a>.</p>
<p>The OpenFace model will perform better on faces that have been aligned.</p>
<p>Face alignment is the process of:</p>
<ol>
<li>Identifying the geometric structure of faces in images.</li>
<li>Attempting to obtain a canonical alignment of the face based on translation, rotation, and scale.</li>
</ol>
<p>As you can see from <strong>Figure 9</strong>&nbsp;at the top of this section, I have:</p>
<ol>
<li>Detected a faces in the image and extracted the ROIs (based on the bounding box coordinates).</li>
<li>Applied <a href="https://www.pyimagesearch.com/2017/04/03/facial-landmarks-dlib-opencv-python/" target="_blank" rel="noopener">facial landmark detection</a>&nbsp;to extract the coordinates of the eyes.</li>
<li>Computed the centroid for each respective eye along with the midpoint between the eyes.</li>
<li>And based on these points, applied an affine transform to resize the face to a fixed size and dimension.</li>
</ol>
<p>If we apply face alignment to every face in our dataset, then in the output coordinate space, all faces should:</p>
<ol>
<li>Be centered in the image.</li>
<li>Be rotated such the eyes lie on a horizontal line (i.e., the face is rotated such that the eyes lie along the same <em>y</em>-coordinates).</li>
<li>Be scaled such that the size of the faces is approximately identical.</li>
</ol>
<p>Applying face alignment to our OpenCV face recognition pipeline was outside the scope of today’s tutorial, but if you would like to further increase your face recognition accuracy using OpenCV and OpenFace, I would recommend you apply face alignment.</p>
<p>Check out my blog post,&nbsp;<a href="https://www.pyimagesearch.com/2017/05/22/face-alignment-with-opencv-and-python/" target="_blank" rel="noopener"><em>Face Alignment with OpenCV and Python</em></a>.</p>
<h4>Tune your hyperparameters</h4>
<p>My second suggestion is for you to attempt to tune your hyperparameters on whatever machine learning model you are using (i.e., the model trained on top of the extracted face embeddings).</p>
<p>For this tutorial, we used a Linear SVM; however, we did not tune the 
			<span id="crayon-5baa9fe999917392195736" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">C</span></span></span>&nbsp; value, which is typically the most important value of an SVM to tune.</p>
<p>The 
			<span id="crayon-5baa9fe99991c358811798" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">C</span></span></span>&nbsp;value is a “strictness” parameter and controls how much you want to avoid misclassifying each data point in the training set.</p>
<p>Larger values of 
			<span id="crayon-5baa9fe999921490506622" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">C</span></span></span>&nbsp;will be more strict and try harder to classify every input data point correctly, even at the risk of overfitting.</p>
<p>Smaller values of&nbsp;&nbsp;
			<span id="crayon-5baa9fe999926317801188" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">C</span></span></span>&nbsp;will be more “soft”, allowing some misclassifications in the training data, but ideally generalizing better to testing data.</p>
<p>It’s interesting to note that according to one of the classification examples in the <a href="https://github.com/cmusatyalab/openface" target="_blank" rel="noopener">OpenFace GitHub</a>, they actually recommend to <em>not</em> tune the hyperparameters, as,&nbsp;from their experience, they found that setting 
			<span id="crayon-5baa9fe99992a064222186" class="crayon-syntax crayon-syntax-inline  crayon-theme-classic crayon-theme-classic-inline crayon-font-monaco" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important;"><span class="crayon-pre crayon-code" style="font-size: 12px !important; line-height: 15px !important;font-size: 12px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><span class="crayon-v">C</span><span class="crayon-o">=</span><span class="crayon-cn">1</span></span></span>&nbsp; obtains satisfactory face recognition results in most settings.</p>
<p>Still, if your face recognition accuracy is not sufficient, it may be worth the extra effort and computational cost of tuning your hyperparameters via either a grid search or random search.</p>
<h4>Use dlib’s embedding model (but not it’s k-NN for face recognition)</h4>
<p>In my experience using both OpenCV’s face recognition model along with <a href="http://blog.dlib.net/2017/02/high-quality-face-recognition-with-deep.html" target="_blank" rel="noopener">dlib’s face recognition model</a>, I’ve found that dlib’s face embeddings are more discriminative, especially for smaller datasets.</p>
<p>Furthermore, I’ve found that dlib’s model is less dependent on:</p>
<ol>
<li>Preprocessing such as face alignment</li>
<li>Using a more powerful machine learning model on top of extracted face embeddings</li>
</ol>
<p>If you take a look at <a href="https://www.pyimagesearch.com/2018/06/18/face-recognition-with-opencv-python-and-deep-learning/" target="_blank" rel="noopener">my original face recognition tutorial</a>, you’ll notice that we utilized a simple k-NN algorithm for face recognition (with a small modification to throw out nearest neighbor votes whose distance was above a threshold).</p>
<p>The k-NN model worked extremely well, but as we know, more powerful machine learning models exist.</p>
<p>To improve accuracy further, you may want to use <a href="https://www.pyimagesearch.com/2018/06/18/face-recognition-with-opencv-python-and-deep-learning/" target="_blank" rel="noopener">dlib’s embedding model</a>, and then instead of applying k-NN, follow <strong>Step #2</strong> from today’s post and train a more powerful classifier on the face embeddings.</p>
<h3>Did you encounter a “USAGE” error running today’s Python face recognition scripts?</h3>
<p>Each week I receive emails that (paraphrased) go something like this:</p>
<blockquote><p>Hi Adrian, I can’t run the code from the blog post.</p>
<p>My error looks like this:</p><!-- Crayon Syntax Highlighter v_2.7.2_beta -->

		<div id="crayon-5baa9fe999930861024603" class="crayon-syntax crayon-theme-classic crayon-font-monaco crayon-os-pc print-yes notranslate crayon-wrapped" data-settings=" minimize scroll-mouseover wrap" style="margin-top: 12px; margin-bottom: 12px; font-size: 12px !important; line-height: 15px !important; height: auto;">
		
			<div class="crayon-toolbar" data-settings=" show" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><span class="crayon-title">OpenCV Face Recognition</span>
			<div class="crayon-tools" style="font-size: 12px !important;height: 18px !important; line-height: 18px !important;"><div class="crayon-button crayon-nums-button crayon-pressed" title="Toggle Line Numbers"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-plain-button" title="Toggle Plain Code"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-wrap-button crayon-pressed" title="Toggle Line Wrap"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-expand-button" title="Expand Code" style="display: none;"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-copy-button" title="Copy"><div class="crayon-button-icon"></div></div><div class="crayon-button crayon-popup-button" title="Open Code In New Window"><div class="crayon-button-icon"></div></div><span class="crayon-language">Shell</span></div></div>
			<div class="crayon-info" style="min-height: 16.8px !important; line-height: 16.8px !important;"></div>
			<div class="crayon-plain-wrap"><textarea class="crayon-plain print-no" data-settings="" readonly="" style="tab-size: 4; font-size: 12px !important; line-height: 15px !important; z-index: 0; opacity: 0; overflow: hidden;">usage: extract_embeddings.py [-h] -i DATASET -e EMBEDDINGS
    -d DETECTOR -m EMBEDDING_MODEL [-c CONFIDENCE]
extract_embeddings.py: error: the following arguments are required:
    -i/--dataset, -e/--embeddings, -d/--detector, -m/--embedding-model</textarea></div>
			<div class="crayon-main" style="position: relative; z-index: 1; overflow: hidden;">
				<table class="crayon-table" style="">
					<tbody><tr class="crayon-row">
				<td class="crayon-nums " data-settings="show">
					<div class="crayon-nums-content" style="font-size: 12px !important; line-height: 15px !important;"><div class="crayon-num" data-line="crayon-5baa9fe999930861024603-1" style="height: 15px;">1</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999930861024603-2" style="height: 15px;">2</div><div class="crayon-num" data-line="crayon-5baa9fe999930861024603-3" style="height: 15px;">3</div><div class="crayon-num crayon-striped-num" data-line="crayon-5baa9fe999930861024603-4" style="height: 15px;">4</div></div>
				</td>
						<td class="crayon-code"><div class="crayon-pre" style="font-size: 12px !important; line-height: 15px !important; -moz-tab-size:4; -o-tab-size:4; -webkit-tab-size:4; tab-size:4;"><div class="crayon-line" id="crayon-5baa9fe999930861024603-1"><span class="crayon-v">usage</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">extract_embeddings</span><span class="crayon-e">.py</span><span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-v">h</span><span class="crayon-sy">]</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">i</span><span class="crayon-h"> </span><span class="crayon-v">DATASET</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">e</span><span class="crayon-h"> </span><span class="crayon-v">EMBEDDINGS</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999930861024603-2"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">-</span><span class="crayon-i">d</span><span class="crayon-h"> </span><span class="crayon-v">DETECTOR</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-i">m</span><span class="crayon-h"> </span><span class="crayon-v">EMBEDDING</span><span class="crayon-sy">_</span>MODEL<span class="crayon-h"> </span><span class="crayon-sy">[</span><span class="crayon-o">-</span><span class="crayon-i">c</span><span class="crayon-h"> </span><span class="crayon-v">CONFIDENCE</span><span class="crayon-sy">]</span></div><div class="crayon-line" id="crayon-5baa9fe999930861024603-3"><span class="crayon-v">extract_embeddings</span><span class="crayon-e">.py</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-v">error</span><span class="crayon-o">:</span><span class="crayon-h"> </span><span class="crayon-e">the </span><span class="crayon-e">following </span><span class="crayon-e">arguments </span><span class="crayon-e">are </span><span class="crayon-v">required</span><span class="crayon-o">:</span></div><div class="crayon-line crayon-striped-line" id="crayon-5baa9fe999930861024603-4"><span class="crayon-h">&nbsp;&nbsp;&nbsp;&nbsp;</span><span class="crayon-o">-</span><span class="crayon-v">i</span><span class="crayon-o">/</span><span class="crayon-o">--</span><span class="crayon-v">dataset</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">e</span><span class="crayon-o">/</span><span class="crayon-o">--</span><span class="crayon-v">embeddings</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">d</span><span class="crayon-o">/</span><span class="crayon-o">--</span><span class="crayon-v">detector</span><span class="crayon-sy">,</span><span class="crayon-h"> </span><span class="crayon-o">-</span><span class="crayon-v">m</span><span class="crayon-o">/</span><span class="crayon-o">--</span><span class="crayon-v">embedding</span><span class="crayon-o">-</span><span class="crayon-v">model</span></div></div></td>
					</tr>
				</tbody></table>
			</div>
		</div>
<!-- [Format Time: 0.0019 seconds] -->
<p>
</p></blockquote>
<p>Or this:</p>
<blockquote><p>I’m using Spyder IDE to run the code. It isn’t running as I encounter a “usage” message in the command box.</p></blockquote>
<p>There are three separate Python scripts in this tutorial, and furthermore, each of them requires that you (correctly) supply the respective command line arguments.</p>
<p><strong>If you’re new to command line arguments, that’s fine,&nbsp;<a href="https://www.pyimagesearch.com/2018/03/12/python-argparse-command-line-arguments/" target="_blank" rel="noopener">but you need to read up on how Python, argparse, and command line arguments work</a> <em>before</em> you try to run these scripts!</strong></p>
<p>I’ll be honest with you — face recognition is an <em>advanced</em> technique. Command line arguments are a&nbsp;<em>very beginner/novice&nbsp;</em>concept. Make sure you walk before you run, otherwise you will trip up. <a href="https://www.pyimagesearch.com/2018/03/12/python-argparse-command-line-arguments/" target="_blank" rel="noopener">Take the time now to educate yourself on how command line arguments.</a></p>
<p>Secondly, I always include the <em>exact</em> command you can copy and paste into your terminal or command line and run the script. You might want to modify the command line arguments to accommodate your own image or video data, <em>but essentially I’ve done the work for you</em>. With a knowledge of command line arguments you can update the arguments to&nbsp;<em>point to your own data</em>,&nbsp;<em>without having to modify a single line of code.</em></p>
<p>For the readers that want to use an IDE like Spyder or PyCharm my recommendation is that you learn how to use command line arguments in the command line/terminal&nbsp;<em><strong>first</strong></em>. Program in the IDE, but use the command line to execute your scripts.</p>
<p>I also recommend that you don’t bother trying to configure your IDE for command line arguments until you understand how they work by typing them in first. In fact, <em>you’ll probably learn to love the command line as it is faster than clicking through a GUI menu</em> to input the arguments each time you want to change them. Once you have a good handle on how command line arguments work, you can then configure them separately in your IDE.</p>
<p>From a quick search through my inbox, I see that I’ve answered over 500-1,000 of command line argument-related questions. I’d estimate that I’d answered another 1,000+ such questions replying to comments on the blog.</p>
<p><em>Don’t let me discourage you from commenting on a post or emailing me for assistance — please do.</em> <strong>But if you are new to programming, I urge you to read and try the concepts discussed in my <a href="https://www.pyimagesearch.com/2018/03/12/python-argparse-command-line-arguments/" target="_blank" rel="noopener">command line arguments blog post</a></strong>&nbsp;as that will be the tutorial I’ll link you to if you need help.</p>
<h2>Summary</h2>
<p>In today’s blog post we used OpenCV to perform face recognition.</p>
<p>Our OpenCV face recognition pipeline was created using a four-stage process:</p>
<ol>
<li>Create your dataset of face images</li>
<li>Extract face embeddings for each face in the image (again, using OpenCV)</li>
<li>Train a model on top of the face embeddings</li>
<li>Utilize OpenCV to recognize faces in images and video streams</li>
</ol>
<p>Since I was married over this past weekend, I used photos of myself and Trisha (my now wife) to keep the tutorial fun and festive.</p>
<p>You can, of course, swap in your own face dataset provided you follow the directory structure of the project detailed above.</p>
<p>If you need help gathering your own face dataset, be sure to refer to this post on <a href="https://www.pyimagesearch.com/2018/06/11/how-to-build-a-custom-face-recognition-dataset/" target="_blank" rel="noopener">building a face recognition dataset</a>.</p>
<p>I hope you enjoyed today’s tutorial on OpenCV face recognition!</p>
<p><strong>To download the source code, models, and example dataset for this post (and be notified when future blog posts are published here on PyImageSearch), <em>just enter your email address in the form below!</em></strong></p>
<h2 id="post_downloads">Downloads:</h2>
<div id="mc4wp-form-1" class="form mc4wp-form mc4wp-form-761"><form action="https://www.getdrip.com/forms/908778879/submissions" method="post" target="blank" data-drip-embedded-form="908778879" data-drip-id="908778879"><img style="padding-right: 10px; width: 115px; border: none; float: left;" src="./OpenCV Face Recognition - PyImageSearch_files/download-code-icon.png" alt="">If you would like to download the code and images used in this post, please enter your email address in the form below. Not only will you get a .zip of the code, I’ll also send you a <strong>FREE 17-page Resource Guide on Computer Vision, OpenCV, and Deep Learning.</strong> Inside you'll find my hand-picked tutorials, books, courses, and libraries to help you master CV and DL! Sound good? If so, enter your email address and I’ll send you the code immediately!
<p style="margin-left: 130px; margin-top: 10px;"><label for="fields[email]">Email address:</label><input name="fields[email]" type="email" value="" placeholder="Your email address"></p>
<p style="margin-left: 130px;"><input type="submit" value="Download the code!"></p>
<input type="hidden" name="time_zone" value="America/Sao_Paulo"><input type="hidden" name="url" value="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/"><input type="hidden" name="page_title" value="OpenCV Face Recognition - PyImageSearch"></form></div>
	</section><!-- /.entry -->
	<div class="fix"></div>
		<aside id="connect">
		<h3>Resource Guide (it’s totally free).</h3>

		<div>
			<p><img title="Get your FREE 17-page Computer Vision and Deep Learning Resource Guide PDF" src="./OpenCV Face Recognition - PyImageSearch_files/computer_vision_deep_learning_resource_guide_cover.png" style="padding-right: 10px;width: 230px;float: left">
</p><div style="padding-top: 35px">
Enter your email address below to get my <strong>free 17-page Computer Vision, OpenCV, and Deep Learning Resource Guide PDF</strong>. Inside you'll find my hand-picked tutorials, books, courses, and Python libraries to help you master computer vision and deep learning!</div><p></p>

			
						<form action="https://www.getdrip.com/forms/657075648/submissions" method="post" target="_blank" data-drip-embedded-form="657075648" data-drip-id="657075648">
				<div>
					<input type="email" name="fields[email]" class="required email" value="" placeholder="Your email address" style="width: 50%;">
				</div>
				<div>
					<input id="mc-embedded-subscribe" type="submit" name="submit" class="btn submit button" value="Download the Guide!" data-drip-attribute="sign-up-button">
				</div>
			<input type="hidden" name="time_zone" value="America/Sao_Paulo"><input type="hidden" name="url" value="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/"><input type="hidden" name="page_title" value="OpenCV Face Recognition - PyImageSearch"></form>
			
						<div class="social">
		   					</div>
			
		</div><!-- col-left -->

		
        <div class="fix"></div>
	</aside>
	<div class="post-utility"><p class="tags"><i class="icon-tag"></i> <a href="https://www.pyimagesearch.com/tag/deep-learning/" rel="tag">deep learning</a>, <a href="https://www.pyimagesearch.com/tag/face-detection/" rel="tag">face detection</a>, <a href="https://www.pyimagesearch.com/tag/face-recognition/" rel="tag">face recognition</a>, <a href="https://www.pyimagesearch.com/tag/facenet/" rel="tag">facenet</a>, <a href="https://www.pyimagesearch.com/tag/machine-learning/" rel="tag">machine learning</a>, <a href="https://www.pyimagesearch.com/tag/neural-nets/" rel="tag">neural nets</a></p> </div>
</article><!-- /.post -->
	        <div class="post-entries">
	            <div class="nav-prev fl"><a href="https://www.pyimagesearch.com/2018/09/19/pip-install-opencv/" rel="prev"><i class="icon-angle-left"></i> pip install opencv</a></div>
	            <div class="nav-next fr"></div>
	            <div class="fix"></div>
	        </div>

		<div id="comments">		 	<h3 id="comments-title">35 Responses to <em>OpenCV Face Recognition</em></h3>
		 	<ol class="commentlist">
					                 
		<li class="comment even thread-even depth-1">
	    
	    	<a name="comment-479427"></a>
	      	
	      	<div id="li-comment-479427" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/98d96d0f4b4aa3b1b8b58009396f285f.png" srcset="https://secure.gravatar.com/avatar/98d96d0f4b4aa3b1b8b58009396f285f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Harald Vaessin</span>           
	                <span class="date">September 24, 2018 at 10:53 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479427" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479427">
				
				<p>My heartfelt congratulations and best wishes for your future together.<br>
And thank you for your wonderful tutorials!<br>
HV</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479427" onclick="return addComment.moveForm( &quot;comment-479427&quot;, &quot;479427&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to Harald Vaessin">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
	                 
		<li class="comment odd alt thread-odd thread-alt depth-1">
	    
	    	<a name="comment-479428"></a>
	      	
	      	<div id="li-comment-479428" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/19ac9a6370cf20163c098cc74d73ecf4.png" srcset="https://secure.gravatar.com/avatar/19ac9a6370cf20163c098cc74d73ecf4?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Jesudas</span>           
	                <span class="date">September 24, 2018 at 10:56 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479428" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479428">
				
				<p>Congratulations Adrian on your marriage. Wishing you and Trisha the Very Best in Life !</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479428" onclick="return addComment.moveForm( &quot;comment-479428&quot;, &quot;479428&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to Jesudas">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
	                 
		<li class="comment even thread-even depth-1 parent">
	    
	    	<a name="comment-479431"></a>
	      	
	      	<div id="li-comment-479431" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/f0c43c8f73a82effb7435efb53899b36.png" srcset="https://secure.gravatar.com/avatar/f0c43c8f73a82effb7435efb53899b36?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Tosho Futami</span>           
	                <span class="date">September 24, 2018 at 11:09 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479431" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479431">
				
				<p>I am very appreciated for your weekly new code support. Conglaturation your marriage, please enjoy your forepufule future…</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479431" onclick="return addComment.moveForm( &quot;comment-479431&quot;, &quot;479431&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to Tosho Futami">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment odd alt depth-2">
	    
	    	<a name="comment-479564"></a>
	      	
	      	<div id="li-comment-479564" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/b335b3d02b32263040bf7bb83300b4d5.png" srcset="https://secure.gravatar.com/avatar/b335b3d02b32263040bf7bb83300b4d5?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">raj shah</span>           
	                <span class="date">September 25, 2018 at 3:01 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479564" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479564">
				
				<p>hey can u help me to figure out this module (Opencv) ,i m getting an error i know its command line argument can u tell me the configuration parts of ur file.</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479564" onclick="return addComment.moveForm( &quot;comment-479564&quot;, &quot;479564&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to raj shah">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment even thread-odd thread-alt depth-1 parent">
	    
	    	<a name="comment-479435"></a>
	      	
	      	<div id="li-comment-479435" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/3a63fea0fd7f13b5193e941e9c4f72ec.png" srcset="https://secure.gravatar.com/avatar/3a63fea0fd7f13b5193e941e9c4f72ec?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name"><a href="http://ayushpant1998@gmail.com/" rel="external nofollow" class="url">Ayush</a></span>           
	                <span class="date">September 24, 2018 at 11:22 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479435" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479435">
				
				<p>Can this be used for detecting and recognising faces in a classroom with many students?</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479435" onclick="return addComment.moveForm( &quot;comment-479435&quot;, &quot;479435&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to Ayush">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-davidhoffman odd alt depth-2">
	    
	    	<a name="comment-479461"></a>
	      	
	      	<div id="li-comment-479461" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/ce88ea36c4a0d4be49719fc288741c7f.jpeg" srcset="https://secure.gravatar.com/avatar/ce88ea36c4a0d4be49719fc288741c7f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name"><a href="http://twitter.com/drhoffma" rel="external nofollow" class="url">David Hoffman</a></span>           
	                <span class="date">September 24, 2018 at 2:23 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479461" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479461">
				
				<p>Hi Ayush, potentially it can be used for a classroom. There are several considerations to make:</p>
<ol>
<li>Due to the camera angle, some students’ faces may be obscured if the camera is positioned at the front of the classroom.</li>
<li>Scaling of faces especially for low resolution cameras (depends on camera placement).</li>
<li>Privacy concerns — especially since students/children are involved.</li>
</ol>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479461" onclick="return addComment.moveForm( &quot;comment-479461&quot;, &quot;479461&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to David Hoffman">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment even thread-even depth-1">
	    
	    	<a name="comment-479441"></a>
	      	
	      	<div id="li-comment-479441" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/9b363c50a2c9e981f0068d275f2330fe.jpeg" srcset="https://secure.gravatar.com/avatar/9b363c50a2c9e981f0068d275f2330fe?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">falahgs</span>           
	                <span class="date">September 24, 2018 at 11:38 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479441" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479441">
				
				<p>congratulations Adrian ..<br>
i like all you  are posts in geat blog<br>
u really great prof.<br>
thanks for this post</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479441" onclick="return addComment.moveForm( &quot;comment-479441&quot;, &quot;479441&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to falahgs">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
	                 
		<li class="comment odd alt thread-odd thread-alt depth-1">
	    
	    	<a name="comment-479445"></a>
	      	
	      	<div id="li-comment-479445" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/730b7f99bf79688ef6d6ac224fd33c6a.png" srcset="https://secure.gravatar.com/avatar/730b7f99bf79688ef6d6ac224fd33c6a?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Nika</span>           
	                <span class="date">September 24, 2018 at 12:06 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479445" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479445">
				
				<p>Congratulations Adrian and thanks for the tutorial!</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479445" onclick="return addComment.moveForm( &quot;comment-479445&quot;, &quot;479445&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to Nika">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
	                 
		<li class="comment even thread-even depth-1">
	    
	    	<a name="comment-479446"></a>
	      	
	      	<div id="li-comment-479446" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/65b6542316cb29ebcc3c1d4c1c153e30.png" srcset="https://secure.gravatar.com/avatar/65b6542316cb29ebcc3c1d4c1c153e30?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name"><a href="http://none/" rel="external nofollow" class="url">mohamed</a></span>           
	                <span class="date">September 24, 2018 at 12:17 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479446" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479446">
				
				<p>Congratulations Adrian<br>
happy Days</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479446" onclick="return addComment.moveForm( &quot;comment-479446&quot;, &quot;479446&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to mohamed">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
	                 
		<li class="comment odd alt thread-odd thread-alt depth-1">
	    
	    	<a name="comment-479454"></a>
	      	
	      	<div id="li-comment-479454" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/c2fbc71930b000756bd47fd2a295a510.png" srcset="https://secure.gravatar.com/avatar/c2fbc71930b000756bd47fd2a295a510?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Jesus Hdz Soberon</span>           
	                <span class="date">September 24, 2018 at 1:28 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479454" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479454">
				
				<p>Congratulations Adrian for you and now for your wife. My best wishes in this new stage of your  lives.<br>
Best regards from México.</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479454" onclick="return addComment.moveForm( &quot;comment-479454&quot;, &quot;479454&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to Jesus Hdz Soberon">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
	                 
		<li class="comment even thread-even depth-1">
	    
	    	<a name="comment-479459"></a>
	      	
	      	<div id="li-comment-479459" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/00947f41f94298b175471fa22a454333.png" srcset="https://secure.gravatar.com/avatar/00947f41f94298b175471fa22a454333?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name"><a href="https://raypack.ai/" rel="external nofollow" class="url">Gary</a></span>           
	                <span class="date">September 24, 2018 at 2:04 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479459" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479459">
				
				<p>Hello Adrian,<br>
I got married in February this year and it feels very good and right <img draggable="false" class="emoji" alt="🙂" src="./OpenCV Face Recognition - PyImageSearch_files/1f642.svg"> Nerds like us need great women on our side. Take good care of them and congratulation.</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479459" onclick="return addComment.moveForm( &quot;comment-479459&quot;, &quot;479459&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to Gary">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
	                 
		<li class="comment odd alt thread-odd thread-alt depth-1">
	    
	    	<a name="comment-479460"></a>
	      	
	      	<div id="li-comment-479460" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/e4d4c96bff48a8f0041eddb3b1e4a07b.png" srcset="https://secure.gravatar.com/avatar/e4d4c96bff48a8f0041eddb3b1e4a07b?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Cyprian</span>           
	                <span class="date">September 24, 2018 at 2:07 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479460" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479460">
				
				<p>Congrats on getting married!<br>
Thank you again for this great tutorial on face recognition!<br>
Have a nice honeymoon.</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479460" onclick="return addComment.moveForm( &quot;comment-479460&quot;, &quot;479460&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to Cyprian">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
	                 
		<li class="comment even thread-even depth-1">
	    
	    	<a name="comment-479463"></a>
	      	
	      	<div id="li-comment-479463" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/fe01bbd97203f36cdb327306e96b7f81.png" srcset="https://secure.gravatar.com/avatar/fe01bbd97203f36cdb327306e96b7f81?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Yinon Bloch</span>           
	                <span class="date">September 24, 2018 at 3:14 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479463" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479463">
				
				<p>Congratulations Adrian,<br>
I wish you both a happy life together!<br>
I read your blog from time to time and enjoy it a lot, I gain a lot of knowledge and ideas from your posts. thank you very much!<br>
Regarding your comments about  improving the accuracy of the identity, I would like to share with you that I also play a lot with the various libraries of facial identification.<br>
I’v tried the code I found in Martin Krasser’s post: <a href="http://krasserm.github.io/2018/02/07/deep-face-recognition/" rel="nofollow">http://krasserm.github.io/2018/02/07/deep-face-recognition/</a><br>
Which is very similar to what you’ve shown in this post. I would like to know if there are any  significant differences between the two.<br>
After a lot of poking around and testing I also came to conclusion that the dlib library gives the best results (at least for my needs), but without GPU – we get very slow performance.</p>
<p>I wanted to know if you tried to use the facenet library, which uses a vector of 512D, from my experiments it seems to have the same accuracy as nn4 (more or less), but maybe I’m doing something wrong here.</p>
<p>I would appreciate a response from your experience ,</p>
<p>Great appreciation,<br>
Yinon Bloch</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479463" onclick="return addComment.moveForm( &quot;comment-479463&quot;, &quot;479463&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to Yinon Bloch">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
	                 
		<li class="comment odd alt thread-odd thread-alt depth-1">
	    
	    	<a name="comment-479467"></a>
	      	
	      	<div id="li-comment-479467" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/85b9253a21ac8be53718e2494969eb92.png" srcset="https://secure.gravatar.com/avatar/85b9253a21ac8be53718e2494969eb92?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Horelvis</span>           
	                <span class="date">September 24, 2018 at 4:23 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479467" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479467">
				
				<p>Congratulations Adrian!<br>
But now you will don’t have more free time! <img draggable="false" class="emoji" alt="😉" src="./OpenCV Face Recognition - PyImageSearch_files/1f609.svg"><br>
Enjoy with your wife for all life!</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479467" onclick="return addComment.moveForm( &quot;comment-479467&quot;, &quot;479467&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to Horelvis">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
	                 
		<li class="comment even thread-even depth-1">
	    
	    	<a name="comment-479468"></a>
	      	
	      	<div id="li-comment-479468" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/d4f8cc6b1b2f0f24382b7e7bbe6cae4c.png" srcset="https://secure.gravatar.com/avatar/d4f8cc6b1b2f0f24382b7e7bbe6cae4c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Hossein</span>           
	                <span class="date">September 24, 2018 at 4:39 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479468" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479468">
				
				<p>Congratulations<br>
I wish a green life for you.<br>
great Thanks</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479468" onclick="return addComment.moveForm( &quot;comment-479468&quot;, &quot;479468&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to Hossein">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
	                 
		<li class="comment odd alt thread-odd thread-alt depth-1">
	    
	    	<a name="comment-479469"></a>
	      	
	      	<div id="li-comment-479469" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/aec601bff9ade94745fbc00275df6d43.png" srcset="https://secure.gravatar.com/avatar/aec601bff9ade94745fbc00275df6d43?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Nico</span>           
	                <span class="date">September 24, 2018 at 4:41 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479469" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479469">
				
				<p>Hi Adrian,<br>
first of all congrats.</p>
<p>Regarding the code, I tend to agree with Yinon about the fact that the version that uses dlib seems to work better. In particular this version sometimes finds inexistent faces.<br>
What is your opinion ?<br>
Thanks<br>
Nico</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479469" onclick="return addComment.moveForm( &quot;comment-479469&quot;, &quot;479469&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to Nico">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
	                 
		<li class="comment even thread-even depth-1">
	    
	    	<a name="comment-479473"></a>
	      	
	      	<div id="li-comment-479473" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/6689a119b178aaf896631cce3eb6dfa9.png" srcset="https://secure.gravatar.com/avatar/6689a119b178aaf896631cce3eb6dfa9?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Naser</span>           
	                <span class="date">September 24, 2018 at 5:33 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479473" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479473">
				
				<p>Congratulations Adrian and thank you for good tutorial!</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479473" onclick="return addComment.moveForm( &quot;comment-479473&quot;, &quot;479473&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to Naser">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
	                 
		<li class="comment odd alt thread-odd thread-alt depth-1">
	    
	    	<a name="comment-479477"></a>
	      	
	      	<div id="li-comment-479477" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/0ff5404071b72662bf2ac08a1fc0a663.png" srcset="https://secure.gravatar.com/avatar/0ff5404071b72662bf2ac08a1fc0a663?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Hugues</span>           
	                <span class="date">September 24, 2018 at 6:10 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479477" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479477">
				
				<p>Very nice postings, and congratulations on your wedding.</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479477" onclick="return addComment.moveForm( &quot;comment-479477&quot;, &quot;479477&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to Hugues">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
	                 
		<li class="comment even thread-even depth-1">
	    
	    	<a name="comment-479478"></a>
	      	
	      	<div id="li-comment-479478" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/6e6dbd9e3dbc7353b15a30564b8ff928.png" srcset="https://secure.gravatar.com/avatar/6e6dbd9e3dbc7353b15a30564b8ff928?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Prateek Xaxa</span>           
	                <span class="date">September 24, 2018 at 6:50 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479478" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479478">
				
				<p>Thanks for the great contents</p>
<p>Wishing Happy Life Together!</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479478" onclick="return addComment.moveForm( &quot;comment-479478&quot;, &quot;479478&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to Prateek Xaxa">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
	                 
		<li class="comment odd alt thread-odd thread-alt depth-1">
	    
	    	<a name="comment-479481"></a>
	      	
	      	<div id="li-comment-479481" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/10bca9fead7f94940afca7f0968de452.png" srcset="https://secure.gravatar.com/avatar/10bca9fead7f94940afca7f0968de452?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Sinh Huynh</span>           
	                <span class="date">September 24, 2018 at 8:27 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479481" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479481">
				
				<p>Wishing you and Trisha all the best in your marriage.<br>
Many thanks for your tutorials, they are really great, easy to understand for beginner like me.</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479481" onclick="return addComment.moveForm( &quot;comment-479481&quot;, &quot;479481&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to Sinh Huynh">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
	                 
		<li class="comment even thread-even depth-1">
	    
	    	<a name="comment-479482"></a>
	      	
	      	<div id="li-comment-479482" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/0d4335ebf0a2f3b800ec9f46979e86e2.png" srcset="https://secure.gravatar.com/avatar/0d4335ebf0a2f3b800ec9f46979e86e2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">kus</span>           
	                <span class="date">September 24, 2018 at 8:28 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479482" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479482">
				
				<p>Congratulations!</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479482" onclick="return addComment.moveForm( &quot;comment-479482&quot;, &quot;479482&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to kus">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
	                 
		<li class="comment odd alt thread-odd thread-alt depth-1">
	    
	    	<a name="comment-479486"></a>
	      	
	      	<div id="li-comment-479486" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/85239fd9da379f3e663b87323b6cc16e.png" srcset="https://secure.gravatar.com/avatar/85239fd9da379f3e663b87323b6cc16e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">brett</span>           
	                <span class="date">September 24, 2018 at 9:23 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479486" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479486">
				
				<p>Congratulations, wish you both the best! Thank-you for this post,ill be attempting it in the next few days, great tutorials always worth a read.</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479486" onclick="return addComment.moveForm( &quot;comment-479486&quot;, &quot;479486&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to brett">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
	                 
		<li class="comment even thread-even depth-1">
	    
	    	<a name="comment-479487"></a>
	      	
	      	<div id="li-comment-479487" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/537539638bf494db3bfc9455034bdbd3.png" srcset="https://secure.gravatar.com/avatar/537539638bf494db3bfc9455034bdbd3?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Guanghui Yang</span>           
	                <span class="date">September 24, 2018 at 9:25 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479487" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479487">
				
				<p>Congratulations Adrian！</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479487" onclick="return addComment.moveForm( &quot;comment-479487&quot;, &quot;479487&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to Guanghui Yang">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
	                 
		<li class="comment odd alt thread-odd thread-alt depth-1 parent">
	    
	    	<a name="comment-479494"></a>
	      	
	      	<div id="li-comment-479494" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/436bc15408c327a1a6c5fb32f773a503.png" srcset="https://secure.gravatar.com/avatar/436bc15408c327a1a6c5fb32f773a503?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Tran Tuan Vu</span>           
	                <span class="date">September 24, 2018 at 10:41 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479494" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479494">
				
				<p>Hi Adrian,<br>
I have tried on my big dataset (250 persons with ~30 image/person). But when I run recogization scripts, I got very low accuracy? So I think I should not use Linear-SVM for training on the big dataset.</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479494" onclick="return addComment.moveForm( &quot;comment-479494&quot;, &quot;479494&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to Tran Tuan Vu">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	<ul class="children">
	                 
		<li class="comment byuser comment-author-davidhoffman even depth-2">
	    
	    	<a name="comment-479654"></a>
	      	
	      	<div id="li-comment-479654" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/ce88ea36c4a0d4be49719fc288741c7f.jpeg" srcset="https://secure.gravatar.com/avatar/ce88ea36c4a0d4be49719fc288741c7f?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name"><a href="http://twitter.com/drhoffma" rel="external nofollow" class="url">David Hoffman</a></span>           
	                <span class="date">September 25, 2018 at 11:25 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479654" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479654">
				
				<p>Hi Tran, I believe that you need more training data. Thirty images per class isn’t likely enough.</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479654" onclick="return addComment.moveForm( &quot;comment-479654&quot;, &quot;479654&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to David Hoffman">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
</ul><!-- .children -->
</li><!-- #comment-## -->
	                 
		<li class="comment odd alt thread-even depth-1">
	    
	    	<a name="comment-479501"></a>
	      	
	      	<div id="li-comment-479501" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/5d28ff93e3eba927761a950a912ffe43.png" srcset="https://secure.gravatar.com/avatar/5d28ff93e3eba927761a950a912ffe43?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Keesh</span>           
	                <span class="date">September 24, 2018 at 11:52 pm</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479501" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479501">
				
				<p>Congrats Adrian and Trisha!<br>
I hope you have a wonderful Honeymoon and life together.</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479501" onclick="return addComment.moveForm( &quot;comment-479501&quot;, &quot;479501&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to Keesh">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
	                 
		<li class="comment even thread-odd thread-alt depth-1">
	    
	    	<a name="comment-479506"></a>
	      	
	      	<div id="li-comment-479506" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/831ee93e10e3030b89deab53727173c2.png" srcset="https://secure.gravatar.com/avatar/831ee93e10e3030b89deab53727173c2?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Emmanuel Girard</span>           
	                <span class="date">September 25, 2018 at 12:02 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479506" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479506">
				
				<p>Félicitations. Nous vous souhaitons du bonheur, de la joie, de l’amour et beaucoup de souvenirs. / Congratulations. We wish you happiness, joy, love and many memories.</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479506" onclick="return addComment.moveForm( &quot;comment-479506&quot;, &quot;479506&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to Emmanuel Girard">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
	                 
		<li class="comment odd alt thread-even depth-1">
	    
	    	<a name="comment-479513"></a>
	      	
	      	<div id="li-comment-479513" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/a8d27b7cb84b4d05c00f1479d802330c.jpeg" srcset="https://secure.gravatar.com/avatar/a8d27b7cb84b4d05c00f1479d802330c?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Namdev</span>           
	                <span class="date">September 25, 2018 at 12:23 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479513" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479513">
				
				<p>Many congratulations, Adrian and Trisha</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479513" onclick="return addComment.moveForm( &quot;comment-479513&quot;, &quot;479513&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to Namdev">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
	                 
		<li class="comment even thread-odd thread-alt depth-1">
	    
	    	<a name="comment-479531"></a>
	      	
	      	<div id="li-comment-479531" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/300ccf641ac23e91899b047891b106c6.png" srcset="https://secure.gravatar.com/avatar/300ccf641ac23e91899b047891b106c6?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">andreas</span>           
	                <span class="date">September 25, 2018 at 1:06 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479531" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479531">
				
				<p>Hi Adrian,<br>
Thank you for your tutorial. Could you please point out where non max suppression is solved in this pipeline?<br>
Thanks,<br>
Andreas</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479531" onclick="return addComment.moveForm( &quot;comment-479531&quot;, &quot;479531&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to andreas">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
	                 
		<li class="comment odd alt thread-even depth-1">
	    
	    	<a name="comment-479532"></a>
	      	
	      	<div id="li-comment-479532" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/2b47ca0cdb231e5b373b064e65d7dd96.png" srcset="https://secure.gravatar.com/avatar/2b47ca0cdb231e5b373b064e65d7dd96?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Waheed</span>           
	                <span class="date">September 25, 2018 at 1:08 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479532" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479532">
				
				<p>Congratulation Adrian. You deserve it! Thanks for all your posts. I really enjoy them</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479532" onclick="return addComment.moveForm( &quot;comment-479532&quot;, &quot;479532&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to Waheed">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
	                 
		<li class="comment even thread-odd thread-alt depth-1">
	    
	    	<a name="comment-479551"></a>
	      	
	      	<div id="li-comment-479551" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/078e1ce95ea0922270c55084008825e8.png" srcset="https://secure.gravatar.com/avatar/078e1ce95ea0922270c55084008825e8?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Evgeny</span>           
	                <span class="date">September 25, 2018 at 2:31 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479551" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479551">
				
				<p>Congratulations Adrian! Thanks for your great post. Wish you a happy life together!</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479551" onclick="return addComment.moveForm( &quot;comment-479551&quot;, &quot;479551&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to Evgeny">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
	                 
		<li class="comment odd alt thread-even depth-1">
	    
	    	<a name="comment-479572"></a>
	      	
	      	<div id="li-comment-479572" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/9fab474cf7b6037cc71c1d55f6fd8710.png" srcset="https://secure.gravatar.com/avatar/9fab474cf7b6037cc71c1d55f6fd8710?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Pardis</span>           
	                <span class="date">September 25, 2018 at 3:31 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479572" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479572">
				
				<p>Wishing you both a lifetime of love and happiness. And thank you for this great tutorial.</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479572" onclick="return addComment.moveForm( &quot;comment-479572&quot;, &quot;479572&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to Pardis">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
	                 
		<li class="comment even thread-odd thread-alt depth-1">
	    
	    	<a name="comment-479589"></a>
	      	
	      	<div id="li-comment-479589" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/f3f369c16b2690b20eee3c538876e723.png" srcset="https://secure.gravatar.com/avatar/f3f369c16b2690b20eee3c538876e723?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">Chunan</span>           
	                <span class="date">September 25, 2018 at 3:53 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479589" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479589">
				
				<p>Congratulations! Happy wedding.</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479589" onclick="return addComment.moveForm( &quot;comment-479589&quot;, &quot;479589&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to Chunan">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
	                 
		<li class="comment odd alt thread-even depth-1">
	    
	    	<a name="comment-479604"></a>
	      	
	      	<div id="li-comment-479604" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/e44d6db487716a78d0452bf6d95dda2e.png" srcset="https://secure.gravatar.com/avatar/e44d6db487716a78d0452bf6d95dda2e?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">MD Khan</span>           
	                <span class="date">September 25, 2018 at 5:05 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479604" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479604">
				
				<p>Congratulations Dr!</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479604" onclick="return addComment.moveForm( &quot;comment-479604&quot;, &quot;479604&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to MD Khan">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
	                 
		<li class="comment even thread-odd thread-alt depth-1">
	    
	    	<a name="comment-479629"></a>
	      	
	      	<div id="li-comment-479629" class="comment-container">
	      	
					                <div class="avatar"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/854626a8741852f22600aa0ecf3db113.png" srcset="https://secure.gravatar.com/avatar/854626a8741852f22600aa0ecf3db113?s=80&amp;d=mm&amp;r=g 2x" class="avatar avatar-40 photo" height="40" width="40"></div>
	                        
	
		      	<div class="comment-head">
		      	            
	                <span class="name">siavash</span>           
	                <span class="date">September 25, 2018 at 6:56 am</span>
	                <span class="perma"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479629" title="Direct link to this comment">#</a></span>
	                <span class="edit"></span>
		        		          	
				</div><!-- /.comment-head -->
		      
		   		<div class="comment-entry" id="comment-479629">
				
				<p>&lt;3</p>
		            
										
	                <div class="reply">
	                    <a rel="nofollow" class="comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#comment-479629" onclick="return addComment.moveForm( &quot;comment-479629&quot;, &quot;479629&quot;, &quot;respond&quot;, &quot;8691&quot; )" aria-label="Reply to siavash">Reply</a>	                </div><!-- /.reply -->                       
			
				</div><!-- /comment-entry -->
	
			</div><!-- /.comment-container -->
			
	</li><!-- #comment-## -->
			</ol>
		 	</div>
<p style="font-weight: bold; font-size: 20px;">Quick Note on Comments</p>
<p style="padding-top: 15px;"><strong>Please note that all comments on the PyImageSearch blog are hand-moderated by me.</strong> By moderating each comment on the blog I can ensure (1) I interact with and respond to as many readers as possible and (2) the PyImageSearch blog is kept free of spam.</p>
<p style="padding-top: 15px;">Typically, I only moderate comments every 48-72 hours; however, I just got married and am currently on my honeymoon with my wife until early October. Please feel free to submit comments of course! Just keep in mind that I will be unavailable to respond until then. For faster interaction and response times, you should join the <a target="blank" href="https://www.pyimagesearch.com/pyimagesearch-gurus/">PyImageSearch Gurus course</a> which includes private community forums.</p>
<p style="padding-top: 15px;">I appreciate your patience and thank you being a PyImageSearch reader! I will see you when I get back.</p>

	<div id="respond" class="comment-respond">
		<h3 id="reply-title" class="comment-reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/?__s=epqntq2mke75wcroz3hw#respond" style="display:none;">Click here to cancel reply.</a></small></h3>			<form action="https://www.pyimagesearch.com/wp-comments-post.php" method="post" id="commentform" class="comment-form">
				<p class="comment-form-comment"><label class="hide" for="comment">Comment</label> <textarea tabindex="4" id="comment" name="comment" cols="50" rows="10" maxlength="65525" aria-required="true" required="required"></textarea></p><p class="comment-form-author"><input id="author" name="author" type="text" class="txt" tabindex="1" value="" size="30" aria-required="true"><label for="author">Name <span class="required">(required)</span></label> </p>
<p class="comment-form-email"><input id="email" name="email" type="text" class="txt" tabindex="2" value="" size="30" aria-required="true"><label for="email">Email (will not be published) <span class="required">(required)</span></label> </p>
<p class="comment-form-url"><input id="url" name="url" type="text" class="txt" tabindex="3" value="" size="30"><label for="url">Website</label></p>
<p class="form-submit"><input name="submit" type="submit" id="submit" class="submit" value="Submit Comment"> <input type="hidden" name="comment_post_ID" value="8691" id="comment_post_ID">
<input type="hidden" name="comment_parent" id="comment_parent" value="0">
</p><p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="3264601638"></p><p style="display: none;"></p>			<input type="hidden" id="ak_js" name="ak_js" value="1537908718110"></form>
			</div><!-- #respond -->
	     
            </section><!-- /#main -->
                
            <aside id="sidebar">
<div id="woo_search-2" class="widget widget_woo_search"><div class="search_main">
    <form method="get" class="searchform" action="https://www.pyimagesearch.com/">
        <input type="text" class="field s" name="s" value="Search..." onfocus="if (this.value == &#39;Search...&#39;) {this.value = &#39;&#39;;}" onblur="if (this.value == &#39;&#39;) {this.value = &#39;Search...&#39;;}">
                <button type="submit" class="icon-search submit" name="submit" value="Search"></button>
    </form>    
    <div class="fix"></div>
</div>
</div><div id="text-7" class="widget widget_text"><h3>Resource Guide (it’s totally free).</h3>			<div class="textwidget"><a href="https://app.monstercampaigns.com/c/mdoijtrmex7bpm0rp2hn/" class="manual-optin-trigger" data-optin-slug="mdoijtrmex7bpm0rp2hn"><img title="Get your FREE 17-page Computer Vision and Deep Learning Resource Guide PDF" src="./OpenCV Face Recognition - PyImageSearch_files/computer_vision_deep_learning_resource_guide_cover.png" style="padding-right: 10px; width: 105px; float: left;"></a>
<p>
Get your <strong>FREE 17 page Computer Vision, OpenCV, and Deep Learning Resource Guide PDF.</strong> Inside you'll find my hand-picked tutorials, books, courses, and libraries to help you master CV and DL.
</p>
<div style="clear: left;"></div>
<center><a href="https://app.monstercampaigns.com/c/mdoijtrmex7bpm0rp2hn/" style="color: rgb(255, 255, 255); text-decoration: none; font-family: Helvetica, Arial, sans-serif; font-weight: bold; font-size: 16px; line-height: 20px; padding: 10px; display: inline-block; max-width: 300px; border-radius: 5px; text-shadow: rgba(0, 0, 0, 0.247059) 0px -1px 1px; box-shadow: rgba(255, 255, 255, 0.498039) 0px 1px 3px inset, rgba(0, 0, 0, 0.498039) 0px 1px 3px; background: #DF4B4B;">Download for Free!</a></center></div>
		</div><div id="text-9" class="widget widget_text"><h3>Deep Learning for Computer Vision with Python Book — OUT NOW!</h3>			<div class="textwidget"><a target="blank" href="https://www.pyimagesearch.com/deep-learning-computer-vision-python-book/"><img title="Deep Learning with Computer Vision and Python Kickstarter" src="./OpenCV Face Recognition - PyImageSearch_files/dl_for_cv_cover.png" style="padding-bottom: 5px; width: 250px;" onclick="document.location=&#39;https://www.pyimagesearch.com/deep-learning-computer-vision-python-book/&#39;; return false;"></a>
<p>You're interested in deep learning and computer vision, <em>but you don't know how to get started.</em> Let me help. <strong><a target="blank" href="https://www.pyimagesearch.com/deep-learning-computer-vision-python-book/">My new book will teach you all you need to know about deep learning.</a></strong></p>
<p><input type="submit" value="Click here to master deep learning" style="background-color: #DF4B4B;" onclick="document.location=&#39;https://www.pyimagesearch.com/deep-learning-computer-vision-python-book/&#39;; return false;"></p></div>
		</div><div id="text-5" class="widget widget_text"><h3>You can detect faces in images &amp; video.</h3>			<div class="textwidget"><a href="https://www.pyimagesearch.com/practical-python-opencv/?src=sidebar-face-detection" title="Practical Python and OpenCV"><img title="Learn how to detect faces in images and video" src="./OpenCV Face Recognition - PyImageSearch_files/adrian_face_detection_sidebar.png" style="padding-bottom: 5px; width: 300px;" onclick="document.location=&#39;https://www.pyimagesearch.com/practical-python-opencv/?src=sidebar-face-detection&#39;; return false;"></a>
<p>
Are you interested in <strong>detecting faces in images &amp; video?</strong> But <strong>tired of Googling for tutorials</strong> that <em>never work?</em> Then let me help! I guarantee that my new book will turn you into a <strong>face detection ninja</strong> by the end of this weekend.
<a href="https://www.pyimagesearch.com/practical-python-opencv/?src=sidebar-face-detection" title="Practical Python and OpenCV" onclick="document.location=&#39;https://www.pyimagesearch.com/practical-python-opencv/?src=sidebar-face-detection&#39;; return false;">Click here to give it a shot yourself.</a>
</p>
<p><input type="submit" value="Click here to master face detection" style="background-color: #DF4B4B;" onclick="document.location=&#39;https://www.pyimagesearch.com/practical-python-opencv/?src=sidebar-face-detection&#39;; return false;"></p></div>
		</div><div id="text-8" class="widget widget_text"><h3>PyImageSearch Gurus: NOW ENROLLING!</h3>			<div class="textwidget"><div id="pyimg_gurus_carousel_container" style="width: 300px; height: 310px; cursor: pointer;" onclick="document.location=&#39;https://www.pyimagesearch.com/pyimagesearch-gurus/?src=sidebar&#39;; return false;">
	<div id="pyimg_gurus_carousel" style="width: 300px; height: 300px; background: url(&quot;https://www.pyimagesearch.com/static/templates/pyimagesearch-gurus/images/gurus_carousel.jpg&quot;) 0px -900px no-repeat; display: none;"></div>
</div>
<p style="margin-bottom: 8px;"><strong>The PyImageSearch Gurus course is <em>now enrolling!</em></strong> Inside the course you'll learn how to perform:</p>
<ul style="margin-bottom: 8px;">
	<li>Automatic License Plate Recognition (ANPR)</li>
	<li>Deep Learning</li>
	<li>Face Recognition</li>
	<li><em>and much more!</em></li>
</ul>
<p><strong>Click the button below to learn more about the course, take a tour, and get 10 (FREE) sample lessons</strong>.</p>
<p><input type="submit" value="Take a tour &amp; get 10 (free) lessons" style="background-color: #DF4B4B;" onclick="document.location=&#39;https://www.pyimagesearch.com/pyimagesearch-gurus/?src=sidebar&#39;; return false;"></p></div>
		</div><div id="woo_blogauthorinfo-2" class="widget widget_woo_blogauthorinfo"><h3>Hello! I’m Adrian Rosebrock.</h3><span class="left"><img alt="" src="./OpenCV Face Recognition - PyImageSearch_files/02743529311d3b8babbaf6935670ec9c.jpeg" srcset="https://secure.gravatar.com/avatar/02743529311d3b8babbaf6935670ec9c?s=180&amp;d=mm&amp;r=g 2x" class="avatar avatar-90 photo" height="90" width="90"></span>
<p>I'm an entrepreneur and Ph.D who has launched two successful image search engines, <a target="blank" href="http://www.idmypill.com/">ID My Pill</a> and <a target="blank" href="http://www.chicengine.com/">Chic Engine</a>. I'm here to share my tips, tricks, and hacks I've learned along the way.</p>
<div class="fix"></div>
</div><div id="text-4" class="widget widget_text"><h3>Learn computer vision in a single weekend.</h3>			<div class="textwidget"><a href="https://www.pyimagesearch.com/practical-python-opencv/?src=sidebar-single-weekend" title="Practical Python and OpenCV"><img title="Become an OpenCV guru" src="./OpenCV Face Recognition - PyImageSearch_files/practical_python_and_opencv_2nd_cover.png" style="margin-left: 35px; padding-bottom: 15px; width: 215px;"></a>
<p>Want to learn computer vision &amp; OpenCV? I can teach you in a <strong>single weekend</strong>. I know. It sounds crazy, but it’s no joke. My new book is your <strong>guaranteed, quick-start guide</strong> to becoming an OpenCV Ninja. So why not give it a try? <a href="https://www.pyimagesearch.com/practical-python-opencv/?src=sidebar-single-weekend" title="Practical Python and OpenCV">Click here to become a computer vision ninja.</a></p>
<p><input type="submit" value="Click here to become an OpenCV ninja" style="background-color: #DF4B4B;" onclick="document.location=&#39;https://www.pyimagesearch.com/practical-python-opencv/?src=sidebar-single-weekend&#39;; return false;"></p></div>
		</div><div id="text-3" class="widget widget_text"><h3>Subscribe via RSS</h3>			<div class="textwidget"><a target="blank" href="http://feeds.feedburner.com/Pyimagesearch"><img title="PyImageSearch RSS Feed" src="./OpenCV Face Recognition - PyImageSearch_files/rss-icon.png" style="padding-right: 10px; float: left;"></a>
<p><strong>Never miss a post!</strong> Subscribe to the PyImageSearch RSS Feed and keep up to date with my image search engine tutorials, tips, and tricks</p></div>
		</div>
		<div id="woo_tabs-2" class="widget widget_woo_tabs"> 		<div id="tabs">

            <ul class="wooTabs">
                                <li class="popular"><a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#tab-pop" class="selected">Popular</a></li>                                                            </ul>

            <div class="clear"></div>

            <div class="boxes box inside">

	            
                                <ul id="tab-pop" class="list" style="display: block;">
                    	<li>
				<a title="Install guide: Raspberry Pi 3 + Raspbian Jessie + OpenCV 3" href="https://www.pyimagesearch.com/2016/04/18/install-guide-raspberry-pi-3-raspbian-jessie-opencv-3/">Install guide: Raspberry Pi 3 + Raspbian Jessie + OpenCV 3</a>
		<span class="meta">April 18, 2016</span>
		<div class="fix"></div>
	</li>
		<li>
				<a title="Raspbian Stretch: Install OpenCV 3 + Python on your Raspberry Pi" href="https://www.pyimagesearch.com/2017/09/04/raspbian-stretch-install-opencv-3-python-on-your-raspberry-pi/">Raspbian Stretch: Install OpenCV 3 + Python on your Raspberry Pi</a>
		<span class="meta">September 4, 2017</span>
		<div class="fix"></div>
	</li>
		<li>
				<a title="Install OpenCV and Python on your Raspberry Pi 2 and B+" href="https://www.pyimagesearch.com/2015/02/23/install-opencv-and-python-on-your-raspberry-pi-2-and-b/">Install OpenCV and Python on your Raspberry Pi 2 and B+</a>
		<span class="meta">February 23, 2015</span>
		<div class="fix"></div>
	</li>
		<li>
				<a title="Home surveillance and motion detection with the Raspberry Pi, Python, OpenCV, and Dropbox" href="https://www.pyimagesearch.com/2015/06/01/home-surveillance-and-motion-detection-with-the-raspberry-pi-python-and-opencv/">Home surveillance and motion detection with the Raspberry Pi, Python, OpenCV, and Dropbox</a>
		<span class="meta">June 1, 2015</span>
		<div class="fix"></div>
	</li>
		<li>
				<a title="Ubuntu 16.04: How to install OpenCV" href="https://www.pyimagesearch.com/2016/10/24/ubuntu-16-04-how-to-install-opencv/">Ubuntu 16.04: How to install OpenCV</a>
		<span class="meta">October 24, 2016</span>
		<div class="fix"></div>
	</li>
		<li>
				<a title="How to install OpenCV 3 on Raspbian Jessie" href="https://www.pyimagesearch.com/2015/10/26/how-to-install-opencv-3-on-raspbian-jessie/">How to install OpenCV 3 on Raspbian Jessie</a>
		<span class="meta">October 26, 2015</span>
		<div class="fix"></div>
	</li>
		<li style="border-bottom: 0px;">
				<a title="Basic motion detection and tracking with Python and OpenCV" href="https://www.pyimagesearch.com/2015/05/25/basic-motion-detection-and-tracking-with-python-and-opencv/">Basic motion detection and tracking with Python and OpenCV</a>
		<span class="meta">May 25, 2015</span>
		<div class="fix"></div>
	</li>
	                </ul>
                                                                
            </div><!-- /.boxes -->

        </div><!-- /wooTabs -->

        </div>         </aside><!-- /#sidebar -->

		</div><!-- /#main-sidebar-container -->         

		
    </div><!-- /#content -->
	
    <!--#footer-widgets-container-->
    <div id="footer-widgets-container">
	</div><!--/#footer_widgets_container_end-->
    <!--#footer_container_start-->
    <div id="footer-container">
	<footer id="footer" class="col-full">

		
		<div id="copyright" class="col-left">
			Find me on <a target="blank" href="https://twitter.com/pyimagesearch" style="font-weight: bold; color: #FFFFFF;">Twitter</a>, <a target="blank" href="https://www.facebook.com/pyimagesearch" style="font-weight: bold; color: #FFFFFF;">Facebook</a>, <a target="blank" href="https://plus.google.com/115909176846554117735/?rel=author" style="font-weight: bold; color: #FFFFFF;">Google+</a>, and <a target="blank" href="http://www.linkedin.com/pub/adrian-rosebrock/2a/873/59b" style="font-weight: bold; color: #FFFFFF;">LinkedIn</a>.<br>
			<p>© 2018 PyImageSearch. All Rights Reserved. </p>		</div>

		<div id="credit" class="col-right">
		</div>

	</footer>

	    </div><!--/#footer_container_end-->

	</div><!-- /#inner-wrapper -->

</div><!-- /#wrapper -->

<div class="fix"></div><!--/.fix-->

<script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-46641058-1', 'auto', {'allowLinker': true});
  ga('require', 'linker');
  ga('linker:autoLink', ['dpdcart.com']);
  ga('send', 'pageview');

</script>

<!-- -- Clicky ---->
<script src="./OpenCV Face Recognition - PyImageSearch_files/js" type="text/javascript"></script>
<script type="text/javascript">try{ clicky.init(101083980); }catch(e){}</script>

<!-- Drip -->
<script type="text/javascript">
  var _dcq = _dcq || [];
  var _dcs = _dcs || {}; 
  _dcs.account = '4768429';
  
  (function() {
    var dc = document.createElement('script');
    dc.type = 'text/javascript'; dc.async = true; 
    dc.src = '//tag.getdrip.com/4768429.js';
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(dc, s);
  })();
</script>

<script type="text/javascript">
  (function() {
    window._pa = window._pa || {};
    // _pa.orderId = "myOrderId"; // OPTIONAL: attach unique conversion identifier to conversions
    // _pa.revenue = "19.99"; // OPTIONAL: attach dynamic purchase values to conversions
    // _pa.productId = "myProductId"; // OPTIONAL: Include product ID for use with dynamic ads
    var pa = document.createElement('script'); pa.type = 'text/javascript'; pa.async = true;
    pa.src = ('https:' == document.location.protocol ? 'https:' : 'http:') + "//tag.perfectaudience.com/serve/54220efd7ab7f03f7e000043.js";
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(pa, s);

// visited blog tracking
window._pq = window._pq || [];
_pq.push(['track', 'visited blog']);
  })();
</script>

<!-- facebook -->
<script>
  !function(f,b,e,v,n,t,s)
  {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
  n.callMethod.apply(n,arguments):n.queue.push(arguments)};
  if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
  n.queue=[];t=b.createElement(e);t.async=!0;
  t.src=v;s=b.getElementsByTagName(e)[0];
  s.parentNode.insertBefore(t,s)}(window, document,'script',
  'https://connect.facebook.net/en_US/fbevents.js');
  fbq('init', '1465896023527386');
  fbq('track', 'PageView');
</script>
<noscript><img height="1" width="1" style="display:none"
  src="https://www.facebook.com/tr?id=1465896023527386&ev=PageView&noscript=1"
/></noscript>
<!-- facebook -->

<!-- -- scroll to code ---->
<script type="text/javascript">
jQuery(document).ready(function(){
	jQuery("#scroll_to_code").click(function(event){
		event.preventDefault();
		jQuery('html, body').animate({scrollTop: jQuery('#post_downloads').offset().top}, 1000);
	});
});
</script>

<!-- gurus sidebar carousel -->
<script type="text/javascript">
	jQuery(document).ready(function(){
		GURUS_CAROUSEL_IDX = 1;

		window.setInterval(function(){
			jQuery("#pyimg_gurus_carousel").fadeOut(function(){
				GURUS_CAROUSEL_TOP = GURUS_CAROUSEL_IDX * -300;
				jQuery("#pyimg_gurus_carousel").css("background-position", "0px " + GURUS_CAROUSEL_TOP + "px");
				GURUS_CAROUSEL_IDX += 1;

				if (GURUS_CAROUSEL_IDX == 4){
					GURUS_CAROUSEL_IDX = 0;
				}
			}).delay(250).fadeIn();
		}, 5000);
	});
</script>
<!-- Woo Tabs Widget -->
<script type="text/javascript">
jQuery(document).ready(function(){
	// UL = .wooTabs
	// Tab contents = .inside

	var tag_cloud_class = '#tagcloud';

	//Fix for tag clouds - unexpected height before .hide()
	var tag_cloud_height = jQuery( '#tagcloud').height();

	jQuery( '.inside ul li:last-child').css( 'border-bottom','0px' ); // remove last border-bottom from list in tab content
	jQuery( '.wooTabs').each(function(){
		jQuery(this).children( 'li').children( 'a:first').addClass( 'selected' ); // Add .selected class to first tab on load
	});
	jQuery( '.inside > *').hide();
	jQuery( '.inside > *:first-child').show();

	jQuery( '.wooTabs li a').click(function(evt){ // Init Click funtion on Tabs

		var clicked_tab_ref = jQuery(this).attr( 'href' ); // Strore Href value

		jQuery(this).parent().parent().children( 'li').children( 'a').removeClass( 'selected' ); //Remove selected from all tabs
		jQuery(this).addClass( 'selected' );
		jQuery(this).parent().parent().parent().children( '.inside').children( '*').hide();

		jQuery( '.inside ' + clicked_tab_ref).fadeIn(500);

		 evt.preventDefault();

	})
})
</script>
<!-- This site is converting visitors into subscribers and customers with OptinMonster - https://optinmonster.com :: Campaign Title: CS: OpenCV Face Reco --><script type="text/javascript" src="./OpenCV Face Recognition - PyImageSearch_files/api.min.js" data-campaign="hb8kx28jznwl5ea0fogc" data-user="18464" data-env="production"></script><!-- / OptinMonster --><!-- This site is converting visitors into subscribers and customers with OptinMonster - https://optinmonster.com :: Campaign Title: CVDL Resource Guide --><script type="text/javascript" src="./OpenCV Face Recognition - PyImageSearch_files/api.min.js" data-campaign="mdoijtrmex7bpm0rp2hn" data-user="18464" data-env="production"></script><!-- / OptinMonster -->		<script type="text/javascript">var hb8kx28jznwl5ea0fogc_shortcode = true;var mdoijtrmex7bpm0rp2hn_shortcode = true;</script>
		<script type="text/javascript" src="./OpenCV Face Recognition - PyImageSearch_files/69faf.js"></script>

<script type="text/javascript">
/* <![CDATA[ */
var wpcf7 = {"apiSettings":{"root":"https:\/\/www.pyimagesearch.com\/wp-json\/contact-form-7\/v1","namespace":"contact-form-7\/v1"},"recaptcha":{"messages":{"empty":"Please verify that you are not a robot."}},"cached":"1"};
/* ]]> */
</script>

<script type="text/javascript" src="./OpenCV Face Recognition - PyImageSearch_files/b16c2.js"></script>

<script type="text/javascript">
/* <![CDATA[ */
var fsb = {"ajax":"https:\/\/www.pyimagesearch.com\/wp-admin\/admin-ajax.php","nonce":"b0d8dc34cf"};
/* ]]> */
</script>

<script type="text/javascript" src="./OpenCV Face Recognition - PyImageSearch_files/8a711.js"></script>

		<script type="text/javascript">var omapi_localized = { ajax: 'https://www.pyimagesearch.com/wp-admin/admin-ajax.php?optin-monster-ajax-route=1', nonce: '9d40350192', slugs: {"hb8kx28jznwl5ea0fogc":{"slug":"hb8kx28jznwl5ea0fogc","mailpoet":false},"mdoijtrmex7bpm0rp2hn":{"slug":"mdoijtrmex7bpm0rp2hn","mailpoet":false}} };</script>
		


<!--
Performance optimized by W3 Total Cache. Learn more: https://www.w3-edge.com/products/

Object Caching 16191/4548 objects using disk
Page Caching using disk: enhanced (Requested URI contains query) 
Minified using disk
Database Caching 1/37 queries in 0.144 seconds using disk

Served from: www.pyimagesearch.com @ 2018-09-25 16:51:55 by W3 Total Cache
--><div class="drip-tab-container">
  <div id="drip-129969" class="drip-tab bottom right no-image classic">
    <div id="drip-header-129969" class="drip-header">
      <a href="https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/#" id="drip-toggle-129969" class="drip-toggle">
        <h2 id="drip-teaser-129969">Free 17-day crash course on Computer Vision, OpenCV, and Deep Learning</h2>
        <span id="drip-tab-up-129969" class="drip-arrow up">
          <svg width="12px" height="8px" viewBox="1362 659 12 8" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
            <polygon id="right_angle" stroke="none" fill="#FFFFFF" fill-rule="evenodd" transform="translate(1368.000000, 662.703125) rotate(-90.000000) translate(-1368.000000, -662.703125) " points="1364.29688 667.296875 1368.89062 662.703125 1364.29688 658.109375 1365.70312 656.703125 1371.70312 662.703125 1365.70312 668.703125"></polygon>
          </svg>
        </span>
        <span id="drip-tab-down-129969" class="drip-arrow down" style="display: none"></span>
      </a>
    </div>

    <div id="drip-content-129969" class="drip-content drip-clearfix" style="height: auto; bottom: -680px;">
      <div id="drip-form-panel-129969" class="drip-panel" style="display: block;">
        <a id="drip-close-129969" class="drip-close">×</a>
        <h3 id="drip-content-header-129969">Free 17-day crash course on Computer Vision, OpenCV, and Deep Learning</h3>
        <div id="drip-scroll-129969" class="drip-scroll">
          <div class="drip-clearfix">
            
            <div class="drip-description"><strong>Interested in computer vision, OpenCV, and deep learning, but don't know where to start?</strong>&nbsp;Let me help. I've created a&nbsp;<em>free</em>, 17-day crash course that is hand-tailored to give you the best possible introduction to computer vision and deep learning. Sound good? Enter your email below to get started.</div>
          </div>
          <form id="drip-form-129969">
            <div style="display: none">
              <input type="hidden" name="form_id" value="129969">
            </div>
            <dl class="no-labels">
              
                
                  <dt>Email Address</dt>
                  <dd class="drip-clearfix">
                    
                      <input type="email" name="fields[email]" value="" placeholder="Email Address" class="drip-text-field">
                      <div id="drip-errors-for-email-129969" class="drip-errors"></div>
                    
                  </dd>
                
              
            </dl>
            <div class="form-controls">
              <input type="submit" name="submit" value="START MY EMAIL COURSE" id="drip-submit-129969" class="drip-submit-button">
            </div>
          </form>
        </div>
      </div>

      <div id="drip-success-panel-129969" class="drip-success drip-panel drip-clearfix" style="display: none">
        <a id="drip-hide-129969" class="drip-close">×</a>
        <h3>Almost there...</h3>
        <p class="drip-description">To start your free 17-day computer vision and deep learning crash course, confirm your email address by clicking the link in the email I just sent you.</p>
      </div>

      
    </div>
  </div>
</div><div id="om-hb8kx28jznwl5ea0fogc-holder"></div><div id="om-mdoijtrmex7bpm0rp2hn-holder"></div></body></html>